{
  "hash": "13fd261c9e1ce465bbb0818c411742a6",
  "result": {
    "markdown": "---\ntitle: \"Predictors of Heavy E-Cigarette Use among Adults in the United States\"\nsubtitle: \"An analysis of the Population Assessment of Tobacco and Health (PATH) Study.\"\nauthor: \"Naveen Kannan\"\ndate: 2023-03-19\nformat: \n  html:\n    toc: true\n    number-sections: true\n    code-fold: show\n    code-tools: true\n    code-overflow: wrap\n    date-format: iso\n\n---\n\n\n## R Packages and Setup {.unnumbered}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::opts_chunk$set(comment = NA) \nlibrary(broom)\nlibrary(janitor) \nlibrary(naniar)\nlibrary(glue)\nlibrary(rsample)\nlibrary(yardstick)\nlibrary(GGally)\nlibrary(mice)\nlibrary(car)\nlibrary(pROC)\nlibrary(patchwork)\nlibrary(rms)\nlibrary(simputation)\nlibrary(kableExtra)\nlibrary(tidyverse)\ntheme_set(theme_bw()) \n```\n:::\n\n\n# Data Source\n\nThe data under study comes from the Population Assessment of Tobacco and Health (PATH) Study. It was obtained from ICPSR, the Inter-university Consortium for Political and Social Research.\n\nThe Population Assessment of Tobacco and Health **(PATH)** Study began originally surveying 45,971 adult and youth respondents. The study sampled over 150,000 mailing addresses across the United States to create a national sample of tobacco users and non-users, and is a collaboration between the National Institute on Drug Abuse (NIDA), National Institutes of Health (NIH), and the Center for Tobacco Products (CTP), Food and Drug Administration (FDA).\n\nThe data can be found at (https://www.icpsr.umich.edu/web/ICPSR/studies/36498/datadocumentation).\n\nFor adults, data was collected via interviews. Each case constitutes a single completed interview. Each case in a Youth data file represents one youth and his or her parent's responses about that youth. Parents who provided permission for their child to participate in a Youth Interview were asked to complete a brief interview about their child. Youth who turn 18 by the current wave of data collection are considered \"aged-up adults\" and are invited to complete the Adult Interview.\n\n# The Subjects\n\nThe dataset from which data is being taken is **Dataset 1001 (DS1001)**, which contains the data from the Wave 1 adult questionnaire. 45,971 adults and youth constitute the first (baseline) wave of data collected by this longitudinal cohort study.\n\nThe DS1001 data can be considered a random sample that constitutes a longitudinal cross section of adults(of age 18 and above) across the United States, since the PATH study sampled over 150,000 mailing addresses across the United States to create a national sample of tobacco users and non-users. The DS1001 data contains data on adults (individuals of age 18 and above) alone.\n\nFrom the DS1001 dataset, individuals who used e-cigarettes at the time of the Wave 1 questionnaire were selected, excluding individuals who did not use e-cigarettes at that time. Dual users of e-cigarettes and other forms of tobacco were not excluded. The DS1001 dataset only contains data on adults, and thus youth below the age of 18 are excluded from the final dataset.\n\nIndividuals who had complete data on both outcomes under study were then selected. The resulting dataset had 3000 individuals. A random sample of 1200 individuals was taken from this subset, ensuring that the same respondents were taken for both analyses.\n\nThis sample of 1200 PATH study participants (contained in the tibble data_final) can thus be considered as a longitudinal cross-sectional sample of individuals who used e-cigarettes at the time of administering the Wave 1 questionnaire, who may or may not have used other tobacco products, across the United States, of ages 18 and above. Wave 1 began at September 2013 and ended at December 2014.\n\n# Loading and Tidying the Data\n\n## Loading the Raw Data\n\nAccess to the data requires users to log-in to the ICPSR website. Thus, a direct download is not possible. This data can be freely downloaded by the public, and therefore a local copy of the data in the form of a tsv file was read using `read_tsv` from the tidyverse.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_raw <- read_tsv(\"36498-1001-Data.tsv\", show_col_types = FALSE)\n```\n:::\n\n\n## Cleaning the Data\n\n### Selecting Variables We'll Use\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_var <- data_raw |>\n  select(PERSONID,R01_AE1022,R01_AE0103,R01R_A_AE1006,R01_AE1062,R01_AE1100,R01_AE1099,R01_AE9004,R01_AE9010,R01_AE1050,R01R_A_MINFIRST_ECIG, R01_AE1003)\n```\n:::\n\n\n### Dealing with Missingness\n\nThe DS1001 dataset provides negative values for variables that are missing. There are several different subtypes of missing data:\n\n-   Data removed due to respondent request\n-   Data not ascertained\n-   Respondent answer is \"Don't Know\"\n-   Respondent refused to answer\n-   Question inapplicable to respondent\n\nAll of these values are negative in the original DS1001 dataset, and none of the variables under study have negative values. It is also not possible for the variables under study to have negative values. Therefore, all negative values were replaced with `NA` to ensure missing data are correctly identified.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_var <- data_var|> \n  mutate(across(everything(), function(x){replace(x, which(x<0), NA)}))\n```\n:::\n\n\n### Changing Variable Names\n\nThe variables were renamed to have better, more readable names.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_var <- data_var|>\n  mutate(ecig_30day = as.integer(R01_AE1022),\n         puff_num = as.integer(R01_AE0103),\n         age_range = factor(R01R_A_AE1006),\n         less_harm = factor(R01_AE1062),\n         ecig_reg = factor(R01_AE1100),\n         harm_perc = factor(R01_AE1099),\n         price_paid = factor(R01_AE9004),\n         personid = as.character(PERSONID),\n         ecig_nico = as.factor(R01_AE9010),\n         ecig_flavored = as.factor(R01_AE1050),\n         min_num = as.integer(R01R_A_MINFIRST_ECIG),\n         ecig_smoker = factor(R01_AE1003)) |>\n  select(personid, ecig_30day,puff_num,age_range,less_harm,ecig_reg,harm_perc,price_paid,ecig_nico, ecig_flavored, min_num, ecig_smoker)\n\ndata_var <- data_var |>\n  clean_names() \n```\n:::\n\n\n### Sampling the Data\n\nThe dataset was filtered to select only individuals who were users of e-cigarettes at the time of study. The dataset was then filtered to have complete cases on both the outcomes under study, namely `ecig_30day` and `ecig_reg`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_outcome <- data_var |>\n  filter(ecig_smoker == 1 | ecig_smoker == 2)|> # Excluding individuals who did not use e-cigarettes at the time of Wave 1 \n  filter(complete.cases(ecig_30day, ecig_reg)) |>\n  select(personid, ecig_30day,puff_num,age_range,less_harm,ecig_reg,harm_perc,price_paid,ecig_nico, ecig_flavored, min_num, ecig_smoker)\ndim(data_outcome)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 3000   12\n```\n:::\n:::\n\n\n3000 respondents have information on both the outcome variables under study. After setting a seed for reproducibility, a random sample of 1200 respondents was taken from the `data_outcome` tibble. This was also done to ensure that the same respondents are analyzed for both regression models.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(2023) \ndata_complete <- slice_sample(data_outcome, n = 1200) \n```\n:::\n\n\nOnce a random sample was taken, the `tabyl` function was used to ensure that all individuals in the tibble `data_complete` were individuals who had used e-cigarettes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_complete |>\n  tabyl(ecig_smoker) |>\n  kbl() |>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> ecig_smoker </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> percent </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 41 </td>\n   <td style=\"text-align:right;\"> 0.0341667 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1159 </td>\n   <td style=\"text-align:right;\"> 0.9658333 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0000000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nFrom the documentation for the original variable name for `ecig_smoker`(`R01_AE1003`), the question asked was, 'Do you now use e-cigarettes?', with three possible levels.\n\n| Value | Label          | Frequency |\n|-------|----------------|-----------|\n| 1     | 1 = Every day  | 41        |\n| 2     | 2 = Some days  | 1159      |\n| 3     | 3 = Not at all | 0         |\n\nThe above table shows the distribution of the responses to the question, demonstrating that all the individuals under study are individuals who were using e-cigarettes at the time of the Wave 1 questionnaire. Individuals who did not use e-cigarettes at the time are not included in the random sample of 1200 respondents.\n\n### Working with Categorical Predictors\n\nThe `tabyl` function was used to check if all factor variables have atleast 30 observations at each level.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_complete |> \n  tabyl(age_range)|>\n  kbl() |>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> age_range </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> percent </th>\n   <th style=\"text-align:right;\"> valid_percent </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 54 </td>\n   <td style=\"text-align:right;\"> 0.0450000 </td>\n   <td style=\"text-align:right;\"> 0.0453020 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 365 </td>\n   <td style=\"text-align:right;\"> 0.3041667 </td>\n   <td style=\"text-align:right;\"> 0.3062081 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:right;\"> 276 </td>\n   <td style=\"text-align:right;\"> 0.2300000 </td>\n   <td style=\"text-align:right;\"> 0.2315436 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:right;\"> 181 </td>\n   <td style=\"text-align:right;\"> 0.1508333 </td>\n   <td style=\"text-align:right;\"> 0.1518456 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 5 </td>\n   <td style=\"text-align:right;\"> 169 </td>\n   <td style=\"text-align:right;\"> 0.1408333 </td>\n   <td style=\"text-align:right;\"> 0.1417785 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 6 </td>\n   <td style=\"text-align:right;\"> 147 </td>\n   <td style=\"text-align:right;\"> 0.1225000 </td>\n   <td style=\"text-align:right;\"> 0.1233221 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 0.0066667 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_complete |> \n  tabyl(less_harm) |>\n  kbl() |>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> less_harm </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> percent </th>\n   <th style=\"text-align:right;\"> valid_percent </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 955 </td>\n   <td style=\"text-align:right;\"> 0.7958333 </td>\n   <td style=\"text-align:right;\"> 0.7998325 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 239 </td>\n   <td style=\"text-align:right;\"> 0.1991667 </td>\n   <td style=\"text-align:right;\"> 0.2001675 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 0.0050000 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_complete |> \n  tabyl(ecig_reg) |>\n  kbl() |>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> ecig_reg </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> percent </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 369 </td>\n   <td style=\"text-align:right;\"> 0.3075 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 831 </td>\n   <td style=\"text-align:right;\"> 0.6925 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_complete |> \n  tabyl(harm_perc) |>\n  kbl() |>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> harm_perc </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> percent </th>\n   <th style=\"text-align:right;\"> valid_percent </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 822 </td>\n   <td style=\"text-align:right;\"> 0.6850000 </td>\n   <td style=\"text-align:right;\"> 0.6919192 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 343 </td>\n   <td style=\"text-align:right;\"> 0.2858333 </td>\n   <td style=\"text-align:right;\"> 0.2887205 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:right;\"> 23 </td>\n   <td style=\"text-align:right;\"> 0.0191667 </td>\n   <td style=\"text-align:right;\"> 0.0193603 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 0.0100000 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThe `harm_perc` variable was found to have a level `3` which only had 23 observations. Factor levels `2` and `3` for `harm_perc` were collapsed into a single category.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_complete$harm_perc <- fct_collapse(data_complete$harm_perc,\n  '2' = c(\"2\", \"3\"),\n  '1' = \"1\")\n```\n:::\n\n\nNow, `harm_perc` has only 2 levels, each with more than 30 distinct values.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_complete |> \n  tabyl(harm_perc)|>\n  kbl() |>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> harm_perc </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> percent </th>\n   <th style=\"text-align:right;\"> valid_percent </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 822 </td>\n   <td style=\"text-align:right;\"> 0.685 </td>\n   <td style=\"text-align:right;\"> 0.6919192 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 366 </td>\n   <td style=\"text-align:right;\"> 0.305 </td>\n   <td style=\"text-align:right;\"> 0.3080808 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 0.010 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_complete |> \n  tabyl(price_paid)|>\n  kbl() |>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> price_paid </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> percent </th>\n   <th style=\"text-align:right;\"> valid_percent </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 189 </td>\n   <td style=\"text-align:right;\"> 0.1575000 </td>\n   <td style=\"text-align:right;\"> 0.2342007 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 260 </td>\n   <td style=\"text-align:right;\"> 0.2166667 </td>\n   <td style=\"text-align:right;\"> 0.3221809 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:right;\"> 328 </td>\n   <td style=\"text-align:right;\"> 0.2733333 </td>\n   <td style=\"text-align:right;\"> 0.4064436 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 0.0250000 </td>\n   <td style=\"text-align:right;\"> 0.0371747 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:right;\"> 393 </td>\n   <td style=\"text-align:right;\"> 0.3275000 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_complete |> \n  tabyl(ecig_nico)|>\n  kbl() |>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> ecig_nico </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> percent </th>\n   <th style=\"text-align:right;\"> valid_percent </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 320 </td>\n   <td style=\"text-align:right;\"> 0.2666667 </td>\n   <td style=\"text-align:right;\"> 0.8695652 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 48 </td>\n   <td style=\"text-align:right;\"> 0.0400000 </td>\n   <td style=\"text-align:right;\"> 0.1304348 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:right;\"> 832 </td>\n   <td style=\"text-align:right;\"> 0.6933333 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_complete |> \n  tabyl(ecig_flavored)|>\n  kbl() |>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> ecig_flavored </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> percent </th>\n   <th style=\"text-align:right;\"> valid_percent </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 246 </td>\n   <td style=\"text-align:right;\"> 0.2050 </td>\n   <td style=\"text-align:right;\"> 0.6666667 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 123 </td>\n   <td style=\"text-align:right;\"> 0.1025 </td>\n   <td style=\"text-align:right;\"> 0.3333333 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:right;\"> 831 </td>\n   <td style=\"text-align:right;\"> 0.6925 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThe other factor variables were found to have at least 30 observations at each level. Furthermore, none of the categorical variables have more than 6 levels.\n\n### Working with Quantitative Variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_complete |> \n  select(personid, ecig_30day, puff_num, min_num) |>\n  summarize(across(personid:min_num, ~ n_distinct(.)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 4\n  personid ecig_30day puff_num min_num\n     <int>      <int>    <int>   <int>\n1     1200         28       29      31\n```\n:::\n:::\n\n\nThe quantitative variables `ecig_30day`,`puff_num` and `min_num` have at least 10 different, ordered, observed values.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_complete |> \n  select(personid, ecig_30day, puff_num, min_num) |>\n  miss_var_summary() |>\n  kbl() |>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> variable </th>\n   <th style=\"text-align:right;\"> n_miss </th>\n   <th style=\"text-align:right;\"> pct_miss </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> min_num </td>\n   <td style=\"text-align:right;\"> 853 </td>\n   <td style=\"text-align:right;\"> 71.08333 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> puff_num </td>\n   <td style=\"text-align:right;\"> 849 </td>\n   <td style=\"text-align:right;\"> 70.75000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> personid </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.00000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ecig_30day </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.00000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThe `miss_var_summary` function from the `naniar` package was used to identify the number of missing values for the continuous variables under study.\n\n### Renaming the factors\n\nThe categorical variables had their factors renamed to make the data more readable. The final tidy tibble was designated as `data_final`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_final <- data_complete|>\n  mutate(age_range = fct_recode(factor(age_range),\n                                \"<18\" = \"1\",\n                                \"18to24\" = \"2\",\n                                \"25to34\" = \"3\",\n                                \"35to44\" = \"4\",\n                                \"45to54\" = \"5\",\n                                \">55\" = \"6\"),\n         less_harm = fct_recode(factor(less_harm),\n                                \"Yes\" = \"1\",\n                                \"No\" = \"2\"),\n         ecig_reg = fct_recode(factor(ecig_reg),\n                               \"Yes\" = \"1\",\n                               \"No\" = \"2\"),\n         harm_perc = fct_recode(factor(harm_perc),\n                                \"less_harm\" = \"1\",\n                                \"same_or_more\" = \"2\"),\n         price_paid = fct_recode(factor(price_paid),\n                                 \"Below$10\" = \"1\",\n                                 \"$10to$20\" = \"2\",\n                                 \"$21to$100\" = \"3\",\n                                 \">$100\" = \"4\"),\n         ecig_nico = fct_recode(factor(ecig_nico),\n                                \"Yes\" = \"1\",\n                                \"No\" = \"2\"),\n         ecig_flavored = fct_recode(factor(ecig_flavored),\n                                \"Yes\" = \"1\",\n                                \"No\" = \"2\"))\n```\n:::\n\n\n### Splitting the Data\n\nOnce a random sample of 1200 respondents was taken, the data was separated into two tibbles for the purpose of describing the data under study for the two models. `data_log` denotes the dataset for the logistic regression, and `data_lin` denotes the dataset for the linear regression.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_lin <- data_final|>\n  select(personid,ecig_30day,puff_num,age_range,less_harm,ecig_nico)\ndata_log <- data_final|>\n  select(personid,ecig_reg,min_num,harm_perc,price_paid,ecig_nico,ecig_flavored)\n```\n:::\n\n\n# The Tidy Tibble\n\n## Listing the Tibble\n\nThe tidy tibble, `data_final`, was listed.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_final \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1,200 × 12\n   personid   ecig_30day puff_num age_range less_harm ecig_reg harm_perc   \n   <chr>           <int>    <int> <fct>     <fct>     <fct>    <fct>       \n 1 P000319879          1       NA <18       Yes       No       less_harm   \n 2 P000255041          0       NA 25to34    Yes       Yes      less_harm   \n 3 P000413552          2       NA 35to44    Yes       No       same_or_more\n 4 P000239368          1       NA 45to54    Yes       No       less_harm   \n 5 P000334022          1       NA 35to44    Yes       No       less_harm   \n 6 P000151148         25       NA 45to54    Yes       Yes      less_harm   \n 7 P000423889          2       NA 45to54    No        No       same_or_more\n 8 P000264820         24        4 35to44    No        No       less_harm   \n 9 P000321341          2       NA 45to54    No        No       same_or_more\n10 P000200073          2       NA 25to34    No        No       same_or_more\n# ℹ 1,190 more rows\n# ℹ 5 more variables: price_paid <fct>, ecig_nico <fct>, ecig_flavored <fct>,\n#   min_num <int>, ecig_smoker <fct>\n```\n:::\n:::\n\n\n## Size and Identifiers\n\nThere are 1200 rows, with 12 columns in the final tibble `data_final`. One of these columns\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndim(data_final)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1200   12\n```\n:::\n:::\n\n\nThe `personid` variable provides the identifier for each row in the tidy tibble. The `n_distinct` function was used to demonstrate 1200 individual values for `personid` in `data_final`, indicating that each row has a unique `personid` value.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn_distinct(data_final$personid)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1200\n```\n:::\n:::\n\n\n## Save The Tibble\n\nThe `saveRDS` function was used to save the tidy tibble in a .rds file.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(data_final, file = \"data_final.Rds\")\n```\n:::\n\n\n# The Code Book\n\n## Defining the Variables\n\n+-----------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+---------------------------------+--------------------+\n| **Variable**    | **Original DS1001 code** | **Description**                                                                                                                                                           | **Type**                                  | **Analytic Role**               | **Missing values** |\n+-----------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+---------------------------------+--------------------+\n| `personid`      | `PERSONID`               | Unique Participant Identifier                                                                                                                                            | Character variable                        | Unique Identifier               | 0                  |\n+-----------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+---------------------------------+--------------------+\n| `ecig_30day`    | `R01_AE1022`             | On how many of the past 30 days did the participant use an e-cigarette?                                                                                                  | Quantitative Variable                     | Linear Regression **Outcome**   | 0                  |\n+-----------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+---------------------------------+--------------------+\n| `puff_num`      | `R01_AE0103`             | How many puffs from an e-cigarette did the participant take the last time they smoked an e-cigarette?                                                                    | Quantitative Variable                     | Predictor                       | 849                |\n+-----------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+---------------------------------+--------------------+\n| `age_range`     | `R01R_A_AE1006`          | How old was the participant when they first used an e-cigarette, even one or two times?                                                                                  | Multi-Categorical Variable with 6 factors | Predictor                       | 8                  |\n|                 |                          |                                                                                                                                                                          |                                           |                                 |                    |\n|                 |                          | 6 levels:`<18`,`18to24`,                                                                                                                                                 |                                           |                                 |                    |\n|                 |                          |                                                                                                                                                                          |                                           |                                 |                    |\n|                 |                          | `25to34`,`35to44`,                                                                                                                                                       |                                           |                                 |                    |\n|                 |                          |                                                                                                                                                                          |                                           |                                 |                    |\n|                 |                          | `45to54`,`>55`                                                                                                                                                           |                                           |                                 |                    |\n+-----------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+---------------------------------+--------------------+\n| `less_harm`     | `R01_AE1062`             | Did the participant use / used to use e-cigarettes because they might be / have been less harmful to them?                                                               | Binary Categorical Variable               | Predictor                       | 6                  |\n|                 |                          |                                                                                                                                                                          |                                           |                                 |                    |\n|                 |                          | 2 levels: `yes`, `no`                                                                                                                                                    |                                           |                                 |                    |\n+-----------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+---------------------------------+--------------------+\n| `ecig_reg`      | `R01_AE1100`             | Has the participant ever used e-cigarettes fairly regularly?                                                                                                             | Binary Categorical Variable               | Logistic regression **Outcome** | 0                  |\n|                 |                          |                                                                                                                                                                          |                                           |                                 |                    |\n|                 |                          | 2 levels:`yes`,`no`                                                                                                                                                      |                                           |                                 |                    |\n+-----------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+---------------------------------+--------------------+\n| `harm_perc`     | `R01_AE1099`             | To the participant, is using e-cigarettes less harmful, about the same, or more harmful than smoking cigarettes?                                                         | Binary Categorical Variable               | Predictor                       | 12                 |\n|                 |                          |                                                                                                                                                                          |                                           |                                 |                    |\n|                 |                          | 2 levels:`1`,`2`                                                                                                                                                         |                                           |                                 |                    |\n+-----------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+---------------------------------+--------------------+\n| `price_paid`    | `R01_AE9004`             | About how much did the participant pay for their e-cigarette?                                                                                                            | Multi-Categorical Variable with 4 factors | Predictor                       | 393                |\n|                 |                          |                                                                                                                                                                          |                                           |                                 |                    |\n|                 |                          | 4 levels: `Below$10`,`$10to$20`,                                                                                                                                         |                                           |                                 |                    |\n|                 |                          |                                                                                                                                                                          |                                           |                                 |                    |\n|                 |                          | `$21t$100`, `>$100`                                                                                                                                                      |                                           |                                 |                    |\n+-----------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+---------------------------------+--------------------+\n| `ecig_nico`     | `R01_AE9010`             | Does the e-cigarette the participant usually uses contain nicotine?                                                                                                      | Binary Categorical Variable               | Predictor                       | 832                |\n|                 |                          |                                                                                                                                                                          |                                           |                                 |                    |\n|                 |                          | 2 levels:`yes`,`no`                                                                                                                                                      |                                           |                                 |                    |\n+-----------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+---------------------------------+--------------------+\n| `ecig_flavored` | `R01_AE9010`             | Is the regular / last brand of e-cigarettes used by the participant flavored to taste like menthol, mint,clove, spice, candy, fruit, chocolate, alcohol or other sweets? | Binary Categorical Variable               | Predictor                       | 831                |\n|                 |                          |                                                                                                                                                                          |                                           |                                 |                    |\n|                 |                          | 2 levels:`yes`,`no`                                                                                                                                                      |                                           |                                 |                    |\n+-----------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+---------------------------------+--------------------+\n| `min_num`       | `R01R_A_MINFIRST_ECIG`   | Amount of time from waking to smoking first e-cigarette of any given day (in minutes).                                                                                   | Quantitative Variable                     | Predictor                       | 853                |\n+-----------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+---------------------------------+--------------------+\n\nThe levels of the categorical variables and their description are as follows:\n\n**`age_range`**\n\n**How old was the participant when they first used an e-cigarette, even one or two times?**\n\n| Level    | Description            | Distinct Observations in Level |\n|----------|------------------------|--------------------------------|\n| `<18`    | Less than 18 years old | 54                             |\n| `18to24` | 18 to 24 years old     | 365                            |\n| `25to34` | 25 to 34 years old     | 276                            |\n| `35to44` | 35 to 44 years old     | 181                            |\n| `45to54` | 45 to 54 years old     | 169                            |\n| `>55`    | 55 years old or older  | 147                            |\n\n**`less_harm`**\n\n**Did the participant use / used to use e-cigarettes because they might be / have been less harmful to them?**\n\n| Level | Description | Distinct Observations in Level |\n|-------|-------------|--------------------------------|\n| `yes` | Yes         | 955                            |\n| `no`  | No          | 239                            |\n\n**`ecig_reg`**\n\n**Has the participant ever used e-cigarettes fairly regularly?**\n\n| Level | Description | Distinct Observations in Level |\n|-------|-------------|--------------------------------|\n| `yes` | Yes         | 369                            |\n| `no`  | No          | 831                            |\n\n**`harm_perc`**\n\n**To the participant, is using e-cigarettes less harmful, about the same, or more harmful than smoking cigarettes?**\n\n+---------------+-------------------------------+--------------------------------+\n| Level         | Description                   | Distinct Observations in Level |\n+===============+===============================+================================+\n| `1`           | Less harmful                  | 822                            |\n+---------------+-------------------------------+--------------------------------+\n| `2`           | About the Same / More harmful | 366                            |\n+---------------+-------------------------------+--------------------------------+\n\n**`price_paid`**\n\n**About how much did the participant pay for their e-cigarette?**\n\n| Level       | Description     | Distinct Observations in Level |\n|-------------|-----------------|--------------------------------|\n| `Below$10`  | Less than \\$10  | 189                            |\n| `$10to$20`  | \\$10 to \\$20    | 260                            |\n| `$21to$100` | \\$21 to \\$100   | 328                            |\n| `>$100`     | More than \\$100 | 30                             |\n\n**`ecig_nico`**\n\n**Does the e-cigarette the participant usually uses contain nicotine?**\n\n| Level | Description | Distinct Observations in Level |\n|-------|-------------|--------------------------------|\n| `yes` | Yes         | 320                            |\n| `no`  | No          | 48                             |\n\n**`ecig_flavored`**\n\n**Is the regular/last brand of e-cigarettes used by the participant flavored to taste like menthol, mint, clove, spice, candy, fruit, chocolate, alcohol or other sweets?**\n\n| Level | Description | Distinct Observations in Level |\n|-------|-------------|--------------------------------|\n| `yes` | Yes         | 246                            |\n| `no`  | No          | 123                            |\n\n## Numerical Description\n\nThe `describe` function from the `Hmisc` package was used on the entire tibble.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndescribe(data_final)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ndata_final \n\n 12  Variables      1200  Observations\n--------------------------------------------------------------------------------\npersonid \n       n  missing distinct \n    1200        0     1200 \n\nlowest : P000000176 P000000318 P000000457 P000001710 P000001806\nhighest: P000497409 P000498677 P000499021 P000499448 P000499846\n--------------------------------------------------------------------------------\necig_30day \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n    1200        0       28    0.972     5.11    6.663        0        0 \n     .25      .50      .75      .90      .95 \n       0        2        6       15       20 \n\nlowest :  0  1  2  3  4, highest: 25 26 28 29 30\n--------------------------------------------------------------------------------\npuff_num \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n     351      849       28     0.99    10.77    10.15        2        3 \n     .25      .50      .75      .90      .95 \n       4        6       10       25       30 \n\nlowest :   1   2   3   4   5, highest:  50  51  60  75 100\n--------------------------------------------------------------------------------\nage_range \n       n  missing distinct \n    1192        8        6 \n                                                    \nValue         <18 18to24 25to34 35to44 45to54    >55\nFrequency      54    365    276    181    169    147\nProportion  0.045  0.306  0.232  0.152  0.142  0.123\n--------------------------------------------------------------------------------\nless_harm \n       n  missing distinct \n    1194        6        2 \n                  \nValue      Yes  No\nFrequency  955 239\nProportion 0.8 0.2\n--------------------------------------------------------------------------------\necig_reg \n       n  missing distinct \n    1200        0        2 \n                      \nValue        Yes    No\nFrequency    369   831\nProportion 0.308 0.693\n--------------------------------------------------------------------------------\nharm_perc \n       n  missing distinct \n    1188       12        2 \n                                    \nValue         less_harm same_or_more\nFrequency           822          366\nProportion        0.692        0.308\n--------------------------------------------------------------------------------\nprice_paid \n       n  missing distinct \n     807      393        4 \n                                                  \nValue       Below$10  $10to$20 $21to$100     >$100\nFrequency        189       260       328        30\nProportion     0.234     0.322     0.406     0.037\n--------------------------------------------------------------------------------\necig_nico \n       n  missing distinct \n     368      832        2 \n                    \nValue       Yes   No\nFrequency   320   48\nProportion 0.87 0.13\n--------------------------------------------------------------------------------\necig_flavored \n       n  missing distinct \n     369      831        2 \n                      \nValue        Yes    No\nFrequency    246   123\nProportion 0.667 0.333\n--------------------------------------------------------------------------------\nmin_num \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n     347      853       30    0.993    149.1      182        3        5 \n     .25      .50      .75      .90      .95 \n      15       60      240      360      522 \n\nlowest :    1    2    3    4    5, highest:  720  780  840  900 1020\n--------------------------------------------------------------------------------\necig_smoker \n       n  missing distinct \n    1200        0        2 \n                      \nValue          1     2\nFrequency     41  1159\nProportion 0.034 0.966\n--------------------------------------------------------------------------------\n```\n:::\n:::\n\n\n# Linear Regression Plans\n\n## My First Research Question\n\n*E-Cigarette Perception, Smoking Habits, and their association with Heavy E-Cigarette Use:*\n\n**Are smoking e-cigarettes that contain nicotine, the perception of the purported healthiness of e-cigarettes when compared to smoking regular cigarettes, and smoking habits strong predictors of heavy e-cigarette use in adulthood?**\n\n## My Quantitative Outcome\n\nThe quantitative variable I will be predicting is `ecig_30day`.\n\nIn the United States, e-cigarettes are not subject to the same marketing and promotion restrictions that apply to cigarettes. E-cigarette companies are permitted to advertise their products through mass media, and via the internet. Previous studies have demonstrated that e-cigarettes companies exacerbate and expand the tobacco epidemic by bringing lower risk youth into the market.^\\[1\\]^ E-Cigarette use among young adults has been rapidly expanding, and has surpassed conventional cigarette use among young adults.^\\[2\\]^\n\nFrom a study conducted in 2017, while the demographic and behavioral risk profiles of most youth who reported smoking cigarettes (both cigarettes and e-cigarettes) are consistent with smoking cigarettes, the risk profiles of the remaining e-cigarette-only users (about 25% of e-cigarette users) suggested that these individuals would have been unlikely to have initiated tobacco product use with cigarettes.^\\[3\\]^\n\nE-cigarettes are reducing smoking cessation rates and expanding the nicotine market by attracting low-risk youth who would be unlikely to initiate nicotine use with conventional cigarettes.^\\[4\\]^\n\nBy attempting to predict higher use of e-cigarettes in the past 30 days(at the time of data collection) with the variables under study, the association between e-cigarette perception and smoking habits with heavy e-cigarette use can be studied.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_lin |>\n  filter(complete.cases(ecig_30day)) |>\n  dim()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1200    6\n```\n:::\n:::\n\n\nOut of the 1200 rows in `data_lin`, all 1200 have complete data on the outcome variable `ecig_30day`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- \n  ggplot(data_lin, aes(x = ecig_30day)) +\n  geom_histogram(bins = 15, \n  fill = \"#2b8cbe\", col = \"white\") +\n  labs( x = \"Number of days used an e-cigarette\", y =\"\")\n\np2 <- \n  ggplot(data_lin, aes(sample = ecig_30day)) + \n  geom_qq(col = \"#2b8cbe\") + geom_qq_line(col = \"red\") +\n  labs(x = \"\", y = \"Number of days used an e-cigarette\")\n\np3 <- \n  ggplot(data_lin, aes(x = \"\", y = ecig_30day)) +\n  geom_violin(fill = \"#2b8cbe\", alpha = 0.3) + \n  geom_boxplot(fill = \"#2b8cbe\", width = 0.3,\n               outlier.color = \"red\") +\n  labs(y = \"Number of days used an e-cigarette\", x = \"\") + coord_flip()\n\np2 + p1 - p3 +\n  plot_layout(ncol = 1, height = c(3, 2)) + \n  plot_annotation(title = \"Distribution of the number of days participants used an e-cigarette in the past 30 days\",\n         subtitle = glue(\"Across \", nrow(data_lin), \n                           \" participants, taken as a random sample from the DS1001 dataset.\"),\n         caption = \"Data taken from the Population Assessment of Tobacco and Health (PATH) Study.\")\n```\n\n::: {.cell-output-display}\n![](Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-28-1.png){width=960}\n:::\n:::\n\n\nThe distribution is very notably right skewed. Taking the logarithm of the outcome variable might help in making it's distribution more normalized.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndescribe(data_lin$ecig_30day)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ndata_lin$ecig_30day \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n    1200        0       28    0.972     5.11    6.663        0        0 \n     .25      .50      .75      .90      .95 \n       0        2        6       15       20 \n\nlowest :  0  1  2  3  4, highest: 25 26 28 29 30\n```\n:::\n:::\n\n\nThe `describe` function shows that there are 28 distinct values for the `ecig_30day` variable, and the variable has at least 10 different, ordered, observed values.\n\n## My Planned Predictors (Linear Model)\n\nThe inputs that will be used in the linear regression model are:\n\n-   `puff_num`: This is a quantitative variable that has atleast 10 distinct, ordered, observed values.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndescribe(data_lin$puff_num)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ndata_lin$puff_num \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n     351      849       28     0.99    10.77    10.15        2        3 \n     .25      .50      .75      .90      .95 \n       4        6       10       25       30 \n\nlowest :   1   2   3   4   5, highest:  50  51  60  75 100\n```\n:::\n:::\n\n\n-   `age_range`: This is a categorical variable which has 6 categories, that has at least 30 observations in each level of the factor.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_lin|>\n  tabyl(age_range) |>\n  kbl() |>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> age_range </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> percent </th>\n   <th style=\"text-align:right;\"> valid_percent </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> &lt;18 </td>\n   <td style=\"text-align:right;\"> 54 </td>\n   <td style=\"text-align:right;\"> 0.0450000 </td>\n   <td style=\"text-align:right;\"> 0.0453020 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 18to24 </td>\n   <td style=\"text-align:right;\"> 365 </td>\n   <td style=\"text-align:right;\"> 0.3041667 </td>\n   <td style=\"text-align:right;\"> 0.3062081 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 25to34 </td>\n   <td style=\"text-align:right;\"> 276 </td>\n   <td style=\"text-align:right;\"> 0.2300000 </td>\n   <td style=\"text-align:right;\"> 0.2315436 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 35to44 </td>\n   <td style=\"text-align:right;\"> 181 </td>\n   <td style=\"text-align:right;\"> 0.1508333 </td>\n   <td style=\"text-align:right;\"> 0.1518456 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 45to54 </td>\n   <td style=\"text-align:right;\"> 169 </td>\n   <td style=\"text-align:right;\"> 0.1408333 </td>\n   <td style=\"text-align:right;\"> 0.1417785 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> &gt;55 </td>\n   <td style=\"text-align:right;\"> 147 </td>\n   <td style=\"text-align:right;\"> 0.1225000 </td>\n   <td style=\"text-align:right;\"> 0.1233221 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 0.0066667 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n-   `less_harm`, which is a binary categorical variable.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_lin|>\n  tabyl(less_harm) |>\n  kbl() |>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> less_harm </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> percent </th>\n   <th style=\"text-align:right;\"> valid_percent </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Yes </td>\n   <td style=\"text-align:right;\"> 955 </td>\n   <td style=\"text-align:right;\"> 0.7958333 </td>\n   <td style=\"text-align:right;\"> 0.7998325 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> No </td>\n   <td style=\"text-align:right;\"> 239 </td>\n   <td style=\"text-align:right;\"> 0.1991667 </td>\n   <td style=\"text-align:right;\"> 0.2001675 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 0.0050000 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n-   `ecig_nico`, which is a binary categorical variable.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_lin|>\n  tabyl(ecig_nico)|>\n  kbl() |>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> ecig_nico </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> percent </th>\n   <th style=\"text-align:right;\"> valid_percent </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Yes </td>\n   <td style=\"text-align:right;\"> 320 </td>\n   <td style=\"text-align:right;\"> 0.2666667 </td>\n   <td style=\"text-align:right;\"> 0.8695652 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> No </td>\n   <td style=\"text-align:right;\"> 48 </td>\n   <td style=\"text-align:right;\"> 0.0400000 </td>\n   <td style=\"text-align:right;\"> 0.1304348 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:right;\"> 832 </td>\n   <td style=\"text-align:right;\"> 0.6933333 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThere are a total of 4 predictors.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndatatest1 <- data_lin |>\n  filter(complete.cases(personid,ecig_30day,puff_num,age_range,less_harm,ecig_nico)) |>\n  select(personid,ecig_30day,puff_num,age_range,less_harm,ecig_nico)\ndim(datatest1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 137   6\n```\n:::\n:::\n\n\nWith 137 rows having complete observations on all the variables under study, **\\[4 + (N1 - 100)/100\\]** is 4.3, and the number of predictors does not exceed this value.\n\nFrom the cited literature,\n\nI expect higher values of `puff_num` to be associated with higher values of `ecig_30day`. For `less_harm` and `ecig_nico`, I expect the `yes` factor to be associated with higher values of `ecig_30day`, ie, as the two variables change from `no` to `yes`, the value of `ecig_30day` is expected to increase.\n\nI expect the lower levels of `age_range` to be associated with higher values of `ecig_30day`, ie, as `age_range` factors go from the lowest factors to the higher factors, I expect `ecig_30day` to decrease.\n\n# Logistic Regression Plans\n\n## My Second Research Question\n\n*Regular e-cigarette use and it's associated factors:*\n\n**Are factors such as using flavored e-cigarettes, or needing to use e-cigarettes immediately after waking up, or using e-cigarettes with nicotine, or use of e-cigarettes as a healthier alternative to regular cigarettes associated with regular e-cigarette use?**\n\n## My Binary Outcome\n\nThe binary outcome I will be predicting is `ecig_reg`.\n\nIn the United States, e-cigarettes and their market value have rapidly expanded over the past years.^\\[2\\]^ E-cigarette use and it's prevalent adoption have resulted in youth and young adults who would otherwise not have been exposed to nicotine/tobacco products to begin the use of the drug via e-cigarettes.^\\[3\\]^\n\nReasons for this increased use of e-cigarettes are many, including the perception of e-cigarettes as being healthier than regular cigarettes, the presence of flavored e-cigarettes available for use, and the availability of cheap, refillable cartridges that only require e-cigarette fluid.^\\[1\\]^ By attempting to predict the odds of being a regular user of e-cigarettes using the predictors under study, the association between these factors and the odds of adoption of regular e-cigarette use can be more thoroughly studied.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_log|>\n  tabyl(ecig_reg)|>\n  kbl() |>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> ecig_reg </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> percent </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Yes </td>\n   <td style=\"text-align:right;\"> 369 </td>\n   <td style=\"text-align:right;\"> 0.3075 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> No </td>\n   <td style=\"text-align:right;\"> 831 </td>\n   <td style=\"text-align:right;\"> 0.6925 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThere are no missing values for the outcome variable.\n\n## My Planned Predictors (Logistic Model)\n\nFor the logistic regression model, the following are the predictors I intend to use:\n\n-   `min_num`: This is a quantitative variable that has atleast 10 distinct, ordered, observed values.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndescribe(data_log$min_num)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ndata_log$min_num \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n     347      853       30    0.993    149.1      182        3        5 \n     .25      .50      .75      .90      .95 \n      15       60      240      360      522 \n\nlowest :    1    2    3    4    5, highest:  720  780  840  900 1020\n```\n:::\n:::\n\n\n-   `price_paid`: This is a categorical variable which has 4 categories, that has at least 30 observations in each level of the factor.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_log |>\n  tabyl(price_paid)|>\n  kbl() |>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> price_paid </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> percent </th>\n   <th style=\"text-align:right;\"> valid_percent </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Below$10 </td>\n   <td style=\"text-align:right;\"> 189 </td>\n   <td style=\"text-align:right;\"> 0.1575000 </td>\n   <td style=\"text-align:right;\"> 0.2342007 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> $10to$20 </td>\n   <td style=\"text-align:right;\"> 260 </td>\n   <td style=\"text-align:right;\"> 0.2166667 </td>\n   <td style=\"text-align:right;\"> 0.3221809 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> $21to$100 </td>\n   <td style=\"text-align:right;\"> 328 </td>\n   <td style=\"text-align:right;\"> 0.2733333 </td>\n   <td style=\"text-align:right;\"> 0.4064436 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> &gt;$100 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 0.0250000 </td>\n   <td style=\"text-align:right;\"> 0.0371747 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:right;\"> 393 </td>\n   <td style=\"text-align:right;\"> 0.3275000 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n-   `harm_perc`, which is a binary categorical variable.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_log |>\n  tabyl(harm_perc)|>\n  kbl() |>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> harm_perc </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> percent </th>\n   <th style=\"text-align:right;\"> valid_percent </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> less_harm </td>\n   <td style=\"text-align:right;\"> 822 </td>\n   <td style=\"text-align:right;\"> 0.685 </td>\n   <td style=\"text-align:right;\"> 0.6919192 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> same_or_more </td>\n   <td style=\"text-align:right;\"> 366 </td>\n   <td style=\"text-align:right;\"> 0.305 </td>\n   <td style=\"text-align:right;\"> 0.3080808 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 0.010 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\\-`ecig_nico`, which is a binary categorical variable.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_log |>\n  tabyl(ecig_nico)|>\n  kbl() |>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> ecig_nico </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> percent </th>\n   <th style=\"text-align:right;\"> valid_percent </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Yes </td>\n   <td style=\"text-align:right;\"> 320 </td>\n   <td style=\"text-align:right;\"> 0.2666667 </td>\n   <td style=\"text-align:right;\"> 0.8695652 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> No </td>\n   <td style=\"text-align:right;\"> 48 </td>\n   <td style=\"text-align:right;\"> 0.0400000 </td>\n   <td style=\"text-align:right;\"> 0.1304348 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:right;\"> 832 </td>\n   <td style=\"text-align:right;\"> 0.6933333 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\\-`ecig_flavored`, which is a binary categorical variable.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_log |>\n  tabyl(ecig_flavored)|>\n  kbl() |>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> ecig_flavored </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> percent </th>\n   <th style=\"text-align:right;\"> valid_percent </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Yes </td>\n   <td style=\"text-align:right;\"> 246 </td>\n   <td style=\"text-align:right;\"> 0.2050 </td>\n   <td style=\"text-align:right;\"> 0.6666667 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> No </td>\n   <td style=\"text-align:right;\"> 123 </td>\n   <td style=\"text-align:right;\"> 0.1025 </td>\n   <td style=\"text-align:right;\"> 0.3333333 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:right;\"> 831 </td>\n   <td style=\"text-align:right;\"> 0.6925 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThere are 5 predictors.\n\nWith 369 subjects in the smaller of my two outcome groups, **\\[4 + (N2 - 100)/100\\]** is 6.69, and the number of predictors does not exceed this value.\n\nFrom the cited literature,\n\nI expect lower values of `min_num` to be associated with higher odds of being in the `yes` category of `ecig_reg`.I also expect lower values of `price_paid` to be associated with higher odds of being in the `yes` category of `ecig_reg`. I also expect `yes` values for `ecig_nico` and `ecig_flavored` to be associated with higher odds of being in the `yes` category of `ecig_reg`. I expect `less_harm` values for `harm_perc` to be associated with higher odds of being in the `yes` category of `ecig_reg`.\n\n# Linear Regression Analyses\n\n## Missingness\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_lin |>\n  miss_var_summary() |>\n  kbl() |>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> variable </th>\n   <th style=\"text-align:right;\"> n_miss </th>\n   <th style=\"text-align:right;\"> pct_miss </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> puff_num </td>\n   <td style=\"text-align:right;\"> 849 </td>\n   <td style=\"text-align:right;\"> 70.7500000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ecig_nico </td>\n   <td style=\"text-align:right;\"> 832 </td>\n   <td style=\"text-align:right;\"> 69.3333333 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 0.6666667 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> less_harm </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 0.5000000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> personid </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0000000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ecig_30day </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0000000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThere is missing data in all of the variables under study, and the outcome variable `ecig_30day` does not have any missing values. There are missing predictor values for more than 10% of the subjects under study, and more than 50 subjects have missing values. \n\nThe data can be assumed to be MAR (Missing At Random), since the missing data are not randomly distributed. It cannot be assumed to be MNAR (Missing Not At Random) since there does not appear to be a relationship between the magnitude of a value and it's missingness (or inclusion in the non-missing data), since there is no preponderance of values with lower or higher magnitude being missing. \n\nSingle imputation was then performed on the dataset, to account for missingness. The complete dataset, containing the data for both the analyses had it's missing values imputed. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(4322023)\ndata_final_i <- data_final |> data.frame() |>\n  impute_rhd(less_harm ~ ecig_30day + ecig_reg) |>\n  impute_rhd(age_range ~ ecig_30day + ecig_reg + less_harm) |>\n  impute_rhd(ecig_nico ~ age_range ) |>\n  impute_rlm(puff_num ~ ecig_30day ) |>\n  impute_cart(harm_perc ~ ecig_reg) |>\n  impute_cart(price_paid ~ ecig_reg + harm_perc) |>\n  impute_cart(ecig_flavored ~ ecig_reg + price_paid) |>\n  impute_cart(ecig_nico ~ ecig_reg + ecig_flavored) |>\n  impute_pmm(min_num ~ ecig_30day + age_range + less_harm) |>\n  as_tibble()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_lin_i <- data_final_i |>\n  select(personid,ecig_30day,puff_num,ecig_nico,age_range,less_harm)\n```\n:::\n\n\nThe imputed dataset was then checked to see if it was still missing any values. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nmiss_var_summary(data_lin_i) |>\n  kbl() |>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> variable </th>\n   <th style=\"text-align:right;\"> n_miss </th>\n   <th style=\"text-align:right;\"> pct_miss </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> personid </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ecig_30day </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> puff_num </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ecig_nico </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> less_harm </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n## Outcome Transformation\n\nThe distribution of the outcome variable was plotted. \n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- \n  ggplot(data_lin_i, aes(x = ecig_30day)) +\n  geom_histogram(bins = 15, \n  fill = \"#2b8cbe\", col = \"white\") +\n  labs( x = \"Number of days used an e-cigarette\", y =\"\")\n\np2 <- \n  ggplot(data_lin_i, aes(sample = ecig_30day)) + \n  geom_qq(col = \"#2b8cbe\") + geom_qq_line(col = \"red\") +\n  labs(x = \"\", y = \"Number of days used an e-cigarette\")\n\np3 <- \n  ggplot(data_lin_i, aes(x = \"\", y = ecig_30day)) +\n  geom_violin(fill = \"#2b8cbe\", alpha = 0.3) + \n  geom_boxplot(fill = \"#2b8cbe\", width = 0.3,\n               outlier.color = \"red\") +\n  labs(y = \"Number of days used an e-cigarette\", x = \"\") + coord_flip()\n\np2 + p1 - p3 +\n  plot_layout(ncol = 1, height = c(3, 2)) + \n  plot_annotation(title = \"Distribution of the number of days participants used an e-cigarette in the past 30 days\",\n         subtitle = glue(\"Across \", nrow(data_lin_i), \n                           \" participants, taken as a random sample from the DS1001 dataset.\"),\n         caption = \"Data taken from the Population Assessment of Tobacco and Health (PATH) Study.\")\n```\n\n::: {.cell-output-display}\n![](Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-45-1.png){width=960}\n:::\n:::\n\n\nThe outcome variable was modified so that the data would be strictly positive, making it possible to assess the need for transformation. 1 was added to each value. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_lin_i <- data_lin_i |>\n  mutate(int_ecig_30day = ecig_30day + 1) \nboxCox(data_lin_i$int_ecig_30day ~ 1)\n```\n\n::: {.cell-output-display}\n![](Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-46-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npowerTransform(data_lin_i$int_ecig_30day ~ 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nEstimated transformation parameter \n        Y1 \n-0.1938334 \n```\n:::\n:::\n\n\nThe Box-Cox plot peaks at a Y value of -0.19, which is approximately close enough to -1 to justify using -1 on Tukey's ladder of power transformations, which suggests taking the inverse of the outcome. \n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- \n  ggplot(data_lin_i, aes(x = log(int_ecig_30day))) +\n  geom_histogram(bins = 15, \n  fill = \"#2b8cbe\", col = \"white\") +\n  labs( x = \"Natural Logarithm of the Number of days participant used an e-cigarette\", y =\"\")\n\np2 <- \n  ggplot(data_lin_i, aes(sample = log(int_ecig_30day))) + \n  geom_qq(col = \"#2b8cbe\") + geom_qq_line(col = \"red\") +\n  labs(x = \"\", y = str_wrap(\"Natural Logarithm of the Number of days participant used an e-cigarette\", width = 50))\n\np3 <- \n  ggplot(data_lin_i, aes(x = \"\", y = log(int_ecig_30day))) +\n  geom_violin(fill = \"#2b8cbe\", alpha = 0.3) + \n  geom_boxplot(fill = \"#2b8cbe\", width = 0.3,\n               outlier.color = \"red\") +\n  labs(y = \"Natural Logarithm of the Number of days participant used an e-cigarette\", x = \"\") + coord_flip()\n\np2 + p1 - p3 +\n  plot_layout(ncol = 1, height = c(3, 2)) + \n  plot_annotation(title = \"Distribution of the natural logarithm of the number of days participants used an e-cigarette in the past 30 days\",\n         subtitle = glue(\"Across \", nrow(data_lin_i), \n                           \" participants, taken as a random sample from the DS1001 dataset.\"),\n         caption = \"Data taken from the Population Assessment of Tobacco and Health (PATH) Study.\")\n```\n\n::: {.cell-output-display}\n![](Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-48-1.png){width=960}\n:::\n:::\n\n\n## Scatterplot Matrix and Collinearity\n\nA new variable `log_ecig_30day` was created by taking the natural logarithm of the outcome variable, which itself was modified by adding 1 to each of it's values. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_lin_i <- data_lin_i |>\n  mutate(log_ecig_30day = log(int_ecig_30day))\n```\n:::\n\n\nThe `ggpairs` function was used to plot a scatterplot matrix.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggpairs(data_lin_i, columns = c(\"puff_num\", \"age_range\", \"less_harm\", \n                               \"ecig_nico\", \"log_ecig_30day\"))\n```\n\n::: {.cell-output-display}\n![](Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-50-1.png){width=768}\n:::\n:::\n\n\n`mod_A` was fit using the `lm` function. The `vif` function from the `car` package was used to estimate if the variables had significant collinearity with each other. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod_A_car <- lm(ecig_30day ~ puff_num + age_range + less_harm + ecig_nico, data = data_lin_i )\ncar::vif(mod_A_car)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n              GVIF Df GVIF^(1/(2*Df))\npuff_num  1.011415  1        1.005691\nage_range 1.045301  5        1.004440\nless_harm 1.006246  1        1.003118\necig_nico 1.044649  1        1.022081\n```\n:::\n:::\n\n\nFrom the output, the variables do not seem to have significant collinearity with each other.\n\n## Model A\n\n### Fitting Model A\n\nModel A was fit using both `lm` and `ols`. The outcome variable is `log_ecig_30day`, and the predictors are `puff_num` (A Quantitative variable), `age_range` (A multi-categorical variable), `less_harm` and `ecig_nico`(both binary variables). \n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod_A <- lm(log_ecig_30day ~ puff_num + age_range + less_harm + ecig_nico, data = data_lin_i )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndd <- datadist(data_lin_i)\noptions(datadist = \"dd\")\nmod_A_ols <- ols(log_ecig_30day ~ puff_num + age_range + less_harm + ecig_nico, data = data_lin_i, \n                 x = TRUE, y = TRUE )\n```\n:::\n\n\n### Tidied Coefficient Estimates (Model A)\n\nWith confidence levels of 90%, the lm model (`mod_A`) had it's coefficients tidied and placed in a table that was presented using `kable`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(mod_A, conf.int = TRUE, conf.level = 0.90) |>\n  select(term, estimate, se = std.error, \n         low90 = conf.low, high90 = conf.high, \n         p = p.value) |>\n  kable(digits = 3) |>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> se </th>\n   <th style=\"text-align:right;\"> low90 </th>\n   <th style=\"text-align:right;\"> high90 </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 0.980 </td>\n   <td style=\"text-align:right;\"> 0.138 </td>\n   <td style=\"text-align:right;\"> 0.753 </td>\n   <td style=\"text-align:right;\"> 1.207 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> puff_num </td>\n   <td style=\"text-align:right;\"> 0.055 </td>\n   <td style=\"text-align:right;\"> 0.004 </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.062 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range18to24 </td>\n   <td style=\"text-align:right;\"> -0.204 </td>\n   <td style=\"text-align:right;\"> 0.142 </td>\n   <td style=\"text-align:right;\"> -0.437 </td>\n   <td style=\"text-align:right;\"> 0.030 </td>\n   <td style=\"text-align:right;\"> 0.151 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range25to34 </td>\n   <td style=\"text-align:right;\"> -0.082 </td>\n   <td style=\"text-align:right;\"> 0.145 </td>\n   <td style=\"text-align:right;\"> -0.320 </td>\n   <td style=\"text-align:right;\"> 0.157 </td>\n   <td style=\"text-align:right;\"> 0.574 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range35to44 </td>\n   <td style=\"text-align:right;\"> -0.169 </td>\n   <td style=\"text-align:right;\"> 0.151 </td>\n   <td style=\"text-align:right;\"> -0.417 </td>\n   <td style=\"text-align:right;\"> 0.080 </td>\n   <td style=\"text-align:right;\"> 0.263 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range45to54 </td>\n   <td style=\"text-align:right;\"> -0.040 </td>\n   <td style=\"text-align:right;\"> 0.152 </td>\n   <td style=\"text-align:right;\"> -0.290 </td>\n   <td style=\"text-align:right;\"> 0.210 </td>\n   <td style=\"text-align:right;\"> 0.794 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range&gt;55 </td>\n   <td style=\"text-align:right;\"> 0.068 </td>\n   <td style=\"text-align:right;\"> 0.155 </td>\n   <td style=\"text-align:right;\"> -0.187 </td>\n   <td style=\"text-align:right;\"> 0.324 </td>\n   <td style=\"text-align:right;\"> 0.660 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> less_harmNo </td>\n   <td style=\"text-align:right;\"> -0.183 </td>\n   <td style=\"text-align:right;\"> 0.070 </td>\n   <td style=\"text-align:right;\"> -0.298 </td>\n   <td style=\"text-align:right;\"> -0.067 </td>\n   <td style=\"text-align:right;\"> 0.009 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ecig_nicoNo </td>\n   <td style=\"text-align:right;\"> -0.117 </td>\n   <td style=\"text-align:right;\"> 0.086 </td>\n   <td style=\"text-align:right;\"> -0.258 </td>\n   <td style=\"text-align:right;\"> 0.024 </td>\n   <td style=\"text-align:right;\"> 0.172 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### Summarizing Fit (Model A)\n\nUsing the `glance` function. the numerical summaries of `mod_A`'s fit were placed in a table.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglance(mod_A) |>\n  select(r2 = r.squared, adjr2 = adj.r.squared, sigma, \n         AIC, BIC, nobs, df, df.residual) |>\n  kable(digits = c(3, 3, 2, 1, 1, 0, 0, 0))|>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> r2 </th>\n   <th style=\"text-align:right;\"> adjr2 </th>\n   <th style=\"text-align:right;\"> sigma </th>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n   <th style=\"text-align:right;\"> nobs </th>\n   <th style=\"text-align:right;\"> df </th>\n   <th style=\"text-align:right;\"> df.residual </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.142 </td>\n   <td style=\"text-align:right;\"> 0.137 </td>\n   <td style=\"text-align:right;\"> 0.97 </td>\n   <td style=\"text-align:right;\"> 3350.3 </td>\n   <td style=\"text-align:right;\"> 3401.2 </td>\n   <td style=\"text-align:right;\"> 1200 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 1191 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### Regression Diagnostics (Model A)\n\nThe four main diagnostic residual plots were visualized. \n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2,2)); plot(mod_A); par(mfrow = c(1,1))\n```\n\n::: {.cell-output-display}\n![](Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-56-1.png){width=768}\n:::\n:::\n\n\nFrom the normal Q-Q plot, there appears to be serious problems with the assumption of normality, despite the transformation of the outcome variable. There is also a definite pattern in the residuals vs fitted values plot, which has implications regarding the assumption of linearity. The scale-location plot also has a definite non-linear pattern, indicating problems with the assumption of constant variance. \n\n## Non-Linearity\n\nAdding a non-linear term to model A might help with the problems visualized with the various assumptions made in a linear regression model. A Spearman $p^2$ plot was made with the predictors in model A.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(spearman2(log_ecig_30day ~ puff_num + age_range + less_harm + ecig_nico, data = data_lin_i ))\n```\n\n::: {.cell-output-display}\n![](Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-57-1.png){width=672}\n:::\n:::\n\n\nFrom the plot, if a non-linear term were to improve the fit of the model, the predictor most likely to do so would be `puff_num`, followed much less closely by `less_harm`.\n\nA restricted cubic spline with 4 knots in `puff_num` was then added to the model, spending 2 **additional** degrees of freedom as compared to model A (with the main effect of `puff_num`). \n\nAn interaction term between the main effects of `puff_num` and `less_harm` was added to the model, spending a **single** additional degree of freedom.\n\nOverall, this would result in 3 additional degrees of freedom being spent.\n\n## Model B\n\n### Fitting Model B\n\nUsing `lm` and `ols`, model B was fit, using a restricted cubic spline on `puff_num` and an interaction term between the main effects of `puff_num` and `less_harm`. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod_B <- lm(log_ecig_30day ~ rcs(puff_num,4) + age_range + less_harm + ecig_nico + puff_num%ia%less_harm, data = data_lin_i )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndd <- datadist(data_lin_i)\noptions(datadist = \"dd\")\n\nmod_B_ols <- ols(log_ecig_30day ~ rcs(puff_num,4) + age_range + less_harm + ecig_nico + puff_num%ia%less_harm, data = data_lin_i,\n                 x = TRUE, y = TRUE)\n```\n:::\n\n\n### Tidied Coefficient Estimates (Model B)\n\n`mod_B` had it's coefficients tidied with a 90% confidence interval and placed in a tidy table.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(mod_B, conf.int = TRUE, conf.level = 0.90) |>\n  select(term, estimate, se = std.error, \n         low90 = conf.low, high90 = conf.high, \n         p = p.value) |>\n  kable(digits = 3) |>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> se </th>\n   <th style=\"text-align:right;\"> low90 </th>\n   <th style=\"text-align:right;\"> high90 </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 3.476 </td>\n   <td style=\"text-align:right;\"> 0.214 </td>\n   <td style=\"text-align:right;\"> 3.124 </td>\n   <td style=\"text-align:right;\"> 3.828 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rcs(puff_num, 4)puff_num </td>\n   <td style=\"text-align:right;\"> -0.620 </td>\n   <td style=\"text-align:right;\"> 0.040 </td>\n   <td style=\"text-align:right;\"> -0.686 </td>\n   <td style=\"text-align:right;\"> -0.554 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rcs(puff_num, 4)puff_num' </td>\n   <td style=\"text-align:right;\"> 11.472 </td>\n   <td style=\"text-align:right;\"> 0.493 </td>\n   <td style=\"text-align:right;\"> 10.660 </td>\n   <td style=\"text-align:right;\"> 12.283 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rcs(puff_num, 4)puff_num'' </td>\n   <td style=\"text-align:right;\"> -57.329 </td>\n   <td style=\"text-align:right;\"> 2.382 </td>\n   <td style=\"text-align:right;\"> -61.251 </td>\n   <td style=\"text-align:right;\"> -53.408 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range18to24 </td>\n   <td style=\"text-align:right;\"> -0.103 </td>\n   <td style=\"text-align:right;\"> 0.112 </td>\n   <td style=\"text-align:right;\"> -0.287 </td>\n   <td style=\"text-align:right;\"> 0.081 </td>\n   <td style=\"text-align:right;\"> 0.357 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range25to34 </td>\n   <td style=\"text-align:right;\"> 0.020 </td>\n   <td style=\"text-align:right;\"> 0.114 </td>\n   <td style=\"text-align:right;\"> -0.169 </td>\n   <td style=\"text-align:right;\"> 0.208 </td>\n   <td style=\"text-align:right;\"> 0.863 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range35to44 </td>\n   <td style=\"text-align:right;\"> -0.060 </td>\n   <td style=\"text-align:right;\"> 0.119 </td>\n   <td style=\"text-align:right;\"> -0.256 </td>\n   <td style=\"text-align:right;\"> 0.135 </td>\n   <td style=\"text-align:right;\"> 0.612 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range45to54 </td>\n   <td style=\"text-align:right;\"> 0.025 </td>\n   <td style=\"text-align:right;\"> 0.120 </td>\n   <td style=\"text-align:right;\"> -0.173 </td>\n   <td style=\"text-align:right;\"> 0.222 </td>\n   <td style=\"text-align:right;\"> 0.838 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range&gt;55 </td>\n   <td style=\"text-align:right;\"> 0.155 </td>\n   <td style=\"text-align:right;\"> 0.122 </td>\n   <td style=\"text-align:right;\"> -0.047 </td>\n   <td style=\"text-align:right;\"> 0.356 </td>\n   <td style=\"text-align:right;\"> 0.206 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> less_harmNo </td>\n   <td style=\"text-align:right;\"> 0.144 </td>\n   <td style=\"text-align:right;\"> 0.114 </td>\n   <td style=\"text-align:right;\"> -0.043 </td>\n   <td style=\"text-align:right;\"> 0.331 </td>\n   <td style=\"text-align:right;\"> 0.204 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ecig_nicoNo </td>\n   <td style=\"text-align:right;\"> -0.121 </td>\n   <td style=\"text-align:right;\"> 0.068 </td>\n   <td style=\"text-align:right;\"> -0.232 </td>\n   <td style=\"text-align:right;\"> -0.009 </td>\n   <td style=\"text-align:right;\"> 0.076 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> puff_num %ia% less_harm </td>\n   <td style=\"text-align:right;\"> -0.031 </td>\n   <td style=\"text-align:right;\"> 0.014 </td>\n   <td style=\"text-align:right;\"> -0.054 </td>\n   <td style=\"text-align:right;\"> -0.008 </td>\n   <td style=\"text-align:right;\"> 0.029 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### Effects Plot for Model B\n\nThe effects plot for model `mod_B_ols` was created.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(summary(mod_B_ols))\n```\n\n::: {.cell-output-display}\n![](Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-61-1.png){width=672}\n:::\n:::\n\n\n### Summarizing Fit (Model B)\n\nUsing the `glance` function, the numerical summaries of model B's fit were placed in a table. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nglance(mod_B) |>\n  select(r2 = r.squared, adjr2 = adj.r.squared, sigma, \n         AIC, BIC, nobs, df, df.residual) |>\n  kable(digits = c(3, 3, 2, 1, 1, 0, 0, 0)) |>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> r2 </th>\n   <th style=\"text-align:right;\"> adjr2 </th>\n   <th style=\"text-align:right;\"> sigma </th>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n   <th style=\"text-align:right;\"> nobs </th>\n   <th style=\"text-align:right;\"> df </th>\n   <th style=\"text-align:right;\"> df.residual </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.468 </td>\n   <td style=\"text-align:right;\"> 0.463 </td>\n   <td style=\"text-align:right;\"> 0.77 </td>\n   <td style=\"text-align:right;\"> 2782.8 </td>\n   <td style=\"text-align:right;\"> 2849 </td>\n   <td style=\"text-align:right;\"> 1200 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> 1188 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### Regression Diagnostics (Model B)\n\nThe four residual diagnostic plots for model B were obtained.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2,2)); plot(mod_B); par(mfrow = c(1,1))\n```\n\n::: {.cell-output-display}\n![](Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-63-1.png){width=768}\n:::\n:::\n\n\nThe residual plots are improved from the plots in model A. The q-q plot follows a more normal distribution. The residuals vs fitted values plot shows a more linear line, and the scale-location plot shows a more linear model as well. The assumptions of normality, linearity and constant variance are adhered to more rigorously in the residuals of model B, as compared to model A.\n\nWhile there are significant outliers in the q-q plot, the residuals vs leverage plot does not show points that have a Cook's distance of more than 0.5, indicating that these outliers do not exert an undue influence on the model. There are points that have an unusual combination of predictor variables, but their influence on the model is not significant. \n\n## Validating Models A and B\n\nAfter setting a seed, the `data_lin_i` dataset was divided into a training and a testing sample. Two models were created, one model with linear terms alone, and the other model with the non-linear terms recommended by the Spearman $p^2$ plot. The coefficients obtained from these models were then used to obtain the predicted `log_ecig_30day` values in the holdout test sample.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(4322023)\n\ndata_lin_split <- initial_split(data_lin_i, prop = 0.7)\ndata_lin_train <- training(data_lin_split)\ndata_lin_test <- testing(data_lin_split)\n```\n:::\n\n\nFunctions from the `yardstick` package were used to obtain key summary of fit statistics for both the models' predictions of the holdout testing sample. The metrics were then placed in a tibble and displayed using kable.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod_A_train <- ols(log_ecig_30day ~ puff_num + age_range + less_harm + ecig_nico, data = data_lin_train)\nmod_B_train <- ols(log_ecig_30day ~ rcs(puff_num,4) + age_range + less_harm + ecig_nico + puff_num%ia%less_harm,\n                  data = data_lin_train )\nmod_A_test_aug <- augment(mod_A, newdata = data_lin_test)\nmod_B_test_aug <- augment(mod_B, newdata = data_lin_test)\nrep1 <- rmse(data = mod_A_test_aug, truth = log_ecig_30day, estimate = .fitted)\nrep2 <- rmse(data = mod_B_test_aug, truth = log_ecig_30day, estimate = .fitted)\nrep3 <- rsq(data = mod_A_test_aug, truth = log_ecig_30day, estimate = .fitted)\nrep4 <- rsq(data = mod_B_test_aug, truth = log_ecig_30day, estimate = .fitted)\nrep5 <- mae(data = mod_A_test_aug, truth = log_ecig_30day, estimate = .fitted)\nrep6 <- mae(data = mod_B_test_aug, truth = log_ecig_30day, estimate = .fitted)\nrep_full <- bind_rows(rep1, rep2, rep3, rep4, rep5, rep6)\nrep_full <- rep_full |> \n  mutate(Models = c(\"Model A Holdout RMSE\",\"Model B Holdout RMSE\",\"Model A Holdout $R^2$\",\"Model B Holdout $R^2$\",\"Model A Holdout MAE\",\"Model B Holdout MAE\"))\nrep_full <- rep_full |>\n  select(Models, Metric = .metric, Estimate = .estimate)\nrep_full |> kbl() |>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Models </th>\n   <th style=\"text-align:left;\"> Metric </th>\n   <th style=\"text-align:right;\"> Estimate </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Model A Holdout RMSE </td>\n   <td style=\"text-align:left;\"> rmse </td>\n   <td style=\"text-align:right;\"> 0.9562983 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Model B Holdout RMSE </td>\n   <td style=\"text-align:left;\"> rmse </td>\n   <td style=\"text-align:right;\"> 0.7614010 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Model A Holdout $R^2$ </td>\n   <td style=\"text-align:left;\"> rsq </td>\n   <td style=\"text-align:right;\"> 0.1708639 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Model B Holdout $R^2$ </td>\n   <td style=\"text-align:left;\"> rsq </td>\n   <td style=\"text-align:right;\"> 0.4727390 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Model A Holdout MAE </td>\n   <td style=\"text-align:left;\"> mae </td>\n   <td style=\"text-align:right;\"> 0.8158778 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Model B Holdout MAE </td>\n   <td style=\"text-align:left;\"> mae </td>\n   <td style=\"text-align:right;\"> 0.6037231 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### Holdout RMSE, $R^2$ and MAE \n\n| Model | Holdout RMSE | Holdout $R^2$ | Holdout MAE | \n|-------|-----------------|-----------|------------|\n| A | 0.9563 | 0.1709 | 0.8159 | 0.8159 |\n| B | 0.7614 | 0.4727 | 0.5992 | 0.6037\n\n### Validated $R^2$, MSE and IC statistics\n\nAfter setting a seed, the validate function was used to obtain the validated R-squared and MSE values for models A and B.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(4322023); (valA <- validate(mod_A_ols)) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          index.orig training   test optimism index.corrected  n\nR-square      0.1423   0.1495 0.1330   0.0165          0.1258 40\nMSE           0.9393   0.9284 0.9495  -0.0210          0.9603 40\ng             0.3083   0.3251 0.3141   0.0110          0.2972 40\nIntercept     0.0000   0.0000 0.0266  -0.0266          0.0266 40\nSlope         1.0000   1.0000 0.9811   0.0189          0.9811 40\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(4322023); (valB <- validate(mod_B_ols))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          index.orig training   test optimism index.corrected  n\nR-square      0.4682   0.4825 0.4596   0.0229          0.4452 40\nMSE           0.5824   0.5647 0.5918  -0.0272          0.6096 40\ng             0.7450   0.7545 0.7403   0.0142          0.7308 40\nIntercept     0.0000   0.0000 0.0273  -0.0273          0.0273 40\nSlope         1.0000   1.0000 0.9757   0.0243          0.9757 40\n```\n:::\n:::\n\n\n| Model | Validated $R^2$ | Validated MSE | AIC | BIC | DF \n|-------|-----------------|-----------|------------|---------|------|\n| A | 0.1258 | 0.9603 | 3349.8 | 3400.7 | 8 |  \n| B | 0.4452 | 0.6096 | 2782.8 | 2849 |\t11 |\n\n### ANOVA to compare Models A and B\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(mod_A, mod_B)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nModel 1: log_ecig_30day ~ puff_num + age_range + less_harm + ecig_nico\nModel 2: log_ecig_30day ~ rcs(puff_num, 4) + age_range + less_harm + ecig_nico + \n    puff_num %ia% less_harm\n  Res.Df     RSS Df Sum of Sq      F    Pr(>F)    \n1   1191 1127.17                                  \n2   1188  698.93  3    428.24 242.63 < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nThis ANOVA table shows that model B has 3 additional degrees of freedom as compared to model A, and that adding non linear terms has resulted in a significant improvement in the predictive power of the model. \n\n## Final Linear Regression Model\n\nI prefer Model `B`, because:\n\n- Model B has a higher validated $R^2$, and a higher holdout sample $R^2$. \n\n- Model B has a lower validated MSE (Mean Squared Error) and a lower holdout RMSE.\n\n- Model B has a lower holdout MAE, and a lower AIC and BIC.\n\n- Model B's residual plots show that the assumptions of linearity, normality and non-heteroscedasticity are not violated. \n\n### Winning Model's Parameter Estimates\n\nThe model B's raw and adjusted $R^2$ were obtained.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod_B_ols\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear Regression Model\n\nols(formula = log_ecig_30day ~ rcs(puff_num, 4) + age_range + \n    less_harm + ecig_nico + puff_num %ia% less_harm, data = data_lin_i, \n    x = TRUE, y = TRUE)\n\n                Model Likelihood    Discrimination    \n                      Ratio Test           Indexes    \nObs    1200    LR chi2    757.68    R2       0.468    \nsigma0.7670    d.f.           11    R2 adj   0.463    \nd.f.   1188    Pr(> chi2) 0.0000    g        0.745    \n\nResiduals\n\n     Min       1Q   Median       3Q      Max \n-3.17538 -0.63628  0.04184  0.48501  2.62802 \n\n                        Coef     S.E.   t      Pr(>|t|)\nIntercept                 3.4764 0.2139  16.26 <0.0001 \npuff_num                 -0.6200 0.0398 -15.57 <0.0001 \npuff_num'                11.4717 0.4931  23.26 <0.0001 \npuff_num''              -57.3292 2.3822 -24.07 <0.0001 \nage_range=18to24         -0.1032 0.1119  -0.92 0.3568  \nage_range=25to34          0.0197 0.1143   0.17 0.8635  \nage_range=35to44         -0.0605 0.1190  -0.51 0.6115  \nage_range=45to54          0.0246 0.1199   0.20 0.8377  \nage_range=>55             0.1549 0.1224   1.27 0.2059  \nless_harm=No              0.1445 0.1136   1.27 0.2037  \necig_nico=No             -0.1206 0.0678  -1.78 0.0756  \npuff_num * less_harm=No  -0.0309 0.0141  -2.19 0.0290  \n```\n:::\n:::\n\n\n### Model Coefficients\n\nModel B's coefficients were obtained with 90% confidence intervals and presented using kable.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy_mod_B <- tidy(mod_B, conf.int = TRUE, conf.level = 0.90)\n\ntidy_mod_B |>\n  kbl(digits = 4) |> \n  kable_classic_2(font_size = 24, full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> conf.low </th>\n   <th style=\"text-align:right;\"> conf.high </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 3.4764 </td>\n   <td style=\"text-align:right;\"> 0.2139 </td>\n   <td style=\"text-align:right;\"> 16.2554 </td>\n   <td style=\"text-align:right;\"> 0.0000 </td>\n   <td style=\"text-align:right;\"> 3.1243 </td>\n   <td style=\"text-align:right;\"> 3.8284 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rcs(puff_num, 4)puff_num </td>\n   <td style=\"text-align:right;\"> -0.6200 </td>\n   <td style=\"text-align:right;\"> 0.0398 </td>\n   <td style=\"text-align:right;\"> -15.5677 </td>\n   <td style=\"text-align:right;\"> 0.0000 </td>\n   <td style=\"text-align:right;\"> -0.6855 </td>\n   <td style=\"text-align:right;\"> -0.5544 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rcs(puff_num, 4)puff_num' </td>\n   <td style=\"text-align:right;\"> 11.4717 </td>\n   <td style=\"text-align:right;\"> 0.4931 </td>\n   <td style=\"text-align:right;\"> 23.2637 </td>\n   <td style=\"text-align:right;\"> 0.0000 </td>\n   <td style=\"text-align:right;\"> 10.6599 </td>\n   <td style=\"text-align:right;\"> 12.2834 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rcs(puff_num, 4)puff_num'' </td>\n   <td style=\"text-align:right;\"> -57.3292 </td>\n   <td style=\"text-align:right;\"> 2.3822 </td>\n   <td style=\"text-align:right;\"> -24.0658 </td>\n   <td style=\"text-align:right;\"> 0.0000 </td>\n   <td style=\"text-align:right;\"> -61.2506 </td>\n   <td style=\"text-align:right;\"> -53.4078 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range18to24 </td>\n   <td style=\"text-align:right;\"> -0.1032 </td>\n   <td style=\"text-align:right;\"> 0.1119 </td>\n   <td style=\"text-align:right;\"> -0.9219 </td>\n   <td style=\"text-align:right;\"> 0.3568 </td>\n   <td style=\"text-align:right;\"> -0.2874 </td>\n   <td style=\"text-align:right;\"> 0.0811 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range25to34 </td>\n   <td style=\"text-align:right;\"> 0.0197 </td>\n   <td style=\"text-align:right;\"> 0.1143 </td>\n   <td style=\"text-align:right;\"> 0.1720 </td>\n   <td style=\"text-align:right;\"> 0.8635 </td>\n   <td style=\"text-align:right;\"> -0.1685 </td>\n   <td style=\"text-align:right;\"> 0.2079 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range35to44 </td>\n   <td style=\"text-align:right;\"> -0.0605 </td>\n   <td style=\"text-align:right;\"> 0.1190 </td>\n   <td style=\"text-align:right;\"> -0.5080 </td>\n   <td style=\"text-align:right;\"> 0.6115 </td>\n   <td style=\"text-align:right;\"> -0.2564 </td>\n   <td style=\"text-align:right;\"> 0.1355 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range45to54 </td>\n   <td style=\"text-align:right;\"> 0.0246 </td>\n   <td style=\"text-align:right;\"> 0.1199 </td>\n   <td style=\"text-align:right;\"> 0.2048 </td>\n   <td style=\"text-align:right;\"> 0.8377 </td>\n   <td style=\"text-align:right;\"> -0.1728 </td>\n   <td style=\"text-align:right;\"> 0.2219 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range&gt;55 </td>\n   <td style=\"text-align:right;\"> 0.1549 </td>\n   <td style=\"text-align:right;\"> 0.1224 </td>\n   <td style=\"text-align:right;\"> 1.2655 </td>\n   <td style=\"text-align:right;\"> 0.2059 </td>\n   <td style=\"text-align:right;\"> -0.0466 </td>\n   <td style=\"text-align:right;\"> 0.3564 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> less_harmNo </td>\n   <td style=\"text-align:right;\"> 0.1445 </td>\n   <td style=\"text-align:right;\"> 0.1136 </td>\n   <td style=\"text-align:right;\"> 1.2718 </td>\n   <td style=\"text-align:right;\"> 0.2037 </td>\n   <td style=\"text-align:right;\"> -0.0425 </td>\n   <td style=\"text-align:right;\"> 0.3314 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ecig_nicoNo </td>\n   <td style=\"text-align:right;\"> -0.1206 </td>\n   <td style=\"text-align:right;\"> 0.0678 </td>\n   <td style=\"text-align:right;\"> -1.7783 </td>\n   <td style=\"text-align:right;\"> 0.0756 </td>\n   <td style=\"text-align:right;\"> -0.2322 </td>\n   <td style=\"text-align:right;\"> -0.0090 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> puff_num %ia% less_harm </td>\n   <td style=\"text-align:right;\"> -0.0309 </td>\n   <td style=\"text-align:right;\"> 0.0141 </td>\n   <td style=\"text-align:right;\"> -2.1867 </td>\n   <td style=\"text-align:right;\"> 0.0290 </td>\n   <td style=\"text-align:right;\"> -0.0541 </td>\n   <td style=\"text-align:right;\"> -0.0076 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(Predict(mod_B_ols))\n```\n\n::: {.cell-output-display}\n![](Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-71-1.png){width=672}\n:::\n:::\n\n\nThe coefficients for the non-linear term are significantly larger than expected. Given that the outcome of interest is a count outcome, and the predictor (`puff_num`) has a very intuitive relationship with the outcome variable, in that individuals who have a zero for their outcome (`ecig_30day`) could be expected to have significantly lower (or even zero) values of `puff_num`, and individuals with any particular value of `puff_num` would have a collinear relationship with the outcome variable. It can be reasonably expected that the model is being driven significantly towards a particular value of `log_ecig_30day`, which could result in the exploding coefficients seen in the table of coefficients. \n\nThis indicates that model B is not the ideal sort of model to be used for a count outcome like `ecig_30day`.\n\nFollowing this, the validated $R^2$ was also obtained, along with the validated MSE.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(4322023); (valB_imp <- validate(mod_B_ols))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          index.orig training   test optimism index.corrected  n\nR-square      0.4682   0.4825 0.4596   0.0229          0.4452 40\nMSE           0.5824   0.5647 0.5918  -0.0272          0.6096 40\ng             0.7450   0.7545 0.7403   0.0142          0.7308 40\nIntercept     0.0000   0.0000 0.0273  -0.0273          0.0273 40\nSlope         1.0000   1.0000 0.9757   0.0243          0.9757 40\n```\n:::\n:::\n\n\nAn ANOVA test performed on `mod_B_ols` shows that a non linear term (a restricted cubic spline with 4 knots) on `puff_num` had significant impact on the predictive ability of model B, along with the interaction term between the main effect of `puff_num` and `less_harm`. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(mod_B_ols)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                Analysis of Variance          Response: log_ecig_30day \n\n Factor                                              d.f. Partial SS\n puff_num  (Factor+Higher Order Factors)                4 589.511975\n  All Interactions                                      1   2.813085\n  Nonlinear                                             2 425.614545\n age_range                                              5   8.073412\n less_harm  (Factor+Higher Order Factors)               2   3.811854\n  All Interactions                                      1   2.813085\n ecig_nico                                              1   1.860506\n puff_num * less_harm  (Factor+Higher Order Factors)    1   2.813085\n TOTAL NONLINEAR + INTERACTION                          3 428.235704\n REGRESSION                                            11 615.229768\n ERROR                                               1188 698.931962\n MS          F      P     \n 147.3779937 250.50 <.0001\n   2.8130849   4.78 0.0290\n 212.8072723 361.72 <.0001\n   1.6146824   2.74 0.0179\n   1.9059270   3.24 0.0395\n   2.8130849   4.78 0.0290\n   1.8605056   3.16 0.0756\n   2.8130849   4.78 0.0290\n 142.7452346 242.63 <.0001\n  55.9299789  95.07 <.0001\n   0.5883266              \n```\n:::\n:::\n\n\nThe ANOVA table shows that model B has 12 total degrees of freedom, with 4 non-linear terms of freedom. \n\n| Metric | Value |\n|--------------|------------|\n| Raw $R^2$ | 0.468 |\n| Adjusted $R^2$ | 0.463 |\n| Validated $R^2$ | 0.4452 |\n| AIC | 2782.8 | \n| BIC | 2849 |\n| Validated MSE (Mean Squared Error) | 0.6096 |\n\n### Effects Plot for Winning Model\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(mod_B_ols, conf.int = 0.90)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             Effects              Response : log_ecig_30day \n\n Factor                    Low    High   Diff.  Effect    S.E.     Lower 0.9\n puff_num                  5.7586 7.0476 1.2889  0.596830 0.021791  0.560960\n age_range - <18:18to24    2.0000 1.0000     NA  0.103180 0.111920 -0.081062\n age_range - 25to34:18to24 2.0000 3.0000     NA  0.122840 0.061711  0.021257\n age_range - 35to44:18to24 2.0000 4.0000     NA  0.042718 0.069549 -0.071770\n age_range - 45to54:18to24 2.0000 5.0000     NA  0.127730 0.071094  0.010703\n age_range - >55:18to24    2.0000 6.0000     NA  0.258070 0.075061  0.134510\n less_harm - No:Yes        1.0000 2.0000     NA -0.041346 0.057248 -0.135580\n ecig_nico - No:Yes        1.0000 2.0000     NA -0.120600 0.067818 -0.232240\n Upper 0.9 \n  0.6327000\n  0.2874200\n  0.2244300\n  0.1572000\n  0.2447600\n  0.3816300\n  0.0528930\n -0.0089634\n\nAdjusted to: puff_num=6.016428 less_harm=Yes  \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(summary(mod_B_ols, conf.int = 0.90))\n```\n\n::: {.cell-output-display}\n![](Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-75-1.png){width=672}\n:::\n:::\n\n\nFrom the summary above, for the `puff_num` coefficient, in model `mod_b_ols`,\n\nWe can conclude that the estimated effect of moving `puff_num` from 5.76 to 7.05 results in an increase of 0.597 in `log_ecig_30day`, with 90% confidence intervals of 0.595 to 0.733. IE, for model B,\n\n**As an individual's number of e-cigarette puffs taken the last time they smoked an e-cigarette increases from 5.76 to 7.05, the predicted logarithm of the number of days they smoked an e-cigarette in the past 30 days (plus one day) increases by 0.597, with 90% CI(0.561 to 0.633), provided the individual's age when they began smoking, their perception of the harmfulness of e-cigarettes, and their use or lack thereof of nicotine containing e-cigarettes are all held constant.**\n\nGiven that this confidence interval does not include 0, this is a scientifically meaningful effect. \n\n### Model Calibration\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(4322023); plot(calibrate(mod_B_ols))\n```\n\n::: {.cell-output-display}\n![](Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-76-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\nn=1200   Mean absolute error=0.222   Mean squared error=0.06564\n0.9 Quantile of absolute error=0.364\n```\n:::\n:::\n\n\nThe model does not appear to be particularly well calibrated. It under-predicts at the high and low ends of the actual `log_ecig_30day` values, and over-predicts elsewhere.\n\n### Numerical Description of Effect Sizes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(mod_B_ols, conf.int = 0.90) |> kable(digits = 3) |> \n  kable_classic_2(font_size = 24, full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> Low </th>\n   <th style=\"text-align:right;\"> High </th>\n   <th style=\"text-align:right;\"> Diff. </th>\n   <th style=\"text-align:right;\"> Effect </th>\n   <th style=\"text-align:right;\"> S.E. </th>\n   <th style=\"text-align:right;\"> Lower 0.9 </th>\n   <th style=\"text-align:right;\"> Upper 0.9 </th>\n   <th style=\"text-align:right;\"> Type </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> puff_num </td>\n   <td style=\"text-align:right;\"> 5.759 </td>\n   <td style=\"text-align:right;\"> 7.048 </td>\n   <td style=\"text-align:right;\"> 1.289 </td>\n   <td style=\"text-align:right;\"> 0.597 </td>\n   <td style=\"text-align:right;\"> 0.022 </td>\n   <td style=\"text-align:right;\"> 0.561 </td>\n   <td style=\"text-align:right;\"> 0.633 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range - &lt;18:18to24 </td>\n   <td style=\"text-align:right;\"> 2.000 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.103 </td>\n   <td style=\"text-align:right;\"> 0.112 </td>\n   <td style=\"text-align:right;\"> -0.081 </td>\n   <td style=\"text-align:right;\"> 0.287 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range - 25to34:18to24 </td>\n   <td style=\"text-align:right;\"> 2.000 </td>\n   <td style=\"text-align:right;\"> 3.000 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.123 </td>\n   <td style=\"text-align:right;\"> 0.062 </td>\n   <td style=\"text-align:right;\"> 0.021 </td>\n   <td style=\"text-align:right;\"> 0.224 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range - 35to44:18to24 </td>\n   <td style=\"text-align:right;\"> 2.000 </td>\n   <td style=\"text-align:right;\"> 4.000 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.043 </td>\n   <td style=\"text-align:right;\"> 0.070 </td>\n   <td style=\"text-align:right;\"> -0.072 </td>\n   <td style=\"text-align:right;\"> 0.157 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range - 45to54:18to24 </td>\n   <td style=\"text-align:right;\"> 2.000 </td>\n   <td style=\"text-align:right;\"> 5.000 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.128 </td>\n   <td style=\"text-align:right;\"> 0.071 </td>\n   <td style=\"text-align:right;\"> 0.011 </td>\n   <td style=\"text-align:right;\"> 0.245 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range - &gt;55:18to24 </td>\n   <td style=\"text-align:right;\"> 2.000 </td>\n   <td style=\"text-align:right;\"> 6.000 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.258 </td>\n   <td style=\"text-align:right;\"> 0.075 </td>\n   <td style=\"text-align:right;\"> 0.135 </td>\n   <td style=\"text-align:right;\"> 0.382 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> less_harm - No:Yes </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 2.000 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> -0.041 </td>\n   <td style=\"text-align:right;\"> 0.057 </td>\n   <td style=\"text-align:right;\"> -0.136 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ecig_nico - No:Yes </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 2.000 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> -0.121 </td>\n   <td style=\"text-align:right;\"> 0.068 </td>\n   <td style=\"text-align:right;\"> -0.232 </td>\n   <td style=\"text-align:right;\"> -0.009 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n**`puff_num`** description : \n\nFor two subjects with the same age range at which they started smoking e-cigarettes, the same perception of the harmfulness of e-cigarettes, the same kind of usage or lack thereof of e-cigarettes containing nicotine, and if one subject took 5.76 e-cigarette puffs the last time they smoked an e-cigarette, and the other took 7.05 e-cigarettes puffs 7.05 the last time they smoked an e-cigarette, the model estimates that subject 1 will have a log(number of days smoked in the past 30 days + 1) value **0.597 units higher** than subject 2's log(number of days smoked in the past 30 days + 1). The 90% confidence interval for that estimate ranges from 0.561 to\t0.633. \n\n### Nomogram of Winning Model\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(nomogram(mod_B_ols))\n```\n\n::: {.cell-output-display}\n![](Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-78-1.png){width=768}\n:::\n:::\n\n\n### Prediction for a New Subject\n\nA new theoretical subject, who took 5 puffs from an e-cigarette the last time they smoked an e-cigarette, who started smoking e-cigarettes when they were under 18, who uses e-cigarettes because they thought e-cigarettes might be less harmful to them than regular cigarettes, who usually uses an e-cigarette containing nicotine, was created. Their predicted `log_ecig_30day` value was then obtained and exponentiated. 1 was added to the exponentiated value to complete the transformation back into the original value. \n\n\n::: {.cell}\n\n```{.r .cell-code}\npreds <- predict(mod_B_ols, expand.grid(puff_num = 7, age_range = \"<18\",\n                           less_harm = \"Yes\", ecig_nico = \"Yes\"),\nconf.int = 0.90, conf.type = \"individual\") |> as_tibble() |>\n  mutate(point_estimate = (exp(linear.predictors) - 1),\n         lower_orig = (exp(lower) - 1),\n         upper_orig = (exp(upper) - 1)) |>\n  select(point_estimate,lower_orig,upper_orig)\npreds |> kable() |>\n  kable_classic_2(font_size = 24,full_width = F) \n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> point_estimate </th>\n   <th style=\"text-align:right;\"> lower_orig </th>\n   <th style=\"text-align:right;\"> upper_orig </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 2.720541 </td>\n   <td style=\"text-align:right;\"> 0.040103 </td>\n   <td style=\"text-align:right;\"> 12.3087 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\nPredictor Values | Predicted days participant used an e-cigarette in the past 30 days | 90% Confidence Interval |\n---------------------------------------------------------------------|-----------------------------|---------------------------------|\npuff_num = 7, age_range = \"<18\",less_harm = \"Yes\", ecig_nico = \"Yes\" | 2.72 | 0.04 to 12.31 |\n\n# Logistic Regression Analyses\n\n## Missingness\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_log |>\n  miss_var_summary() |>\n  kbl() |>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> variable </th>\n   <th style=\"text-align:right;\"> n_miss </th>\n   <th style=\"text-align:right;\"> pct_miss </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> min_num </td>\n   <td style=\"text-align:right;\"> 853 </td>\n   <td style=\"text-align:right;\"> 71.08333 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ecig_nico </td>\n   <td style=\"text-align:right;\"> 832 </td>\n   <td style=\"text-align:right;\"> 69.33333 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ecig_flavored </td>\n   <td style=\"text-align:right;\"> 831 </td>\n   <td style=\"text-align:right;\"> 69.25000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> price_paid </td>\n   <td style=\"text-align:right;\"> 393 </td>\n   <td style=\"text-align:right;\"> 32.75000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> harm_perc </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 1.00000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> personid </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.00000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ecig_reg </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.00000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThere is missing data in all of the variables under study, and the outcome variable `ecig_reg` does not have any missing values. There are missing predictor values for more than 10% of the subjects under study, and more than 50 subjects have missing values. \n\nThe data can be assumed to be MAR (Missing At Random), since the missing data are not randomly distributed. It cannot be assumed to be MNAR (Missing Not At Random) since there does not appear to be a relationship between the magnitude of a value and it's missingness (or inclusion in the non-missing data), since there is no preponderance of values with lower or higher magnitude being missing. \n\nSingle imputation was already performed on the complete dataset, to account for missingness. The logistic regression dataset was selected.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_log_i <- data_final_i |>\n  select(personid,ecig_reg,harm_perc,price_paid,ecig_flavored,ecig_nico,min_num)\nmiss_var_summary(data_log_i)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 7 × 3\n  variable      n_miss pct_miss\n  <chr>          <int>    <dbl>\n1 personid           0        0\n2 ecig_reg           0        0\n3 harm_perc          0        0\n4 price_paid         0        0\n5 ecig_flavored      0        0\n6 ecig_nico          0        0\n7 min_num            0        0\n```\n:::\n:::\n\n\nThere are no missing predictor variables in the logistic regression dataset after performing single imputation.\n\n## Model Y \n\n### Fitting Model Y\n\nModel Y was fit with both `lrm` and `glm`. `ecig_reg` was the outcome variable, and the predictors were `min_num`, `ecig_nico`, `harm_perc` and `price_paid`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod_Y <- glm(ecig_reg ~ min_num + ecig_nico + ecig_flavored + harm_perc + price_paid,\n            data = data_log_i, family = binomial())\n\nddd <- datadist(data_log_i)\noptions(datadist = \"ddd\")\n\nmod_Y_lrm <- lrm(ecig_reg ~ min_num + ecig_nico + ecig_flavored + harm_perc + price_paid,\n            data = data_log_i, x = TRUE, y = TRUE)\n```\n:::\n\n\n### Tidied Odds Ratio Estimates (Model Y)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(mod_Y, exponentiate = TRUE, conf.int = TRUE, conf.level = 0.95) |>\n  select(term, estimate, se = std.error, \n         low95 = conf.low, high95 = conf.high, p = p.value) |>\n  kable(digits = 3) |>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> se </th>\n   <th style=\"text-align:right;\"> low95 </th>\n   <th style=\"text-align:right;\"> high95 </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 18.682 </td>\n   <td style=\"text-align:right;\"> 0.314 </td>\n   <td style=\"text-align:right;\"> 10.250 </td>\n   <td style=\"text-align:right;\"> 35.172 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> min_num </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.999 </td>\n   <td style=\"text-align:right;\"> 1.001 </td>\n   <td style=\"text-align:right;\"> 0.733 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ecig_nicoNo </td>\n   <td style=\"text-align:right;\"> 0.927 </td>\n   <td style=\"text-align:right;\"> 0.198 </td>\n   <td style=\"text-align:right;\"> 0.632 </td>\n   <td style=\"text-align:right;\"> 1.375 </td>\n   <td style=\"text-align:right;\"> 0.700 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ecig_flavoredNo </td>\n   <td style=\"text-align:right;\"> 0.116 </td>\n   <td style=\"text-align:right;\"> 0.248 </td>\n   <td style=\"text-align:right;\"> 0.070 </td>\n   <td style=\"text-align:right;\"> 0.186 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> harm_percsame_or_more </td>\n   <td style=\"text-align:right;\"> 1.196 </td>\n   <td style=\"text-align:right;\"> 0.164 </td>\n   <td style=\"text-align:right;\"> 0.869 </td>\n   <td style=\"text-align:right;\"> 1.653 </td>\n   <td style=\"text-align:right;\"> 0.274 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> price_paid$10to$20 </td>\n   <td style=\"text-align:right;\"> 0.230 </td>\n   <td style=\"text-align:right;\"> 0.299 </td>\n   <td style=\"text-align:right;\"> 0.126 </td>\n   <td style=\"text-align:right;\"> 0.409 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> price_paid$21to$100 </td>\n   <td style=\"text-align:right;\"> 0.117 </td>\n   <td style=\"text-align:right;\"> 0.293 </td>\n   <td style=\"text-align:right;\"> 0.065 </td>\n   <td style=\"text-align:right;\"> 0.204 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> price_paid&gt;$100 </td>\n   <td style=\"text-align:right;\"> 0.055 </td>\n   <td style=\"text-align:right;\"> 0.479 </td>\n   <td style=\"text-align:right;\"> 0.021 </td>\n   <td style=\"text-align:right;\"> 0.140 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n### Effects Plot (Model Y)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(summary(mod_Y_lrm))\n```\n\n::: {.cell-output-display}\n![](Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-84-1.png){width=672}\n:::\n:::\n\n\n### Summarizing Fit (Model Y)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod_Y_lrm\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLogistic Regression Model\n\nlrm(formula = ecig_reg ~ min_num + ecig_nico + ecig_flavored + \n    harm_perc + price_paid, data = data_log_i, x = TRUE, y = TRUE)\n\n                       Model Likelihood      Discrimination    Rank Discrim.    \n                             Ratio Test             Indexes          Indexes    \nObs          1200    LR chi2     129.72      R2       0.145    C       0.630    \n Yes          369    d.f.             7     R2(7,1200)0.097    Dxy     0.261    \n No           831    Pr(> chi2) <0.0001    R2(7,766.6)0.148    gamma   0.264    \nmax |deriv| 1e-07                            Brier    0.181    tau-a   0.111    \n\n                       Coef    S.E.   Wald Z Pr(>|Z|)\nIntercept               2.9276 0.3140  9.32  <0.0001 \nmin_num                -0.0002 0.0006 -0.34  0.7335  \necig_nico=No           -0.0762 0.1979 -0.39  0.7001  \necig_flavored=No       -2.1513 0.2479 -8.68  <0.0001 \nharm_perc=same_or_more  0.1790 0.1638  1.09  0.2743  \nprice_paid=$10to$20    -1.4684 0.2994 -4.91  <0.0001 \nprice_paid=$21to$100   -2.1453 0.2925 -7.33  <0.0001 \nprice_paid=>$100       -2.8969 0.4788 -6.05  <0.0001 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglance(mod_Y) |>\n  mutate(df = nobs - df.residual - 1) |>\n  select(AIC, BIC, df, df.residual, nobs) |>\n  kable(digits = 1)|>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n   <th style=\"text-align:right;\"> df </th>\n   <th style=\"text-align:right;\"> df.residual </th>\n   <th style=\"text-align:right;\"> nobs </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1367.3 </td>\n   <td style=\"text-align:right;\"> 1408 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 1192 </td>\n   <td style=\"text-align:right;\"> 1200 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### Confusion Matrix (Model Y)\n\nA temporary dataset, log_i_temp, for the putpose of generating a confusion matrix, was created. The outcome variable `ecig_reg` had it's levels changed from \"Yes\" and \"No\" to 1 and 0.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlog_i_temp <- data_log_i |>\n  mutate(ecig_reg = as.factor(ifelse(ecig_reg == \"Yes\",1,0)))\n\nmod_Y_cm <- glm(ecig_reg ~ min_num + ecig_nico + ecig_flavored + harm_perc + price_paid,\n            data = log_i_temp, family = binomial())\n\nresY_aug <- augment(mod_Y_cm, type.predict = \"response\")\n```\n:::\n\n\nMy prediction rule is that the fitted value of pr(ecig_reg = 1) needs to be greater than or equal to 0.5 for me to predict that `ecig_reg` is 1. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ncm_Y <- caret::confusionMatrix(\n  data = factor(resY_aug$.fitted >= 0.5),\n  reference = factor(resY_aug$ecig_reg == 1),\n  positive = \"TRUE\")\n\ncm_Y\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nConfusion Matrix and Statistics\n\n          Reference\nPrediction FALSE TRUE\n     FALSE   826  274\n     TRUE      5   95\n                                          \n               Accuracy : 0.7675          \n                 95% CI : (0.7425, 0.7911)\n    No Information Rate : 0.6925          \n    P-Value [Acc > NIR] : 4.676e-09       \n                                          \n                  Kappa : 0.3153          \n                                          \n Mcnemar's Test P-Value : < 2.2e-16       \n                                          \n            Sensitivity : 0.25745         \n            Specificity : 0.99398         \n         Pos Pred Value : 0.95000         \n         Neg Pred Value : 0.75091         \n             Prevalence : 0.30750         \n         Detection Rate : 0.07917         \n   Detection Prevalence : 0.08333         \n      Balanced Accuracy : 0.62572         \n                                          \n       'Positive' Class : TRUE            \n                                          \n```\n:::\n:::\n\n\n## Non-Linearity\n\nA Spearman $p^2$ plot was created for assessing the terms that are most likely to add predictive power to the model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(spearman2(ecig_reg ~ min_num + ecig_nico + ecig_flavored + harm_perc + price_paid,\n            data = data_log_i))\n```\n\n::: {.cell-output-display}\n![](Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-89-1.png){width=672}\n:::\n:::\n\n\nThe Spearman plot suggests the use of a non-linear term in `min_num`, so a restricted cubic spline with 4 knots in `min_num` will be added to the model, spending *two additional degrees of freedom* than the main effects model.\n\nAn interaction term between the main effect of `ecig_flavored` and `min_num` will be added, spending  *an additional degree of freedom*. \n\n## Model Z\n\nModel Z will add a total of 3 additional degrees of freedom to Model Y, using two non-linear terms. \n\n### Fitting Model Z\n\nModel Z was fit using both `glm` and `lrm`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod_Z <- glm(ecig_reg ~ ecig_nico + rcs(min_num,4) + ecig_flavored + harm_perc + price_paid + ecig_flavored %ia% min_num,\n            data = data_log_i, family = binomial())\n\nddd <- datadist(data_log_i)\noptions(datadist = \"ddd\")\n\nmod_Z_lrm <- lrm(ecig_reg ~ rcs(min_num,4) + ecig_nico + ecig_flavored + harm_perc + price_paid + ecig_flavored %ia% min_num,\n            data = data_log_i, x = TRUE, y = TRUE)\n```\n:::\n\n\n### Tidied Odds Ratio Estimates (Model Z)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(mod_Z, exponentiate = TRUE, conf.int = TRUE, conf.level = 0.90) |>\n  select(term, estimate, se = std.error, \n         low90 = conf.low, high90 = conf.high, p = p.value) |>\n  kable(digits = 3)|>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n```\n:::\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> se </th>\n   <th style=\"text-align:right;\"> low90 </th>\n   <th style=\"text-align:right;\"> high90 </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 0.021 </td>\n   <td style=\"text-align:right;\"> 0.726 </td>\n   <td style=\"text-align:right;\"> 0.006 </td>\n   <td style=\"text-align:right;\"> 0.065 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ecig_nicoNo </td>\n   <td style=\"text-align:right;\"> 0.796 </td>\n   <td style=\"text-align:right;\"> 0.277 </td>\n   <td style=\"text-align:right;\"> 0.510 </td>\n   <td style=\"text-align:right;\"> 1.271 </td>\n   <td style=\"text-align:right;\"> 0.412 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rcs(min_num, 4)min_num </td>\n   <td style=\"text-align:right;\"> 1.104 </td>\n   <td style=\"text-align:right;\"> 0.009 </td>\n   <td style=\"text-align:right;\"> 1.088 </td>\n   <td style=\"text-align:right;\"> 1.121 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rcs(min_num, 4)min_num' </td>\n   <td style=\"text-align:right;\"> 0.843 </td>\n   <td style=\"text-align:right;\"> 0.021 </td>\n   <td style=\"text-align:right;\"> 0.814 </td>\n   <td style=\"text-align:right;\"> 0.871 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rcs(min_num, 4)min_num'' </td>\n   <td style=\"text-align:right;\"> 1.538 </td>\n   <td style=\"text-align:right;\"> 0.081 </td>\n   <td style=\"text-align:right;\"> 1.349 </td>\n   <td style=\"text-align:right;\"> 1.760 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ecig_flavoredNo </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.715 </td>\n   <td style=\"text-align:right;\"> 0.014 </td>\n   <td style=\"text-align:right;\"> 0.151 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> harm_percsame_or_more </td>\n   <td style=\"text-align:right;\"> 1.589 </td>\n   <td style=\"text-align:right;\"> 0.254 </td>\n   <td style=\"text-align:right;\"> 1.052 </td>\n   <td style=\"text-align:right;\"> 2.429 </td>\n   <td style=\"text-align:right;\"> 0.068 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> price_paid$10to$20 </td>\n   <td style=\"text-align:right;\"> 0.111 </td>\n   <td style=\"text-align:right;\"> 0.432 </td>\n   <td style=\"text-align:right;\"> 0.054 </td>\n   <td style=\"text-align:right;\"> 0.224 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> price_paid$21to$100 </td>\n   <td style=\"text-align:right;\"> 0.057 </td>\n   <td style=\"text-align:right;\"> 0.424 </td>\n   <td style=\"text-align:right;\"> 0.028 </td>\n   <td style=\"text-align:right;\"> 0.113 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> price_paid&gt;$100 </td>\n   <td style=\"text-align:right;\"> 0.035 </td>\n   <td style=\"text-align:right;\"> 0.709 </td>\n   <td style=\"text-align:right;\"> 0.011 </td>\n   <td style=\"text-align:right;\"> 0.112 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ecig_flavored %ia% min_num </td>\n   <td style=\"text-align:right;\"> 1.003 </td>\n   <td style=\"text-align:right;\"> 0.004 </td>\n   <td style=\"text-align:right;\"> 0.997 </td>\n   <td style=\"text-align:right;\"> 1.009 </td>\n   <td style=\"text-align:right;\"> 0.446 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### Effects Plot (Model Z)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(summary(mod_Z_lrm, conf.int = 0.90))\n```\n\n::: {.cell-output-display}\n![](Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-92-1.png){width=672}\n:::\n:::\n\n\n### Summarizing Fit (Model Z)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod_Z_lrm\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLogistic Regression Model\n\nlrm(formula = ecig_reg ~ rcs(min_num, 4) + ecig_nico + ecig_flavored + \n    harm_perc + price_paid + ecig_flavored %ia% min_num, data = data_log_i, \n    x = TRUE, y = TRUE)\n\n                       Model Likelihood       Discrimination    Rank Discrim.    \n                             Ratio Test              Indexes          Indexes    \nObs          1200    LR chi2     773.30       R2       0.670    C       0.891    \n Yes          369    d.f.            10     R2(10,1200)0.471    Dxy     0.783    \n No           831    Pr(> chi2) <0.0001    R2(10,766.6)0.631    gamma   0.792    \nmax |deriv| 2e-08                             Brier    0.084    tau-a   0.334    \n\n                           Coef    S.E.   Wald Z Pr(>|Z|)\nIntercept                  -3.8676 0.7261 -5.33  <0.0001 \nmin_num                     0.0987 0.0090 10.99  <0.0001 \nmin_num'                   -0.1707 0.0206 -8.29  <0.0001 \nmin_num''                   0.4303 0.0807  5.33  <0.0001 \necig_nico=No               -0.2277 0.2773 -0.82  0.4116  \necig_flavored=No           -3.0412 0.7147 -4.26  <0.0001 \nharm_perc=same_or_more      0.4633 0.2540  1.82  0.0682  \nprice_paid=$10to$20        -2.1952 0.4318 -5.08  <0.0001 \nprice_paid=$21to$100       -2.8602 0.4241 -6.74  <0.0001 \nprice_paid=>$100           -3.3635 0.7092 -4.74  <0.0001 \necig_flavored=No * min_num  0.0028 0.0037  0.76  0.4457  \n```\n:::\n:::\n\n\n\nThe Nagelkerke $R^2$ for model Z is 0.670. The C statistic is 0.891. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nglance(mod_Z) |>\n  mutate(df = nobs - df.residual - 1) |>\n  select(AIC, BIC, df, df.residual, nobs) |>\n  kable(digits = 1)|>\n  kable_classic_2(font_size = 24,full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n   <th style=\"text-align:right;\"> df </th>\n   <th style=\"text-align:right;\"> df.residual </th>\n   <th style=\"text-align:right;\"> nobs </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 729.7 </td>\n   <td style=\"text-align:right;\"> 785.7 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 1189 </td>\n   <td style=\"text-align:right;\"> 1200 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### Confusion Matrix (Model Z)\n\nAs in Model Y, my prediction rule is that the fitted value of pr(ecig_reg = 1) needs to be greater than or equal to 0.5 for me to predict that `ecig_reg` is 1. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod_Z_cm <- glm(ecig_reg ~ ecig_nico + rcs(min_num,4) + ecig_flavored + harm_perc + price_paid + ecig_flavored %ia% min_num,\n            data = log_i_temp, family = binomial())\n\nresZ_aug <- augment(mod_Z_cm, type.predict = \"response\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncm_Z <- caret::confusionMatrix(\n  data = factor(resZ_aug$.fitted >= 0.5),\n  reference = factor(resZ_aug$ecig_reg == 1),\n  positive = \"TRUE\")\n\ncm_Z\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nConfusion Matrix and Statistics\n\n          Reference\nPrediction FALSE TRUE\n     FALSE   817   99\n     TRUE     14  270\n                                          \n               Accuracy : 0.9058          \n                 95% CI : (0.8879, 0.9218)\n    No Information Rate : 0.6925          \n    P-Value [Acc > NIR] : < 2.2e-16       \n                                          \n                  Kappa : 0.7638          \n                                          \n Mcnemar's Test P-Value : 2.743e-15       \n                                          \n            Sensitivity : 0.7317          \n            Specificity : 0.9832          \n         Pos Pred Value : 0.9507          \n         Neg Pred Value : 0.8919          \n             Prevalence : 0.3075          \n         Detection Rate : 0.2250          \n   Detection Prevalence : 0.2367          \n      Balanced Accuracy : 0.8574          \n                                          \n       'Positive' Class : TRUE            \n                                          \n```\n:::\n:::\n\n\n\n| MODEL | NAGELKERKE $R^2$ | C STATISTIC | AIC | BIC | DF |\n|-------|------------------|-------------|-----|-----|----|\n|   Y   |      0.145       |    0.630    | 1367.3 |\t1408 | 7 |\n|   Z   |      0.670       |    0.891    | 729.7 | 785.7  | 10 |\n\n| MODEL |  SENSITIVITY | SPECIFICITY | POSITIVE PREDICTIVE VALUE |\n|-------|--------------|-------------|---------------------------|\n|   Y   |    0.258     |    0.994    |           0.950           |\n|   Z   |    0.732     |    0.983    |           0.951           |\n\n\n## Validating Models Y and Z\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(4322023); (valY <- validate(mod_Y_lrm))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          index.orig training   test optimism index.corrected  n\nDxy           0.2606   0.3282 0.2917   0.0366          0.2241 40\nR2            0.1445   0.1617 0.1356   0.0260          0.1185 40\nIntercept     0.0000   0.0000 0.0657  -0.0657          0.0657 40\nSlope         1.0000   1.0000 0.9093   0.0907          0.9093 40\nEmax          0.0000   0.0000 0.0325   0.0325          0.0325 40\nD             0.1073   0.1211 0.1003   0.0208          0.0864 40\nU            -0.0017  -0.0017 0.0011  -0.0028          0.0011 40\nQ             0.1089   0.1228 0.0992   0.0236          0.0853 40\nB             0.1814   0.1786 0.1828  -0.0042          0.1856 40\ng             0.7310   0.7958 0.7134   0.0824          0.6486 40\ngp            0.1421   0.1532 0.1406   0.0126          0.1295 40\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(4322023); (valZ <- validate(mod_Z_lrm))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          index.orig training   test optimism index.corrected  n\nDxy           0.7827   0.7994 0.7809   0.0186          0.7641 40\nR2            0.6701   0.6814 0.6641   0.0173          0.6528 40\nIntercept     0.0000   0.0000 0.0495  -0.0495          0.0495 40\nSlope         1.0000   1.0000 0.9496   0.0504          0.9496 40\nEmax          0.0000   0.0000 0.0202   0.0202          0.0202 40\nD             0.6436   0.6591 0.6356   0.0235          0.6201 40\nU            -0.0017  -0.0017 0.0003  -0.0020          0.0003 40\nQ             0.6452   0.6607 0.6353   0.0254          0.6198 40\nB             0.0839   0.0815 0.0852  -0.0037          0.0876 40\ng             3.3667   3.4866 3.3112   0.1754          3.1914 40\ngp            0.3511   0.3546 0.3497   0.0049          0.3462 40\n```\n:::\n:::\n\n\n### Validated $R^2$ and $C$ statistics for each model\n\n| MODEL | VALIDATED $R^2$ | VALIDATED $C$ STATISTIC |\n|-------|-----------------|-----------------------|\n|   Y   |     0.1185      |         0.612         |\n|   Z   |     0.6528      |         0.882         |\n\n## Final Logistic Regression Model\n\nI prefer Model `Z`, for the following reasons:\n\n- Model Z has a higher validated $R^2$ and $C$ statistic\n\n- Model Z has a higher Naegelkerke $R^2$\n\n- Model Z has a lower AIC and BIC\n\n- Model Z has a higher sensitivity, and a higher positive predictive value. While it has the lower specificity, the difference is not wide. \n\n### Winning Model's Parameter Estimates\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod_Z_lrm\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLogistic Regression Model\n\nlrm(formula = ecig_reg ~ rcs(min_num, 4) + ecig_nico + ecig_flavored + \n    harm_perc + price_paid + ecig_flavored %ia% min_num, data = data_log_i, \n    x = TRUE, y = TRUE)\n\n                       Model Likelihood       Discrimination    Rank Discrim.    \n                             Ratio Test              Indexes          Indexes    \nObs          1200    LR chi2     773.30       R2       0.670    C       0.891    \n Yes          369    d.f.            10     R2(10,1200)0.471    Dxy     0.783    \n No           831    Pr(> chi2) <0.0001    R2(10,766.6)0.631    gamma   0.792    \nmax |deriv| 2e-08                             Brier    0.084    tau-a   0.334    \n\n                           Coef    S.E.   Wald Z Pr(>|Z|)\nIntercept                  -3.8676 0.7261 -5.33  <0.0001 \nmin_num                     0.0987 0.0090 10.99  <0.0001 \nmin_num'                   -0.1707 0.0206 -8.29  <0.0001 \nmin_num''                   0.4303 0.0807  5.33  <0.0001 \necig_nico=No               -0.2277 0.2773 -0.82  0.4116  \necig_flavored=No           -3.0412 0.7147 -4.26  <0.0001 \nharm_perc=same_or_more      0.4633 0.2540  1.82  0.0682  \nprice_paid=$10to$20        -2.1952 0.4318 -5.08  <0.0001 \nprice_paid=$21to$100       -2.8602 0.4241 -6.74  <0.0001 \nprice_paid=>$100           -3.3635 0.7092 -4.74  <0.0001 \necig_flavored=No * min_num  0.0028 0.0037  0.76  0.4457  \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Obtaining model coefficients and exponentiating them\ntidy(mod_Z, exponentiate = TRUE,\nconf.int = TRUE, conf.level = 0.90) |>\nkable(digits = 3) |> \n  kable_classic_2(font_size = 24, full_width = F) \n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> conf.low </th>\n   <th style=\"text-align:right;\"> conf.high </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 0.021 </td>\n   <td style=\"text-align:right;\"> 0.726 </td>\n   <td style=\"text-align:right;\"> -5.327 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.006 </td>\n   <td style=\"text-align:right;\"> 0.065 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ecig_nicoNo </td>\n   <td style=\"text-align:right;\"> 0.796 </td>\n   <td style=\"text-align:right;\"> 0.277 </td>\n   <td style=\"text-align:right;\"> -0.821 </td>\n   <td style=\"text-align:right;\"> 0.412 </td>\n   <td style=\"text-align:right;\"> 0.510 </td>\n   <td style=\"text-align:right;\"> 1.271 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rcs(min_num, 4)min_num </td>\n   <td style=\"text-align:right;\"> 1.104 </td>\n   <td style=\"text-align:right;\"> 0.009 </td>\n   <td style=\"text-align:right;\"> 10.992 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 1.088 </td>\n   <td style=\"text-align:right;\"> 1.121 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rcs(min_num, 4)min_num' </td>\n   <td style=\"text-align:right;\"> 0.843 </td>\n   <td style=\"text-align:right;\"> 0.021 </td>\n   <td style=\"text-align:right;\"> -8.289 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.814 </td>\n   <td style=\"text-align:right;\"> 0.871 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rcs(min_num, 4)min_num'' </td>\n   <td style=\"text-align:right;\"> 1.538 </td>\n   <td style=\"text-align:right;\"> 0.081 </td>\n   <td style=\"text-align:right;\"> 5.330 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 1.349 </td>\n   <td style=\"text-align:right;\"> 1.760 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ecig_flavoredNo </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n   <td style=\"text-align:right;\"> 0.715 </td>\n   <td style=\"text-align:right;\"> -4.255 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.014 </td>\n   <td style=\"text-align:right;\"> 0.151 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> harm_percsame_or_more </td>\n   <td style=\"text-align:right;\"> 1.589 </td>\n   <td style=\"text-align:right;\"> 0.254 </td>\n   <td style=\"text-align:right;\"> 1.823 </td>\n   <td style=\"text-align:right;\"> 0.068 </td>\n   <td style=\"text-align:right;\"> 1.052 </td>\n   <td style=\"text-align:right;\"> 2.429 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> price_paid$10to$20 </td>\n   <td style=\"text-align:right;\"> 0.111 </td>\n   <td style=\"text-align:right;\"> 0.432 </td>\n   <td style=\"text-align:right;\"> -5.084 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.054 </td>\n   <td style=\"text-align:right;\"> 0.224 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> price_paid$21to$100 </td>\n   <td style=\"text-align:right;\"> 0.057 </td>\n   <td style=\"text-align:right;\"> 0.424 </td>\n   <td style=\"text-align:right;\"> -6.744 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.028 </td>\n   <td style=\"text-align:right;\"> 0.113 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> price_paid&gt;$100 </td>\n   <td style=\"text-align:right;\"> 0.035 </td>\n   <td style=\"text-align:right;\"> 0.709 </td>\n   <td style=\"text-align:right;\"> -4.743 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.011 </td>\n   <td style=\"text-align:right;\"> 0.112 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ecig_flavored %ia% min_num </td>\n   <td style=\"text-align:right;\"> 1.003 </td>\n   <td style=\"text-align:right;\"> 0.004 </td>\n   <td style=\"text-align:right;\"> 0.763 </td>\n   <td style=\"text-align:right;\"> 0.446 </td>\n   <td style=\"text-align:right;\"> 0.997 </td>\n   <td style=\"text-align:right;\"> 1.009 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### Plot of Effect Sizes for Winning Model\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(mod_Z_lrm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             Effects              Response : ecig_reg \n\n Factor                             Low High Diff. Effect    S.E.    Lower 0.95\n min_num                            90  180  90     1.056400 0.24375  0.578620 \n  Odds Ratio                        90  180  90     2.875900      NA  1.783600 \n ecig_nico - No:Yes                  1    2  NA    -0.227660 0.27727 -0.771110 \n  Odds Ratio                         1    2  NA     0.796390      NA  0.462500 \n ecig_flavored - No:Yes              1    2  NA    -2.705000 0.41467 -3.517800 \n  Odds Ratio                         1    2  NA     0.066868      NA  0.029666 \n harm_perc - same_or_more:less_harm  1    2  NA     0.463250 0.25405 -0.034679 \n  Odds Ratio                         1    2  NA     1.589200      NA  0.965920 \n price_paid - Below$10:$21to$100     3    1  NA     2.860200 0.42410  2.029000 \n  Odds Ratio                         3    1  NA    17.465000      NA  7.606200 \n price_paid - $10to$20:$21to$100     3    2  NA     0.664980 0.25607  0.163100 \n  Odds Ratio                         3    2  NA     1.944400      NA  1.177100 \n price_paid - >$100:$21to$100        3    4  NA    -0.503340 0.60451 -1.688200 \n  Odds Ratio                         3    4  NA     0.604510      NA  0.184860 \n Upper 0.95\n  1.53410  \n  4.63710  \n  0.31579  \n  1.37130  \n -1.89230  \n  0.15072  \n  0.96118  \n  2.61480  \n  3.69140  \n 40.10100  \n  1.16690  \n  3.21190  \n  0.68147  \n  1.97680  \n\nAdjusted to: min_num=120 ecig_flavored=Yes  \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(summary(mod_Z_lrm))\n```\n\n::: {.cell-output-display}\n![](Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-102-1.png){width=672}\n:::\n:::\n\n\n### Numerical Description of Effect Sizes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(mod_Z_lrm, conf.int = 0.90) |> kable(digits = 3) |> \n  kable_classic_2(font_size = 24, full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> Low </th>\n   <th style=\"text-align:right;\"> High </th>\n   <th style=\"text-align:right;\"> Diff. </th>\n   <th style=\"text-align:right;\"> Effect </th>\n   <th style=\"text-align:right;\"> S.E. </th>\n   <th style=\"text-align:right;\"> Lower 0.9 </th>\n   <th style=\"text-align:right;\"> Upper 0.9 </th>\n   <th style=\"text-align:right;\"> Type </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> min_num </td>\n   <td style=\"text-align:right;\"> 90 </td>\n   <td style=\"text-align:right;\"> 180 </td>\n   <td style=\"text-align:right;\"> 90 </td>\n   <td style=\"text-align:right;\"> 1.056 </td>\n   <td style=\"text-align:right;\"> 0.244 </td>\n   <td style=\"text-align:right;\"> 0.655 </td>\n   <td style=\"text-align:right;\"> 1.457 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Odds Ratio </td>\n   <td style=\"text-align:right;\"> 90 </td>\n   <td style=\"text-align:right;\"> 180 </td>\n   <td style=\"text-align:right;\"> 90 </td>\n   <td style=\"text-align:right;\"> 2.876 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 1.926 </td>\n   <td style=\"text-align:right;\"> 4.294 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ecig_nico - No:Yes </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> -0.228 </td>\n   <td style=\"text-align:right;\"> 0.277 </td>\n   <td style=\"text-align:right;\"> -0.684 </td>\n   <td style=\"text-align:right;\"> 0.228 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Odds Ratio </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.796 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.505 </td>\n   <td style=\"text-align:right;\"> 1.257 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ecig_flavored - No:Yes </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> -2.705 </td>\n   <td style=\"text-align:right;\"> 0.415 </td>\n   <td style=\"text-align:right;\"> -3.387 </td>\n   <td style=\"text-align:right;\"> -2.023 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Odds Ratio </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.067 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.034 </td>\n   <td style=\"text-align:right;\"> 0.132 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> harm_perc - same_or_more:less_harm </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.463 </td>\n   <td style=\"text-align:right;\"> 0.254 </td>\n   <td style=\"text-align:right;\"> 0.045 </td>\n   <td style=\"text-align:right;\"> 0.881 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Odds Ratio </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 1.589 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 1.046 </td>\n   <td style=\"text-align:right;\"> 2.414 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> price_paid - Below$10:$21to$100 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2.860 </td>\n   <td style=\"text-align:right;\"> 0.424 </td>\n   <td style=\"text-align:right;\"> 2.163 </td>\n   <td style=\"text-align:right;\"> 3.558 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Odds Ratio </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 17.465 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 8.694 </td>\n   <td style=\"text-align:right;\"> 35.085 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> price_paid - $10to$20:$21to$100 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.665 </td>\n   <td style=\"text-align:right;\"> 0.256 </td>\n   <td style=\"text-align:right;\"> 0.244 </td>\n   <td style=\"text-align:right;\"> 1.086 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Odds Ratio </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 1.944 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 1.276 </td>\n   <td style=\"text-align:right;\"> 2.963 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> price_paid - &gt;$100:$21to$100 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> -0.503 </td>\n   <td style=\"text-align:right;\"> 0.605 </td>\n   <td style=\"text-align:right;\"> -1.498 </td>\n   <td style=\"text-align:right;\"> 0.491 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Odds Ratio </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.605 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.224 </td>\n   <td style=\"text-align:right;\"> 1.634 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n`price_paid` description:\n\nFor two individuals, subject 1 and 2, who have their first e-cigarette puff of the day the same number of minutes after waking up, who both use nicotine containing e-cigarettes, who have the same perception of the harmfulness of e-cigarettes in comparison to regular cigarettes, and use flavored e-cigarettes, and subject 1 pays less than 10 dollars for their e-cigarettes, and subject 2 pays between 21 to a 100 dollars for their e-cigarettes,  according to model Z, **the ratio of the odds of subject 1 being a regular e-cigarette smoker to the odds of subject 2 being a regular e-cigarette smoker is 17.465** The 90% confidence intervals around this estimate are (8.69 to 35.09). \n\nGiven that this interval does not include 1, this is a meaningful effect.  \n\n### Plot of ROC Curve for Winning Model\n\nThe `roc` function from the `pROC` package was used to obtain the ROC curve for model Z(the `lrm` model). The dataset with the outcome variable recoded as \"Yes\" = 1, \"No\" = 0 was used.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nroc.mod <- \n    roc(log_i_temp$ecig_reg ~ predict(mod_Z_lrm, type=\"fitted\"),\n        ci = TRUE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nSetting levels: control = 0, case = 1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nSetting direction: controls > cases\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(roc.mod, auc.polygon = TRUE, print.auc = TRUE,max.auc.polygon = TRUE,\n     grid=c(0.1, 0.2),\n     grid.col = c(\"green\", \"red\"),\n     auc.polygon.col = \"skyblue\",title = \"ROC Curve for Model Z (lrm) with the AUC score\")\n```\n\n::: {.cell-output-display}\n![](Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-105-1.png){width=672}\n:::\n:::\n\n\n### Validated $R^2$ and $C$ statistic for Winning Model\n\n| MODEL | VALIDATED $R^2$ | VALIDATED $C$ STATISTIC |\n|-------|-----------------|-----------------------|\n|   Z   |     0.6528      |         0.882         |\n\n### Nomogram of Winning Model\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(nomogram(mod_Z_lrm, fun = plogis))\n```\n\n::: {.cell-output-display}\n![](Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-106-1.png){width=576}\n:::\n:::\n\n\n### Predictions for Two New Subjects\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnew_subj <-\n  data.frame(min_num = c(60,60), ecig_flavored = c(\"Yes\",\"Yes\"),ecig_nico = c(\"Yes\",\"Yes\"),harm_perc = c(\"less_harm\",\"less_harm\"), price_paid = c(\"Below$10\",\"$21to$100\")) \npreds4 <- predict(mod_Z_lrm, newdata = new_subj, type = \"fitted\")\n\npreds4 \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        1         2 \n0.8584043 0.2576755 \n```\n:::\n:::\n\n\n| Subject Name | Subject Characteristics | Predicted Probability of being a regular E-cigarette smoker |\n|--------------|-------------------------------------------------------------------|---------------------------------------------|\n| Subject 1 | min_num = 60 minutes, ecig_flavored = Yes, ecig_nico = Yes, harm_perc = \"less_harm\", price_paid = \"Below$10\" | 0.858 |\n| Subject 2 | min_num = 60 minutes, ecig_flavored = Yes, ecig_nico = Yes, harm_perc = \"less_harm\", price_paid = \"$21to$100\" | 0.258 | \n\n# Discusssion\n\n## Answering My Research Questions\n\n### My First Research Question\n\n*E-Cigarette Perception, Smoking Habits, and their association with Heavy E-Cigarette Use:*\n\n**Are smoking e-cigarettes that contain nicotine, the perception of the purported healthiness of e-cigarettes when compared to smoking regular cigarettes, and smoking habits strong predictors of heavy e-cigarette use in adulthood?**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Transforming the coefficients of Model B back to the original variable's scale\ntidy_mod_B |> \n  mutate(estimate = sprintf(\"%.2f\",(exp(estimate) - 1)),\n         conf.low = sprintf(\"%.2f\",(exp(conf.low) - 1)),\n         conf.high = sprintf(\"%.2f\",(exp(conf.high) - 1))) |>\n  select(term,estimate,conf.low,conf.high, p.value) |>\n  kbl(digits = 3) |> \n  kable_classic_2(font_size = 24, full_width = F)  \n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:left;\"> estimate </th>\n   <th style=\"text-align:left;\"> conf.low </th>\n   <th style=\"text-align:left;\"> conf.high </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:left;\"> 31.34 </td>\n   <td style=\"text-align:left;\"> 21.74 </td>\n   <td style=\"text-align:left;\"> 44.99 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rcs(puff_num, 4)puff_num </td>\n   <td style=\"text-align:left;\"> -0.46 </td>\n   <td style=\"text-align:left;\"> -0.50 </td>\n   <td style=\"text-align:left;\"> -0.43 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rcs(puff_num, 4)puff_num' </td>\n   <td style=\"text-align:left;\"> 95957.21 </td>\n   <td style=\"text-align:left;\"> 42612.78 </td>\n   <td style=\"text-align:left;\"> 216078.82 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rcs(puff_num, 4)puff_num'' </td>\n   <td style=\"text-align:left;\"> -1.00 </td>\n   <td style=\"text-align:left;\"> -1.00 </td>\n   <td style=\"text-align:left;\"> -1.00 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range18to24 </td>\n   <td style=\"text-align:left;\"> -0.10 </td>\n   <td style=\"text-align:left;\"> -0.25 </td>\n   <td style=\"text-align:left;\"> 0.08 </td>\n   <td style=\"text-align:right;\"> 0.357 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range25to34 </td>\n   <td style=\"text-align:left;\"> 0.02 </td>\n   <td style=\"text-align:left;\"> -0.16 </td>\n   <td style=\"text-align:left;\"> 0.23 </td>\n   <td style=\"text-align:right;\"> 0.863 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range35to44 </td>\n   <td style=\"text-align:left;\"> -0.06 </td>\n   <td style=\"text-align:left;\"> -0.23 </td>\n   <td style=\"text-align:left;\"> 0.15 </td>\n   <td style=\"text-align:right;\"> 0.612 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range45to54 </td>\n   <td style=\"text-align:left;\"> 0.02 </td>\n   <td style=\"text-align:left;\"> -0.16 </td>\n   <td style=\"text-align:left;\"> 0.25 </td>\n   <td style=\"text-align:right;\"> 0.838 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age_range&gt;55 </td>\n   <td style=\"text-align:left;\"> 0.17 </td>\n   <td style=\"text-align:left;\"> -0.05 </td>\n   <td style=\"text-align:left;\"> 0.43 </td>\n   <td style=\"text-align:right;\"> 0.206 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> less_harmNo </td>\n   <td style=\"text-align:left;\"> 0.16 </td>\n   <td style=\"text-align:left;\"> -0.04 </td>\n   <td style=\"text-align:left;\"> 0.39 </td>\n   <td style=\"text-align:right;\"> 0.204 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ecig_nicoNo </td>\n   <td style=\"text-align:left;\"> -0.11 </td>\n   <td style=\"text-align:left;\"> -0.21 </td>\n   <td style=\"text-align:left;\"> -0.01 </td>\n   <td style=\"text-align:right;\"> 0.076 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> puff_num %ia% less_harm </td>\n   <td style=\"text-align:left;\"> -0.03 </td>\n   <td style=\"text-align:left;\"> -0.05 </td>\n   <td style=\"text-align:left;\"> -0.01 </td>\n   <td style=\"text-align:right;\"> 0.029 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n*E-CIGARETTE PUFFS PER DAY:*\n\n**Higher number of puffs taken per day are correlated with a higher number of days an e-cigarette was smoked in the past 30 days, provided all other variables are held constant.** This is evident from the confidence intervals of `puff_num`, which do not include zero.\n\n*USAGE OF E-CIGARETTES WITH NICOTINE:*\n\n**The usage of e-cigarettes that do not contain nicotine are associated with a significantly lower number of days an e-cigarette was smoked by a study participant in the past 30 days, provided all other variables are held constant.** \n\nThe point estimate for this effect is -0.11, with 90%CI(-0.21 to -0.01). Given that the confidence interval does not include zero, this is a meaningful effect. (p = 0.076) \n\n*E-CIGARETTE SMOKING INITIATION AGE:*\n\nInitiation of e-cigarette smoking at a younger age does not have a meaningful correlation with heavy e-cigarette smoking by an individual in the past 30 days, provided all other variables are held constant. This is evident from the confidence intervals for the different levels of `age_range`, all of which contain zero, when compared to the number of days an e-cigarette was smoked in the past 30 days by individuals who initiated e-cigarette smoking when they were less than 18 years of age.\n\n*PERCEPTION OF THE HARMFULNESS OF E-CIGARETTES COMPARED TO REGULAR CIGARETTES:*\n\nThe perception of the supposed healthiness of e-cigarettes when compared to regular cigarettes do not have a meaningful correlation with an individual's e-cigarette smoking in the past 30 days, provided all other variables are held constant. This is evident from the confidence intervals for the term `less_harmNo` from the table of model B's coefficients, which include zero. (p = 0.204)\n\n*In summation, to answer my first research question, *\n\n**Factors such as a higher number of puffs taken from an e-cigarette daily, and usage of nicotine-containing e-cigarettes are correlated with heavier smoking habits over the past 30 days.**\n\n**Factors such as an individual's perception of the supposed healthiness of e-cigarettes when compared to regular cigarettes, and their age when they began smoking e-cigarettes, do not have a meaningful impact on an individual's smoking habits over the past 30 days.**\n\n### My Second Research Question\n\n*Regular e-cigarette use and it's associated factors:*\n\n**Are factors such as using flavored e-cigarettes, or needing to use e-cigarettes immediately after waking up, or using e-cigarettes with nicotine, or use of e-cigarettes as a healthier alternative to regular cigarettes associated with regular e-cigarette use?**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(mod_Z_lrm, conf.int = 0.90) |> kable(digits = 3) |> \n  kable_classic_2(font_size = 24, full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style='font-size: 24px; font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> Low </th>\n   <th style=\"text-align:right;\"> High </th>\n   <th style=\"text-align:right;\"> Diff. </th>\n   <th style=\"text-align:right;\"> Effect </th>\n   <th style=\"text-align:right;\"> S.E. </th>\n   <th style=\"text-align:right;\"> Lower 0.9 </th>\n   <th style=\"text-align:right;\"> Upper 0.9 </th>\n   <th style=\"text-align:right;\"> Type </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> min_num </td>\n   <td style=\"text-align:right;\"> 90 </td>\n   <td style=\"text-align:right;\"> 180 </td>\n   <td style=\"text-align:right;\"> 90 </td>\n   <td style=\"text-align:right;\"> 1.056 </td>\n   <td style=\"text-align:right;\"> 0.244 </td>\n   <td style=\"text-align:right;\"> 0.655 </td>\n   <td style=\"text-align:right;\"> 1.457 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Odds Ratio </td>\n   <td style=\"text-align:right;\"> 90 </td>\n   <td style=\"text-align:right;\"> 180 </td>\n   <td style=\"text-align:right;\"> 90 </td>\n   <td style=\"text-align:right;\"> 2.876 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 1.926 </td>\n   <td style=\"text-align:right;\"> 4.294 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ecig_nico - No:Yes </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> -0.228 </td>\n   <td style=\"text-align:right;\"> 0.277 </td>\n   <td style=\"text-align:right;\"> -0.684 </td>\n   <td style=\"text-align:right;\"> 0.228 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Odds Ratio </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.796 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.505 </td>\n   <td style=\"text-align:right;\"> 1.257 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ecig_flavored - No:Yes </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> -2.705 </td>\n   <td style=\"text-align:right;\"> 0.415 </td>\n   <td style=\"text-align:right;\"> -3.387 </td>\n   <td style=\"text-align:right;\"> -2.023 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Odds Ratio </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.067 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.034 </td>\n   <td style=\"text-align:right;\"> 0.132 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> harm_perc - same_or_more:less_harm </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.463 </td>\n   <td style=\"text-align:right;\"> 0.254 </td>\n   <td style=\"text-align:right;\"> 0.045 </td>\n   <td style=\"text-align:right;\"> 0.881 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Odds Ratio </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 1.589 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 1.046 </td>\n   <td style=\"text-align:right;\"> 2.414 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> price_paid - Below$10:$21to$100 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 2.860 </td>\n   <td style=\"text-align:right;\"> 0.424 </td>\n   <td style=\"text-align:right;\"> 2.163 </td>\n   <td style=\"text-align:right;\"> 3.558 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Odds Ratio </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 17.465 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 8.694 </td>\n   <td style=\"text-align:right;\"> 35.085 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> price_paid - $10to$20:$21to$100 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.665 </td>\n   <td style=\"text-align:right;\"> 0.256 </td>\n   <td style=\"text-align:right;\"> 0.244 </td>\n   <td style=\"text-align:right;\"> 1.086 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Odds Ratio </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 1.944 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 1.276 </td>\n   <td style=\"text-align:right;\"> 2.963 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> price_paid - &gt;$100:$21to$100 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> -0.503 </td>\n   <td style=\"text-align:right;\"> 0.605 </td>\n   <td style=\"text-align:right;\"> -1.498 </td>\n   <td style=\"text-align:right;\"> 0.491 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Odds Ratio </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.605 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.224 </td>\n   <td style=\"text-align:right;\"> 1.634 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n*TIME TAKEN FOR THE FIRST E-CIGARETTE PUFF OF THE DAY*\n\n**Individuals who need to use e-cigarettes within an hour or an hour and a half of waking up have detectable higher odds of identifying as regular users of e-cigarettes, provided the other variables are held constant.** This is evident in the 90% confidence intervals for the odds ratio in the coefficient table, which does not include 1.  \n\n*USAGE OF FLAVORED E-CIGARETTES:*\n\n**Individuals who do not use flavored e-cigarettes have detectable lower odds of identifying as regular users of e-cigarettes, provided the other variables are held constant.** This is evident in the 90% confidence intervals for the odds ratio in the coefficient table, which does not include 1. The point estimate for this odds ratio is 0.07, with 90% confidence intervals (0.03 to 0.13). Individuals who do not use flavored e-cigarettes have only 0.07 times the odds(90%CI 0.03 to 0.13) of identifying as regular e-cigarette smokers, compared to individuals who do use flavored e-cigarettes. \n\n*COST OF E-CIGARETTE BRAND:*\n\n**Individuals who pay less than 10 dollars for their e-cigarettes have detectably higher odds of identifying as regular e-cigarettes, as compared to individuals who paid anywhere between 21 to 100 dollars for their e-cigarette, provided the other variables are held constant.** This is evident in the 90% confidence intervals for the odds ratio in the coefficient table, which do not include zero. Similarly, individuals who pay anywhere between 10 to 20 dollars for their e-cigarette also have detectably higher odds of identifying as regular e-cigarette smokers\n\nHowever, individuals who pay more than 100 dollars for their e-cigarettes do not have meaningfully different odds of identifying as regular e-cigarette smokers compared to individuals who pay anywhere between 21 to 100 dollars for their e-cigarettes, provided the other variables remain constant. This is evident in the 90% confidence intervals for the odds ratio of this effect in the coefficient table, which includes 1. \n\n*USAGE OF E-CIGARETTES CONTAINING NICOTINE:*\n\nIndividuals who do not use e-cigarettes with nicotine do not have meaningfully different odds of identifying as regular e-cigarette smokers compared to individuals who use e-cigarettes containing nicotine, provided the other variables are held constant. The 90% confidence intervals for the odds ratio of this effect includes 1.\n\n*PERCEPTION OF THE HARMFULNESS OF E-CIGARETTES AS COMPARED TO REGULAR CIGARETTES:*\n\nIndividuals who perceive e-cigarettes as being the same or more harmful than regular e-cigarettes do not have meaningfully different odds of identifying as regular e-cigarette smokers compared to individuals who perceive e-cigarettes as being less harmful than regular e-cigarettes, provided the other variables are held constant. The odds ratio for this effect includes 1. \n\n*In summation, to answer my second research question, *\n\n**Factors such as needing to use e-cigarettes immediately after waking up, using flavored e-cigarettes, and using cheaper e-cigarette brands are all associated with detectably higher odds of identifying as a regular e-cigarette user, provided the other variables are held constant.**\n\n**Factors such as the usage of nicotine containing e-cigarettes, and the perceptiom of the harmfulness of e-cigarettes as compared to regular cigarettes do not have a meaningful impact on the odds of identifying as a regular e-cigarette user, provided all other variables remain constant.** \n\n## Limitations and Next Steps\n\n### Model B and it's limitations\n\nGiven that model B was predicting a count outcome, and given then the outcome was transformed using a logarithm transformation after adding a non-zero integer to the outcome, the resulting model is very highly driven by the `puff_num` variable, resulting in exploding coefficients for the restricted cubic spline applied on `puff_num`. \n\nModel B outperformed Model A on all metrics that were studied. Visualization of the transformed outcome variable showed why that was the case, given the non-linear, skewed nature of the data under study. The data lent itself very well towards a non-linear term, even if the restricted cubic spline had exploding coefficients. \n\nThis outcome could be better modeled with a Poisson regression, and by using a larger dataset with lesser missing values. The next ideal step would be to expand the dataset to more than 1200, and model the outcome using a Poisson regression. \n\n### Model Z and it's limitations\n\nThe glm fit of the model produced a warning stating that predicted probabilities of 0 or 1 had occurred. Given that the data under analysis had a large amount of missingness, imputation possibly skewed the model towards one direction or the other. It is important to note that this warning was only produced in the glm model, while the lrm model did not produce such a warning.\n\nThis model could be improved by vastly expanding the sample size, minimizing the effect of the missing data and smoothing out the predicted probabilites so that the preceding skew does not repeat itself.\n\n## Thoughts on Project A\n\nProject A was more difficult than I expected it to be. I went in knowing it would take a decent amount of work and effort, and I was reasonably confident that I could tackle it, since I knew my experience in 431 had already helped prepare me for the work that would be required. The hardest part of Project A was dealing with the large number of missing values. The impact of imputation on both models was significant, and discussing the limitations and understanding how the models could be improved was a difficult task, although I did learn a lot from the difficulty I had with the data. \n\nAt the end of Project A, I wished that I had chosen a non count outcome for the linear regression.We hadn't covered count outcomes at the time of submission of the Plan, and if I'd known the difficulties inherent in using linear regression for a count outcome when I started, I would have picked a different outcome variable. \n\n# Affirmation\n\n> I am certain that it is completely appropriate for these data to be shared with anyone, without any conditions. There are no concerns about privacy or security.\n\n# References\n\n\\[1\\] Singh, T., Arrazola, R. A., Corey, C. G., Husten, C. G., Neff, L. J., Homa, D. M., & King, B. A. (2016). **Tobacco use among middle and high school students---United States**, 2011--2015. Morbidity and mortality weekly report, 65(14), 361-367.\n\n\\[2\\] Dutra, L. M., & Glantz, S. A. (2014). **High international electronic cigarette use among never smoker adolescents.** Journal of Adolescent Health, 55(5), 595-597.\n\n\\[3\\] Dutra, L. M., & Glantz, S. A. (2017). **E-cigarettes and national adolescent cigarette use**: 2004--2014. Pediatrics, 139(2).\n\n\\[4\\] Glantz, S. A., & Bareham, D. W. (2018). **E-cigarettes: use, effects on smoking, risks, and policy implications**. Annual review of public health, 39, 215-235.\n\n\\[5\\] United States Department of Health and Human Services. National Institutes of Health. National Institute on Drug Abuse, and United States Department of Health and Human Services. Food and Drug Administration. Center for Tobacco Products. Population Assessment of Tobacco and Health (PATH) Study \\[United States\\] Public-Use Files. Inter-university Consortium for Political and Social Research \\[distributor\\], 2022-10-07. https://doi.org/10.3886/ICPSR36498.v17\n\n# Session Information\n\n\n::: {.cell}\n\n```{.r .cell-code}\nxfun::session_info()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.3.2 (2023-10-31 ucrt)\nPlatform: x86_64-w64-mingw32/x64 (64-bit)\nRunning under: Windows 11 x64 (build 22621)\n\nLocale:\n  LC_COLLATE=English_United States.utf8 \n  LC_CTYPE=English_United States.utf8   \n  LC_MONETARY=English_United States.utf8\n  LC_NUMERIC=C                          \n  LC_TIME=English_United States.utf8    \n\nPackage version:\n  abind_1.4-5          askpass_1.2.0        backports_1.4.1     \n  base64enc_0.1-3      bit_4.0.5            bit64_4.0.5         \n  blob_1.2.4           boot_1.3-28.1        brio_1.1.3          \n  broom_1.0.5          bslib_0.5.1          cachem_1.0.8        \n  callr_3.7.3          car_3.1-2            carData_3.0-5       \n  caret_6.0-94         cellranger_1.1.0     checkmate_2.3.0     \n  class_7.3-22         cli_3.6.1            clipr_0.8.0         \n  clock_0.7.0          cluster_2.1.4        codetools_0.2-19    \n  colorspace_2.1-0     compiler_4.3.2       conflicted_1.2.0    \n  cpp11_0.4.6          crayon_1.5.2         curl_5.1.0          \n  data.table_1.14.8    DBI_1.1.3            dbplyr_2.4.0        \n  DEoptimR_1.1.3       desc_1.4.2           diagram_1.6.5       \n  diffobj_0.3.5        digest_0.6.33        doRNG_1.8.6         \n  dplyr_1.1.4          dtplyr_1.3.1         e1071_1.7-13        \n  ellipsis_0.3.2       evaluate_0.23        fansi_1.0.5         \n  farver_2.1.1         fastmap_1.1.1        fontawesome_0.5.2   \n  forcats_1.0.0        foreach_1.5.2        foreign_0.8-85      \n  Formula_1.2-5        fs_1.6.3             furrr_0.3.1         \n  future_1.33.0        future.apply_1.11.0  gargle_1.5.2        \n  generics_0.1.3       GGally_2.1.2         ggplot2_3.4.4       \n  glmnet_4.1-8         globals_0.16.2       glue_1.6.2          \n  googledrive_2.1.1    googlesheets4_1.1.1  gower_1.0.1         \n  graphics_4.3.2       grDevices_4.3.2      grid_4.3.2          \n  gridExtra_2.3        gtable_0.3.4         hardhat_1.3.0       \n  haven_2.5.3          highr_0.10           Hmisc_5.1-1         \n  hms_1.1.3            htmlTable_2.4.2      htmltools_0.5.7     \n  htmlwidgets_1.6.2    httr_1.4.7           ids_1.0.1           \n  ipred_0.9-14         isoband_0.2.7        iterators_1.0.14    \n  itertools_0.1.3      janitor_2.2.0        jomo_2.7-6          \n  jquerylib_0.1.4      jsonlite_1.8.7       kableExtra_1.3.4    \n  KernSmooth_2.23.22   knitr_1.45           labeling_0.4.3      \n  laeken_0.5.2         lattice_0.22-5       lava_1.7.3          \n  lifecycle_1.0.4      listenv_0.9.0        lme4_1.1-35.1       \n  lmtest_0.9.40        lubridate_1.9.3      magrittr_2.0.3      \n  MASS_7.3-60          Matrix_1.6-1.1       MatrixModels_0.5-3  \n  memoise_2.0.1        methods_4.3.2        mgcv_1.9.0          \n  mice_3.16.0          mime_0.12            minqa_1.2.6         \n  missForest_1.5       mitml_0.4-5          ModelMetrics_1.2.2.2\n  modelr_0.1.11        multcomp_1.4-25      munsell_0.5.0       \n  mvtnorm_1.2-3        naniar_1.0.0         nlme_3.1-163        \n  nloptr_2.0.3         nnet_7.3-19          norm_1.0.11.1       \n  numDeriv_2016.8.1.1  openssl_2.1.1        ordinal_2022.11.16  \n  pan_1.9              parallel_4.3.2       parallelly_1.36.0   \n  patchwork_1.1.3      pbkrtest_0.5.2       pillar_1.9.0        \n  pkgbuild_1.4.2       pkgconfig_2.0.3      pkgload_1.3.3       \n  plyr_1.8.9           polspline_1.1.24     praise_1.0.0        \n  prettyunits_1.2.0    pROC_1.18.5          processx_3.8.2      \n  prodlim_2023.08.28   progress_1.2.2       progressr_0.14.0    \n  proxy_0.4-27         ps_1.7.5             purrr_1.0.2         \n  quantreg_5.97        R6_2.5.1             ragg_1.2.6          \n  randomForest_4.7.1.1 ranger_0.16.0        rappdirs_0.3.3      \n  RColorBrewer_1.1-3   Rcpp_1.0.11          RcppEigen_0.3.3.9.4 \n  readr_2.1.4          readxl_1.4.3         recipes_1.0.8       \n  rematch_2.0.0        rematch2_2.1.2       reprex_2.0.2        \n  reshape_0.8.9        reshape2_1.4.4       rlang_1.1.2         \n  rmarkdown_2.25       rms_6.7-1            rngtools_1.5.2      \n  robustbase_0.99.0    rpart_4.1.21         rprojroot_2.0.4     \n  rsample_1.2.0        rstudioapi_0.15.0    rvest_1.0.3         \n  sandwich_3.0-2       sass_0.4.7           scales_1.2.1        \n  selectr_0.4.2        shape_1.4.6          simputation_0.2.8   \n  slider_0.3.1         snakecase_0.11.1     sp_2.1.1            \n  SparseM_1.81         splines_4.3.2        SQUAREM_2021.1      \n  stats_4.3.2          stats4_4.3.2         stringi_1.8.1       \n  stringr_1.5.1        survival_3.5-7       svglite_2.1.2       \n  sys_3.4.2            systemfonts_1.0.5    testthat_3.2.0      \n  textshaping_0.3.7    TH.data_1.1-2        tibble_3.2.1        \n  tidyr_1.3.0          tidyselect_1.2.0     tidyverse_2.0.0     \n  timechange_0.2.0     timeDate_4022.108    tinytex_0.48        \n  tools_4.3.2          tzdb_0.4.0           ucminf_1.2.0        \n  UpSetR_1.4.0         utf8_1.2.4           utils_4.3.2         \n  uuid_1.1.1           vcd_1.4.11           vctrs_0.6.4         \n  VIM_6.2.2            viridis_0.6.4        viridisLite_0.4.2   \n  visdat_0.6.0         vroom_1.6.4          waldo_0.5.2         \n  warp_0.2.1           webshot_0.5.5        withr_2.5.2         \n  xfun_0.41            xml2_1.3.5           yaml_2.3.7          \n  yardstick_1.2.0      zoo_1.8-12          \n```\n:::\n:::\n",
    "supporting": [
      "Project_A_Portfolio_Naveen_Kannan_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}