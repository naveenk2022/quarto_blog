<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Naveen Kannan">
<meta name="dcterms.date" content="2023-03-19">

<title>Predictors of Heavy E-Cigarette Use among Adults in the United States</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Predictors of Heavy E-Cigarette Use among Adults in the United States">
<meta property="og:description" content="An analysis of the Population Assessment of Tobacco and Health (PATH) Study.">
<meta property="og:image" content="https://naveenkannan.netlify.app/portfolio_projects/PATH_study/Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-28-1.png">
<meta property="og:image:height" content="1536">
<meta property="og:image:width" content="1920">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Naveen Kannan</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../publications.html" rel="" target="">
 <span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../portfolio.html" rel="" target="">
 <span class="menu-text">Portfolio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog_main.html" rel="" target="">
 <span class="menu-text">Blog Posts</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/naveenk2022" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://linkedin.com/in/naveen-kannan-177120118" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/naveenk2022/CV/blob/master/CV.pdf" rel="" target=""><i class="bi bi-file-person" role="img">
</i> 
 <span class="menu-text">CV</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#r-packages-and-setup" id="toc-r-packages-and-setup" class="nav-link active" data-scroll-target="#r-packages-and-setup">R Packages and Setup</a></li>
  <li><a href="#data-source" id="toc-data-source" class="nav-link" data-scroll-target="#data-source"><span class="header-section-number">1</span> Data Source</a></li>
  <li><a href="#the-subjects" id="toc-the-subjects" class="nav-link" data-scroll-target="#the-subjects"><span class="header-section-number">2</span> The Subjects</a></li>
  <li><a href="#loading-and-tidying-the-data" id="toc-loading-and-tidying-the-data" class="nav-link" data-scroll-target="#loading-and-tidying-the-data"><span class="header-section-number">3</span> Loading and Tidying the Data</a>
  <ul class="collapse">
  <li><a href="#loading-the-raw-data" id="toc-loading-the-raw-data" class="nav-link" data-scroll-target="#loading-the-raw-data"><span class="header-section-number">3.1</span> Loading the Raw Data</a></li>
  <li><a href="#cleaning-the-data" id="toc-cleaning-the-data" class="nav-link" data-scroll-target="#cleaning-the-data"><span class="header-section-number">3.2</span> Cleaning the Data</a>
  <ul class="collapse">
  <li><a href="#selecting-variables-well-use" id="toc-selecting-variables-well-use" class="nav-link" data-scroll-target="#selecting-variables-well-use"><span class="header-section-number">3.2.1</span> Selecting Variables We’ll Use</a></li>
  <li><a href="#dealing-with-missingness" id="toc-dealing-with-missingness" class="nav-link" data-scroll-target="#dealing-with-missingness"><span class="header-section-number">3.2.2</span> Dealing with Missingness</a></li>
  <li><a href="#changing-variable-names" id="toc-changing-variable-names" class="nav-link" data-scroll-target="#changing-variable-names"><span class="header-section-number">3.2.3</span> Changing Variable Names</a></li>
  <li><a href="#sampling-the-data" id="toc-sampling-the-data" class="nav-link" data-scroll-target="#sampling-the-data"><span class="header-section-number">3.2.4</span> Sampling the Data</a></li>
  <li><a href="#working-with-categorical-predictors" id="toc-working-with-categorical-predictors" class="nav-link" data-scroll-target="#working-with-categorical-predictors"><span class="header-section-number">3.2.5</span> Working with Categorical Predictors</a></li>
  <li><a href="#working-with-quantitative-variables" id="toc-working-with-quantitative-variables" class="nav-link" data-scroll-target="#working-with-quantitative-variables"><span class="header-section-number">3.2.6</span> Working with Quantitative Variables</a></li>
  <li><a href="#renaming-the-factors" id="toc-renaming-the-factors" class="nav-link" data-scroll-target="#renaming-the-factors"><span class="header-section-number">3.2.7</span> Renaming the factors</a></li>
  <li><a href="#splitting-the-data" id="toc-splitting-the-data" class="nav-link" data-scroll-target="#splitting-the-data"><span class="header-section-number">3.2.8</span> Splitting the Data</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#the-tidy-tibble" id="toc-the-tidy-tibble" class="nav-link" data-scroll-target="#the-tidy-tibble"><span class="header-section-number">4</span> The Tidy Tibble</a>
  <ul class="collapse">
  <li><a href="#listing-the-tibble" id="toc-listing-the-tibble" class="nav-link" data-scroll-target="#listing-the-tibble"><span class="header-section-number">4.1</span> Listing the Tibble</a></li>
  <li><a href="#size-and-identifiers" id="toc-size-and-identifiers" class="nav-link" data-scroll-target="#size-and-identifiers"><span class="header-section-number">4.2</span> Size and Identifiers</a></li>
  <li><a href="#save-the-tibble" id="toc-save-the-tibble" class="nav-link" data-scroll-target="#save-the-tibble"><span class="header-section-number">4.3</span> Save The Tibble</a></li>
  </ul></li>
  <li><a href="#the-code-book" id="toc-the-code-book" class="nav-link" data-scroll-target="#the-code-book"><span class="header-section-number">5</span> The Code Book</a>
  <ul class="collapse">
  <li><a href="#defining-the-variables" id="toc-defining-the-variables" class="nav-link" data-scroll-target="#defining-the-variables"><span class="header-section-number">5.1</span> Defining the Variables</a></li>
  <li><a href="#numerical-description" id="toc-numerical-description" class="nav-link" data-scroll-target="#numerical-description"><span class="header-section-number">5.2</span> Numerical Description</a></li>
  </ul></li>
  <li><a href="#linear-regression-plans" id="toc-linear-regression-plans" class="nav-link" data-scroll-target="#linear-regression-plans"><span class="header-section-number">6</span> Linear Regression Plans</a>
  <ul class="collapse">
  <li><a href="#my-first-research-question" id="toc-my-first-research-question" class="nav-link" data-scroll-target="#my-first-research-question"><span class="header-section-number">6.1</span> My First Research Question</a></li>
  <li><a href="#my-quantitative-outcome" id="toc-my-quantitative-outcome" class="nav-link" data-scroll-target="#my-quantitative-outcome"><span class="header-section-number">6.2</span> My Quantitative Outcome</a></li>
  <li><a href="#my-planned-predictors-linear-model" id="toc-my-planned-predictors-linear-model" class="nav-link" data-scroll-target="#my-planned-predictors-linear-model"><span class="header-section-number">6.3</span> My Planned Predictors (Linear Model)</a></li>
  </ul></li>
  <li><a href="#logistic-regression-plans" id="toc-logistic-regression-plans" class="nav-link" data-scroll-target="#logistic-regression-plans"><span class="header-section-number">7</span> Logistic Regression Plans</a>
  <ul class="collapse">
  <li><a href="#my-second-research-question" id="toc-my-second-research-question" class="nav-link" data-scroll-target="#my-second-research-question"><span class="header-section-number">7.1</span> My Second Research Question</a></li>
  <li><a href="#my-binary-outcome" id="toc-my-binary-outcome" class="nav-link" data-scroll-target="#my-binary-outcome"><span class="header-section-number">7.2</span> My Binary Outcome</a></li>
  <li><a href="#my-planned-predictors-logistic-model" id="toc-my-planned-predictors-logistic-model" class="nav-link" data-scroll-target="#my-planned-predictors-logistic-model"><span class="header-section-number">7.3</span> My Planned Predictors (Logistic Model)</a></li>
  </ul></li>
  <li><a href="#linear-regression-analyses" id="toc-linear-regression-analyses" class="nav-link" data-scroll-target="#linear-regression-analyses"><span class="header-section-number">8</span> Linear Regression Analyses</a>
  <ul class="collapse">
  <li><a href="#missingness" id="toc-missingness" class="nav-link" data-scroll-target="#missingness"><span class="header-section-number">8.1</span> Missingness</a></li>
  <li><a href="#outcome-transformation" id="toc-outcome-transformation" class="nav-link" data-scroll-target="#outcome-transformation"><span class="header-section-number">8.2</span> Outcome Transformation</a></li>
  <li><a href="#scatterplot-matrix-and-collinearity" id="toc-scatterplot-matrix-and-collinearity" class="nav-link" data-scroll-target="#scatterplot-matrix-and-collinearity"><span class="header-section-number">8.3</span> Scatterplot Matrix and Collinearity</a></li>
  <li><a href="#model-a" id="toc-model-a" class="nav-link" data-scroll-target="#model-a"><span class="header-section-number">8.4</span> Model A</a>
  <ul class="collapse">
  <li><a href="#fitting-model-a" id="toc-fitting-model-a" class="nav-link" data-scroll-target="#fitting-model-a"><span class="header-section-number">8.4.1</span> Fitting Model A</a></li>
  <li><a href="#tidied-coefficient-estimates-model-a" id="toc-tidied-coefficient-estimates-model-a" class="nav-link" data-scroll-target="#tidied-coefficient-estimates-model-a"><span class="header-section-number">8.4.2</span> Tidied Coefficient Estimates (Model A)</a></li>
  <li><a href="#summarizing-fit-model-a" id="toc-summarizing-fit-model-a" class="nav-link" data-scroll-target="#summarizing-fit-model-a"><span class="header-section-number">8.4.3</span> Summarizing Fit (Model A)</a></li>
  <li><a href="#regression-diagnostics-model-a" id="toc-regression-diagnostics-model-a" class="nav-link" data-scroll-target="#regression-diagnostics-model-a"><span class="header-section-number">8.4.4</span> Regression Diagnostics (Model A)</a></li>
  </ul></li>
  <li><a href="#non-linearity" id="toc-non-linearity" class="nav-link" data-scroll-target="#non-linearity"><span class="header-section-number">8.5</span> Non-Linearity</a></li>
  <li><a href="#model-b" id="toc-model-b" class="nav-link" data-scroll-target="#model-b"><span class="header-section-number">8.6</span> Model B</a>
  <ul class="collapse">
  <li><a href="#fitting-model-b" id="toc-fitting-model-b" class="nav-link" data-scroll-target="#fitting-model-b"><span class="header-section-number">8.6.1</span> Fitting Model B</a></li>
  <li><a href="#tidied-coefficient-estimates-model-b" id="toc-tidied-coefficient-estimates-model-b" class="nav-link" data-scroll-target="#tidied-coefficient-estimates-model-b"><span class="header-section-number">8.6.2</span> Tidied Coefficient Estimates (Model B)</a></li>
  <li><a href="#effects-plot-for-model-b" id="toc-effects-plot-for-model-b" class="nav-link" data-scroll-target="#effects-plot-for-model-b"><span class="header-section-number">8.6.3</span> Effects Plot for Model B</a></li>
  <li><a href="#summarizing-fit-model-b" id="toc-summarizing-fit-model-b" class="nav-link" data-scroll-target="#summarizing-fit-model-b"><span class="header-section-number">8.6.4</span> Summarizing Fit (Model B)</a></li>
  <li><a href="#regression-diagnostics-model-b" id="toc-regression-diagnostics-model-b" class="nav-link" data-scroll-target="#regression-diagnostics-model-b"><span class="header-section-number">8.6.5</span> Regression Diagnostics (Model B)</a></li>
  </ul></li>
  <li><a href="#validating-models-a-and-b" id="toc-validating-models-a-and-b" class="nav-link" data-scroll-target="#validating-models-a-and-b"><span class="header-section-number">8.7</span> Validating Models A and B</a>
  <ul class="collapse">
  <li><a href="#holdout-rmse-r2-and-mae" id="toc-holdout-rmse-r2-and-mae" class="nav-link" data-scroll-target="#holdout-rmse-r2-and-mae"><span class="header-section-number">8.7.1</span> Holdout RMSE, <span class="math inline">\(R^2\)</span> and MAE</a></li>
  <li><a href="#validated-r2-mse-and-ic-statistics" id="toc-validated-r2-mse-and-ic-statistics" class="nav-link" data-scroll-target="#validated-r2-mse-and-ic-statistics"><span class="header-section-number">8.7.2</span> Validated <span class="math inline">\(R^2\)</span>, MSE and IC statistics</a></li>
  <li><a href="#anova-to-compare-models-a-and-b" id="toc-anova-to-compare-models-a-and-b" class="nav-link" data-scroll-target="#anova-to-compare-models-a-and-b"><span class="header-section-number">8.7.3</span> ANOVA to compare Models A and B</a></li>
  </ul></li>
  <li><a href="#final-linear-regression-model" id="toc-final-linear-regression-model" class="nav-link" data-scroll-target="#final-linear-regression-model"><span class="header-section-number">8.8</span> Final Linear Regression Model</a>
  <ul class="collapse">
  <li><a href="#winning-models-parameter-estimates" id="toc-winning-models-parameter-estimates" class="nav-link" data-scroll-target="#winning-models-parameter-estimates"><span class="header-section-number">8.8.1</span> Winning Model’s Parameter Estimates</a></li>
  <li><a href="#model-coefficients" id="toc-model-coefficients" class="nav-link" data-scroll-target="#model-coefficients"><span class="header-section-number">8.8.2</span> Model Coefficients</a></li>
  <li><a href="#effects-plot-for-winning-model" id="toc-effects-plot-for-winning-model" class="nav-link" data-scroll-target="#effects-plot-for-winning-model"><span class="header-section-number">8.8.3</span> Effects Plot for Winning Model</a></li>
  <li><a href="#model-calibration" id="toc-model-calibration" class="nav-link" data-scroll-target="#model-calibration"><span class="header-section-number">8.8.4</span> Model Calibration</a></li>
  <li><a href="#numerical-description-of-effect-sizes" id="toc-numerical-description-of-effect-sizes" class="nav-link" data-scroll-target="#numerical-description-of-effect-sizes"><span class="header-section-number">8.8.5</span> Numerical Description of Effect Sizes</a></li>
  <li><a href="#nomogram-of-winning-model" id="toc-nomogram-of-winning-model" class="nav-link" data-scroll-target="#nomogram-of-winning-model"><span class="header-section-number">8.8.6</span> Nomogram of Winning Model</a></li>
  <li><a href="#prediction-for-a-new-subject" id="toc-prediction-for-a-new-subject" class="nav-link" data-scroll-target="#prediction-for-a-new-subject"><span class="header-section-number">8.8.7</span> Prediction for a New Subject</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#logistic-regression-analyses" id="toc-logistic-regression-analyses" class="nav-link" data-scroll-target="#logistic-regression-analyses"><span class="header-section-number">9</span> Logistic Regression Analyses</a>
  <ul class="collapse">
  <li><a href="#missingness-1" id="toc-missingness-1" class="nav-link" data-scroll-target="#missingness-1"><span class="header-section-number">9.1</span> Missingness</a></li>
  <li><a href="#model-y" id="toc-model-y" class="nav-link" data-scroll-target="#model-y"><span class="header-section-number">9.2</span> Model Y</a>
  <ul class="collapse">
  <li><a href="#fitting-model-y" id="toc-fitting-model-y" class="nav-link" data-scroll-target="#fitting-model-y"><span class="header-section-number">9.2.1</span> Fitting Model Y</a></li>
  <li><a href="#tidied-odds-ratio-estimates-model-y" id="toc-tidied-odds-ratio-estimates-model-y" class="nav-link" data-scroll-target="#tidied-odds-ratio-estimates-model-y"><span class="header-section-number">9.2.2</span> Tidied Odds Ratio Estimates (Model Y)</a></li>
  <li><a href="#effects-plot-model-y" id="toc-effects-plot-model-y" class="nav-link" data-scroll-target="#effects-plot-model-y"><span class="header-section-number">9.2.3</span> Effects Plot (Model Y)</a></li>
  <li><a href="#summarizing-fit-model-y" id="toc-summarizing-fit-model-y" class="nav-link" data-scroll-target="#summarizing-fit-model-y"><span class="header-section-number">9.2.4</span> Summarizing Fit (Model Y)</a></li>
  <li><a href="#confusion-matrix-model-y" id="toc-confusion-matrix-model-y" class="nav-link" data-scroll-target="#confusion-matrix-model-y"><span class="header-section-number">9.2.5</span> Confusion Matrix (Model Y)</a></li>
  </ul></li>
  <li><a href="#non-linearity-1" id="toc-non-linearity-1" class="nav-link" data-scroll-target="#non-linearity-1"><span class="header-section-number">9.3</span> Non-Linearity</a></li>
  <li><a href="#model-z" id="toc-model-z" class="nav-link" data-scroll-target="#model-z"><span class="header-section-number">9.4</span> Model Z</a>
  <ul class="collapse">
  <li><a href="#fitting-model-z" id="toc-fitting-model-z" class="nav-link" data-scroll-target="#fitting-model-z"><span class="header-section-number">9.4.1</span> Fitting Model Z</a></li>
  <li><a href="#tidied-odds-ratio-estimates-model-z" id="toc-tidied-odds-ratio-estimates-model-z" class="nav-link" data-scroll-target="#tidied-odds-ratio-estimates-model-z"><span class="header-section-number">9.4.2</span> Tidied Odds Ratio Estimates (Model Z)</a></li>
  <li><a href="#effects-plot-model-z" id="toc-effects-plot-model-z" class="nav-link" data-scroll-target="#effects-plot-model-z"><span class="header-section-number">9.4.3</span> Effects Plot (Model Z)</a></li>
  <li><a href="#summarizing-fit-model-z" id="toc-summarizing-fit-model-z" class="nav-link" data-scroll-target="#summarizing-fit-model-z"><span class="header-section-number">9.4.4</span> Summarizing Fit (Model Z)</a></li>
  <li><a href="#confusion-matrix-model-z" id="toc-confusion-matrix-model-z" class="nav-link" data-scroll-target="#confusion-matrix-model-z"><span class="header-section-number">9.4.5</span> Confusion Matrix (Model Z)</a></li>
  </ul></li>
  <li><a href="#validating-models-y-and-z" id="toc-validating-models-y-and-z" class="nav-link" data-scroll-target="#validating-models-y-and-z"><span class="header-section-number">9.5</span> Validating Models Y and Z</a>
  <ul class="collapse">
  <li><a href="#validated-r2-and-c-statistics-for-each-model" id="toc-validated-r2-and-c-statistics-for-each-model" class="nav-link" data-scroll-target="#validated-r2-and-c-statistics-for-each-model"><span class="header-section-number">9.5.1</span> Validated <span class="math inline">\(R^2\)</span> and <span class="math inline">\(C\)</span> statistics for each model</a></li>
  </ul></li>
  <li><a href="#final-logistic-regression-model" id="toc-final-logistic-regression-model" class="nav-link" data-scroll-target="#final-logistic-regression-model"><span class="header-section-number">9.6</span> Final Logistic Regression Model</a>
  <ul class="collapse">
  <li><a href="#winning-models-parameter-estimates-1" id="toc-winning-models-parameter-estimates-1" class="nav-link" data-scroll-target="#winning-models-parameter-estimates-1"><span class="header-section-number">9.6.1</span> Winning Model’s Parameter Estimates</a></li>
  <li><a href="#plot-of-effect-sizes-for-winning-model" id="toc-plot-of-effect-sizes-for-winning-model" class="nav-link" data-scroll-target="#plot-of-effect-sizes-for-winning-model"><span class="header-section-number">9.6.2</span> Plot of Effect Sizes for Winning Model</a></li>
  <li><a href="#numerical-description-of-effect-sizes-1" id="toc-numerical-description-of-effect-sizes-1" class="nav-link" data-scroll-target="#numerical-description-of-effect-sizes-1"><span class="header-section-number">9.6.3</span> Numerical Description of Effect Sizes</a></li>
  <li><a href="#plot-of-roc-curve-for-winning-model" id="toc-plot-of-roc-curve-for-winning-model" class="nav-link" data-scroll-target="#plot-of-roc-curve-for-winning-model"><span class="header-section-number">9.6.4</span> Plot of ROC Curve for Winning Model</a></li>
  <li><a href="#validated-r2-and-c-statistic-for-winning-model" id="toc-validated-r2-and-c-statistic-for-winning-model" class="nav-link" data-scroll-target="#validated-r2-and-c-statistic-for-winning-model"><span class="header-section-number">9.6.5</span> Validated <span class="math inline">\(R^2\)</span> and <span class="math inline">\(C\)</span> statistic for Winning Model</a></li>
  <li><a href="#nomogram-of-winning-model-1" id="toc-nomogram-of-winning-model-1" class="nav-link" data-scroll-target="#nomogram-of-winning-model-1"><span class="header-section-number">9.6.6</span> Nomogram of Winning Model</a></li>
  <li><a href="#predictions-for-two-new-subjects" id="toc-predictions-for-two-new-subjects" class="nav-link" data-scroll-target="#predictions-for-two-new-subjects"><span class="header-section-number">9.6.7</span> Predictions for Two New Subjects</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#discusssion" id="toc-discusssion" class="nav-link" data-scroll-target="#discusssion"><span class="header-section-number">10</span> Discusssion</a>
  <ul class="collapse">
  <li><a href="#answering-my-research-questions" id="toc-answering-my-research-questions" class="nav-link" data-scroll-target="#answering-my-research-questions"><span class="header-section-number">10.1</span> Answering My Research Questions</a>
  <ul class="collapse">
  <li><a href="#my-first-research-question-1" id="toc-my-first-research-question-1" class="nav-link" data-scroll-target="#my-first-research-question-1"><span class="header-section-number">10.1.1</span> My First Research Question</a></li>
  <li><a href="#my-second-research-question-1" id="toc-my-second-research-question-1" class="nav-link" data-scroll-target="#my-second-research-question-1"><span class="header-section-number">10.1.2</span> My Second Research Question</a></li>
  </ul></li>
  <li><a href="#limitations-and-next-steps" id="toc-limitations-and-next-steps" class="nav-link" data-scroll-target="#limitations-and-next-steps"><span class="header-section-number">10.2</span> Limitations and Next Steps</a>
  <ul class="collapse">
  <li><a href="#model-b-and-its-limitations" id="toc-model-b-and-its-limitations" class="nav-link" data-scroll-target="#model-b-and-its-limitations"><span class="header-section-number">10.2.1</span> Model B and it’s limitations</a></li>
  <li><a href="#model-z-and-its-limitations" id="toc-model-z-and-its-limitations" class="nav-link" data-scroll-target="#model-z-and-its-limitations"><span class="header-section-number">10.2.2</span> Model Z and it’s limitations</a></li>
  </ul></li>
  <li><a href="#thoughts-on-project-a" id="toc-thoughts-on-project-a" class="nav-link" data-scroll-target="#thoughts-on-project-a"><span class="header-section-number">10.3</span> Thoughts on Project A</a></li>
  </ul></li>
  <li><a href="#affirmation" id="toc-affirmation" class="nav-link" data-scroll-target="#affirmation"><span class="header-section-number">11</span> Affirmation</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">12</span> References</a></li>
  <li><a href="#session-information" id="toc-session-information" class="nav-link" data-scroll-target="#session-information"><span class="header-section-number">13</span> Session Information</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Predictors of Heavy E-Cigarette Use among Adults in the United States</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">An analysis of the Population Assessment of Tobacco and Health (PATH) Study.</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Naveen Kannan </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2023-03-19</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="r-packages-and-setup" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="r-packages-and-setup">R Packages and Setup</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">comment =</span> <span class="cn">NA</span>) </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor) </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rsample)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yardstick)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rms)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(simputation)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-source" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Data Source</h1>
<p>The data under study comes from the Population Assessment of Tobacco and Health (PATH) Study. It was obtained from ICPSR, the Inter-university Consortium for Political and Social Research.</p>
<p>The Population Assessment of Tobacco and Health <strong>(PATH)</strong> Study began originally surveying 45,971 adult and youth respondents. The study sampled over 150,000 mailing addresses across the United States to create a national sample of tobacco users and non-users, and is a collaboration between the National Institute on Drug Abuse (NIDA), National Institutes of Health (NIH), and the Center for Tobacco Products (CTP), Food and Drug Administration (FDA).</p>
<p>The data can be found at (https://www.icpsr.umich.edu/web/ICPSR/studies/36498/datadocumentation).</p>
<p>For adults, data was collected via interviews. Each case constitutes a single completed interview. Each case in a Youth data file represents one youth and his or her parent’s responses about that youth. Parents who provided permission for their child to participate in a Youth Interview were asked to complete a brief interview about their child. Youth who turn 18 by the current wave of data collection are considered “aged-up adults” and are invited to complete the Adult Interview.</p>
</section>
<section id="the-subjects" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> The Subjects</h1>
<p>The dataset from which data is being taken is <strong>Dataset 1001 (DS1001)</strong>, which contains the data from the Wave 1 adult questionnaire. 45,971 adults and youth constitute the first (baseline) wave of data collected by this longitudinal cohort study.</p>
<p>The DS1001 data can be considered a random sample that constitutes a longitudinal cross section of adults(of age 18 and above) across the United States, since the PATH study sampled over 150,000 mailing addresses across the United States to create a national sample of tobacco users and non-users. The DS1001 data contains data on adults (individuals of age 18 and above) alone.</p>
<p>From the DS1001 dataset, individuals who used e-cigarettes at the time of the Wave 1 questionnaire were selected, excluding individuals who did not use e-cigarettes at that time. Dual users of e-cigarettes and other forms of tobacco were not excluded. The DS1001 dataset only contains data on adults, and thus youth below the age of 18 are excluded from the final dataset.</p>
<p>Individuals who had complete data on both outcomes under study were then selected. The resulting dataset had 3000 individuals. A random sample of 1200 individuals was taken from this subset, ensuring that the same respondents were taken for both analyses.</p>
<p>This sample of 1200 PATH study participants (contained in the tibble data_final) can thus be considered as a longitudinal cross-sectional sample of individuals who used e-cigarettes at the time of administering the Wave 1 questionnaire, who may or may not have used other tobacco products, across the United States, of ages 18 and above. Wave 1 began at September 2013 and ended at December 2014.</p>
</section>
<section id="loading-and-tidying-the-data" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Loading and Tidying the Data</h1>
<section id="loading-the-raw-data" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="loading-the-raw-data"><span class="header-section-number">3.1</span> Loading the Raw Data</h2>
<p>Access to the data requires users to log-in to the ICPSR website. Thus, a direct download is not possible. This data can be freely downloaded by the public, and therefore a local copy of the data in the form of a tsv file was read using <code>read_tsv</code> from the tidyverse.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#data_raw &lt;- read_tsv("36498-1001-Data.tsv", show_col_types = FALSE)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#saveRDS(data_raw, "36498-1001-Data.Rds")</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>data_raw <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="st">"36498-1001-Data.Rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="cleaning-the-data" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="cleaning-the-data"><span class="header-section-number">3.2</span> Cleaning the Data</h2>
<section id="selecting-variables-well-use" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="selecting-variables-well-use"><span class="header-section-number">3.2.1</span> Selecting Variables We’ll Use</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data_var <span class="ot">&lt;-</span> data_raw <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(PERSONID,R01_AE1022,R01_AE0103,R01R_A_AE1006,R01_AE1062,R01_AE1100,R01_AE1099,R01_AE9004,R01_AE9010,R01_AE1050,R01R_A_MINFIRST_ECIG, R01_AE1003)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="dealing-with-missingness" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="dealing-with-missingness"><span class="header-section-number">3.2.2</span> Dealing with Missingness</h3>
<p>The DS1001 dataset provides negative values for variables that are missing. There are several different subtypes of missing data:</p>
<ul>
<li>Data removed due to respondent request</li>
<li>Data not ascertained</li>
<li>Respondent answer is “Don’t Know”</li>
<li>Respondent refused to answer</li>
<li>Question inapplicable to respondent</li>
</ul>
<p>All of these values are negative in the original DS1001 dataset, and none of the variables under study have negative values. It is also not possible for the variables under study to have negative values. Therefore, all negative values were replaced with <code>NA</code> to ensure missing data are correctly identified.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>data_var <span class="ot">&lt;-</span> data_var<span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="cf">function</span>(x){<span class="fu">replace</span>(x, <span class="fu">which</span>(x<span class="sc">&lt;</span><span class="dv">0</span>), <span class="cn">NA</span>)}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="changing-variable-names" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="changing-variable-names"><span class="header-section-number">3.2.3</span> Changing Variable Names</h3>
<p>The variables were renamed to have better, more readable names.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>data_var <span class="ot">&lt;-</span> data_var<span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ecig_30day =</span> <span class="fu">as.integer</span>(R01_AE1022),</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">puff_num =</span> <span class="fu">as.integer</span>(R01_AE0103),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">age_range =</span> <span class="fu">factor</span>(R01R_A_AE1006),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">less_harm =</span> <span class="fu">factor</span>(R01_AE1062),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">ecig_reg =</span> <span class="fu">factor</span>(R01_AE1100),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">harm_perc =</span> <span class="fu">factor</span>(R01_AE1099),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">price_paid =</span> <span class="fu">factor</span>(R01_AE9004),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">personid =</span> <span class="fu">as.character</span>(PERSONID),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">ecig_nico =</span> <span class="fu">as.factor</span>(R01_AE9010),</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">ecig_flavored =</span> <span class="fu">as.factor</span>(R01_AE1050),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">min_num =</span> <span class="fu">as.integer</span>(R01R_A_MINFIRST_ECIG),</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">ecig_smoker =</span> <span class="fu">factor</span>(R01_AE1003)) <span class="sc">|&gt;</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(personid, ecig_30day,puff_num,age_range,less_harm,ecig_reg,harm_perc,price_paid,ecig_nico, ecig_flavored, min_num, ecig_smoker)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>data_var <span class="ot">&lt;-</span> data_var <span class="sc">|&gt;</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="sampling-the-data" class="level3" data-number="3.2.4">
<h3 data-number="3.2.4" class="anchored" data-anchor-id="sampling-the-data"><span class="header-section-number">3.2.4</span> Sampling the Data</h3>
<p>The dataset was filtered to select only individuals who were users of e-cigarettes at the time of study. The dataset was then filtered to have complete cases on both the outcomes under study, namely <code>ecig_30day</code> and <code>ecig_reg</code>.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data_outcome <span class="ot">&lt;-</span> data_var <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ecig_smoker <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> ecig_smoker <span class="sc">==</span> <span class="dv">2</span>)<span class="sc">|&gt;</span> <span class="co"># Excluding individuals who did not use e-cigarettes at the time of Wave 1 </span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">complete.cases</span>(ecig_30day, ecig_reg)) <span class="sc">|&gt;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(personid, ecig_30day,puff_num,age_range,less_harm,ecig_reg,harm_perc,price_paid,ecig_nico, ecig_flavored, min_num, ecig_smoker)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(data_outcome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3000   12</code></pre>
</div>
</div>
<p>3000 respondents have information on both the outcome variables under study. After setting a seed for reproducibility, a random sample of 1200 respondents was taken from the <code>data_outcome</code> tibble. This was also done to ensure that the same respondents are analyzed for both regression models.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2023</span>) </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>data_complete <span class="ot">&lt;-</span> <span class="fu">slice_sample</span>(data_outcome, <span class="at">n =</span> <span class="dv">1200</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Once a random sample was taken, the <code>tabyl</code> function was used to ensure that all individuals in the tibble <code>data_complete</code> were individuals who had used e-cigarettes.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>data_complete <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(ecig_smoker) <span class="sc">|&gt;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">ecig_smoker</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">0.0341667</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">1159</td>
<td style="text-align: right;">0.9658333</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000000</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>From the documentation for the original variable name for <code>ecig_smoker</code>(<code>R01_AE1003</code>), the question asked was, ‘Do you now use e-cigarettes?’, with three possible levels.</p>
<table class="table">
<thead>
<tr class="header">
<th>Value</th>
<th>Label</th>
<th>Frequency</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1 = Every day</td>
<td>41</td>
</tr>
<tr class="even">
<td>2</td>
<td>2 = Some days</td>
<td>1159</td>
</tr>
<tr class="odd">
<td>3</td>
<td>3 = Not at all</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>The above table shows the distribution of the responses to the question, demonstrating that all the individuals under study are individuals who were using e-cigarettes at the time of the Wave 1 questionnaire. Individuals who did not use e-cigarettes at the time are not included in the random sample of 1200 respondents.</p>
</section>
<section id="working-with-categorical-predictors" class="level3" data-number="3.2.5">
<h3 data-number="3.2.5" class="anchored" data-anchor-id="working-with-categorical-predictors"><span class="header-section-number">3.2.5</span> Working with Categorical Predictors</h3>
<p>The <code>tabyl</code> function was used to check if all factor variables have atleast 30 observations at each level.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>data_complete <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(age_range)<span class="sc">|&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">age_range</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">percent</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">valid_percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">0.0450000</td>
<td style="text-align: right;">0.0453020</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">365</td>
<td style="text-align: right;">0.3041667</td>
<td style="text-align: right;">0.3062081</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">276</td>
<td style="text-align: right;">0.2300000</td>
<td style="text-align: right;">0.2315436</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">181</td>
<td style="text-align: right;">0.1508333</td>
<td style="text-align: right;">0.1518456</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">169</td>
<td style="text-align: right;">0.1408333</td>
<td style="text-align: right;">0.1417785</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: right;">147</td>
<td style="text-align: right;">0.1225000</td>
<td style="text-align: right;">0.1233221</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NA</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.0066667</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>data_complete <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(less_harm) <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">less_harm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">percent</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">valid_percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">955</td>
<td style="text-align: right;">0.7958333</td>
<td style="text-align: right;">0.7998325</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">239</td>
<td style="text-align: right;">0.1991667</td>
<td style="text-align: right;">0.2001675</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NA</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.0050000</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>data_complete <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(ecig_reg) <span class="sc">|&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">ecig_reg</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">369</td>
<td style="text-align: right;">0.3075</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">831</td>
<td style="text-align: right;">0.6925</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>data_complete <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(harm_perc) <span class="sc">|&gt;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">harm_perc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">percent</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">valid_percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">822</td>
<td style="text-align: right;">0.6850000</td>
<td style="text-align: right;">0.6919192</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">343</td>
<td style="text-align: right;">0.2858333</td>
<td style="text-align: right;">0.2887205</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">0.0191667</td>
<td style="text-align: right;">0.0193603</td>
</tr>
<tr class="even">
<td style="text-align: left;">NA</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.0100000</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The <code>harm_perc</code> variable was found to have a level <code>3</code> which only had 23 observations. Factor levels <code>2</code> and <code>3</code> for <code>harm_perc</code> were collapsed into a single category.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>data_complete<span class="sc">$</span>harm_perc <span class="ot">&lt;-</span> <span class="fu">fct_collapse</span>(data_complete<span class="sc">$</span>harm_perc,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'2'</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"2"</span>, <span class="st">"3"</span>),</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">'1'</span> <span class="ot">=</span> <span class="st">"1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, <code>harm_perc</code> has only 2 levels, each with more than 30 distinct values.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data_complete <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(harm_perc)<span class="sc">|&gt;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">harm_perc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">percent</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">valid_percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">822</td>
<td style="text-align: right;">0.685</td>
<td style="text-align: right;">0.6919192</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">366</td>
<td style="text-align: right;">0.305</td>
<td style="text-align: right;">0.3080808</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NA</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>data_complete <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(price_paid)<span class="sc">|&gt;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">price_paid</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">percent</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">valid_percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">189</td>
<td style="text-align: right;">0.1575000</td>
<td style="text-align: right;">0.2342007</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">260</td>
<td style="text-align: right;">0.2166667</td>
<td style="text-align: right;">0.3221809</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">328</td>
<td style="text-align: right;">0.2733333</td>
<td style="text-align: right;">0.4064436</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">0.0250000</td>
<td style="text-align: right;">0.0371747</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NA</td>
<td style="text-align: right;">393</td>
<td style="text-align: right;">0.3275000</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>data_complete <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(ecig_nico)<span class="sc">|&gt;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">ecig_nico</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">percent</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">valid_percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">320</td>
<td style="text-align: right;">0.2666667</td>
<td style="text-align: right;">0.8695652</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">0.0400000</td>
<td style="text-align: right;">0.1304348</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NA</td>
<td style="text-align: right;">832</td>
<td style="text-align: right;">0.6933333</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>data_complete <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(ecig_flavored)<span class="sc">|&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">ecig_flavored</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">percent</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">valid_percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">246</td>
<td style="text-align: right;">0.2050</td>
<td style="text-align: right;">0.6666667</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">123</td>
<td style="text-align: right;">0.1025</td>
<td style="text-align: right;">0.3333333</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NA</td>
<td style="text-align: right;">831</td>
<td style="text-align: right;">0.6925</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The other factor variables were found to have at least 30 observations at each level. Furthermore, none of the categorical variables have more than 6 levels.</p>
</section>
<section id="working-with-quantitative-variables" class="level3" data-number="3.2.6">
<h3 data-number="3.2.6" class="anchored" data-anchor-id="working-with-quantitative-variables"><span class="header-section-number">3.2.6</span> Working with Quantitative Variables</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>data_complete <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(personid, ecig_30day, puff_num, min_num) <span class="sc">|&gt;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(personid<span class="sc">:</span>min_num, <span class="sc">~</span> <span class="fu">n_distinct</span>(.)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  personid ecig_30day puff_num min_num
     &lt;int&gt;      &lt;int&gt;    &lt;int&gt;   &lt;int&gt;
1     1200         28       29      31</code></pre>
</div>
</div>
<p>The quantitative variables <code>ecig_30day</code>,<code>puff_num</code> and <code>min_num</code> have at least 10 different, ordered, observed values.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>data_complete <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(personid, ecig_30day, puff_num, min_num) <span class="sc">|&gt;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">miss_var_summary</span>() <span class="sc">|&gt;</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n_miss</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pct_miss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">min_num</td>
<td style="text-align: right;">853</td>
<td style="text-align: right;">71.08333</td>
</tr>
<tr class="even">
<td style="text-align: left;">puff_num</td>
<td style="text-align: right;">849</td>
<td style="text-align: right;">70.75000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">personid</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00000</td>
</tr>
<tr class="even">
<td style="text-align: left;">ecig_30day</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00000</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The <code>miss_var_summary</code> function from the <code>naniar</code> package was used to identify the number of missing values for the continuous variables under study.</p>
</section>
<section id="renaming-the-factors" class="level3" data-number="3.2.7">
<h3 data-number="3.2.7" class="anchored" data-anchor-id="renaming-the-factors"><span class="header-section-number">3.2.7</span> Renaming the factors</h3>
<p>The categorical variables had their factors renamed to make the data more readable. The final tidy tibble was designated as <code>data_final</code>.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>data_final <span class="ot">&lt;-</span> data_complete<span class="sc">|&gt;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_range =</span> <span class="fu">fct_recode</span>(<span class="fu">factor</span>(age_range),</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"&lt;18"</span> <span class="ot">=</span> <span class="st">"1"</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"18to24"</span> <span class="ot">=</span> <span class="st">"2"</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"25to34"</span> <span class="ot">=</span> <span class="st">"3"</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"35to44"</span> <span class="ot">=</span> <span class="st">"4"</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"45to54"</span> <span class="ot">=</span> <span class="st">"5"</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"&gt;55"</span> <span class="ot">=</span> <span class="st">"6"</span>),</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">less_harm =</span> <span class="fu">fct_recode</span>(<span class="fu">factor</span>(less_harm),</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"1"</span>,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"No"</span> <span class="ot">=</span> <span class="st">"2"</span>),</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">ecig_reg =</span> <span class="fu">fct_recode</span>(<span class="fu">factor</span>(ecig_reg),</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"1"</span>,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"No"</span> <span class="ot">=</span> <span class="st">"2"</span>),</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">harm_perc =</span> <span class="fu">fct_recode</span>(<span class="fu">factor</span>(harm_perc),</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"less_harm"</span> <span class="ot">=</span> <span class="st">"1"</span>,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"same_or_more"</span> <span class="ot">=</span> <span class="st">"2"</span>),</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">price_paid =</span> <span class="fu">fct_recode</span>(<span class="fu">factor</span>(price_paid),</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Below$10"</span> <span class="ot">=</span> <span class="st">"1"</span>,</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"$10to$20"</span> <span class="ot">=</span> <span class="st">"2"</span>,</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"$21to$100"</span> <span class="ot">=</span> <span class="st">"3"</span>,</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"&gt;$100"</span> <span class="ot">=</span> <span class="st">"4"</span>),</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">ecig_nico =</span> <span class="fu">fct_recode</span>(<span class="fu">factor</span>(ecig_nico),</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"1"</span>,</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"No"</span> <span class="ot">=</span> <span class="st">"2"</span>),</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">ecig_flavored =</span> <span class="fu">fct_recode</span>(<span class="fu">factor</span>(ecig_flavored),</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"1"</span>,</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"No"</span> <span class="ot">=</span> <span class="st">"2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="splitting-the-data" class="level3" data-number="3.2.8">
<h3 data-number="3.2.8" class="anchored" data-anchor-id="splitting-the-data"><span class="header-section-number">3.2.8</span> Splitting the Data</h3>
<p>Once a random sample of 1200 respondents was taken, the data was separated into two tibbles for the purpose of describing the data under study for the two models. <code>data_log</code> denotes the dataset for the logistic regression, and <code>data_lin</code> denotes the dataset for the linear regression.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>data_lin <span class="ot">&lt;-</span> data_final<span class="sc">|&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(personid,ecig_30day,puff_num,age_range,less_harm,ecig_nico)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>data_log <span class="ot">&lt;-</span> data_final<span class="sc">|&gt;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(personid,ecig_reg,min_num,harm_perc,price_paid,ecig_nico,ecig_flavored)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="the-tidy-tibble" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> The Tidy Tibble</h1>
<section id="listing-the-tibble" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="listing-the-tibble"><span class="header-section-number">4.1</span> Listing the Tibble</h2>
<p>The tidy tibble, <code>data_final</code>, was listed.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>data_final </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,200 × 12
   personid   ecig_30day puff_num age_range less_harm ecig_reg harm_perc   
   &lt;chr&gt;           &lt;int&gt;    &lt;int&gt; &lt;fct&gt;     &lt;fct&gt;     &lt;fct&gt;    &lt;fct&gt;       
 1 P000319879          1       NA &lt;18       Yes       No       less_harm   
 2 P000255041          0       NA 25to34    Yes       Yes      less_harm   
 3 P000413552          2       NA 35to44    Yes       No       same_or_more
 4 P000239368          1       NA 45to54    Yes       No       less_harm   
 5 P000334022          1       NA 35to44    Yes       No       less_harm   
 6 P000151148         25       NA 45to54    Yes       Yes      less_harm   
 7 P000423889          2       NA 45to54    No        No       same_or_more
 8 P000264820         24        4 35to44    No        No       less_harm   
 9 P000321341          2       NA 45to54    No        No       same_or_more
10 P000200073          2       NA 25to34    No        No       same_or_more
# ℹ 1,190 more rows
# ℹ 5 more variables: price_paid &lt;fct&gt;, ecig_nico &lt;fct&gt;, ecig_flavored &lt;fct&gt;,
#   min_num &lt;int&gt;, ecig_smoker &lt;fct&gt;</code></pre>
</div>
</div>
</section>
<section id="size-and-identifiers" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="size-and-identifiers"><span class="header-section-number">4.2</span> Size and Identifiers</h2>
<p>There are 1200 rows, with 12 columns in the final tibble <code>data_final</code>. One of these columns</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(data_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1200   12</code></pre>
</div>
</div>
<p>The <code>personid</code> variable provides the identifier for each row in the tidy tibble. The <code>n_distinct</code> function was used to demonstrate 1200 individual values for <code>personid</code> in <code>data_final</code>, indicating that each row has a unique <code>personid</code> value.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">n_distinct</span>(data_final<span class="sc">$</span>personid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1200</code></pre>
</div>
</div>
</section>
<section id="save-the-tibble" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="save-the-tibble"><span class="header-section-number">4.3</span> Save The Tibble</h2>
<p>The <code>saveRDS</code> function was used to save the tidy tibble in a .rds file.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(data_final, <span class="at">file =</span> <span class="st">"data_final.Rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="the-code-book" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> The Code Book</h1>
<section id="defining-the-variables" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="defining-the-variables"><span class="header-section-number">5.1</span> Defining the Variables</h2>
<table class="table">
<colgroup>
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 53%">
<col style="width: 13%">
<col style="width: 10%">
<col style="width: 6%">
<col style="width: 0%">
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Variable</strong></td>
<td><strong>Original DS1001 code</strong></td>
<td colspan="5"><strong>Description</strong> | <strong>Type</strong> | <strong>Analytic Role</strong> | <strong>Missing values</strong></td>
</tr>
<tr class="even">
<td><code>personid</code></td>
<td><code>PERSONID</code></td>
<td>Unique Participant Identifier</td>
<td>Character variable</td>
<td>Unique Identifier</td>
<td>0</td>
<td></td>
</tr>
<tr class="odd">
<td><code>ecig_30day</code></td>
<td><code>R01_AE1022</code></td>
<td>On how many of the past 30 days did the participant use an e-cigarette?</td>
<td>Quantitative Variable</td>
<td>Linear Regression <strong>Outcome</strong></td>
<td>0</td>
<td></td>
</tr>
<tr class="even">
<td><code>puff_num</code></td>
<td><code>R01_AE0103</code></td>
<td>How many puffs from an e-cigarette did the participant take the last time they smoked an e-cigarette?</td>
<td>Quantitative Variable</td>
<td>Predictor</td>
<td>849</td>
<td></td>
</tr>
<tr class="odd">
<td><code>age_range</code></td>
<td><code>R01R_A_AE1006</code></td>
<td><p>How old was the participant when they first used an e-cigarette, even one or two times?</p>
<p>6 levels:<code>&lt;18</code>,<code>18to24</code>,</p>
<p><code>25to34</code>,<code>35to44</code>,</p>
<p><code>45to54</code>,<code>&gt;55</code></p></td>
<td>Multi-Categorical Variable with 6 factors</td>
<td>Predictor</td>
<td>8</td>
<td></td>
</tr>
<tr class="even">
<td><code>less_harm</code></td>
<td><code>R01_AE1062</code></td>
<td><p>Did the participant use / used to use e-cigarettes because they might be / have been less harmful to them?</p>
<p>2 levels: <code>yes</code>, <code>no</code></p></td>
<td>Binary Categorical Variable</td>
<td>Predictor</td>
<td>6</td>
<td></td>
</tr>
<tr class="odd">
<td><code>ecig_reg</code></td>
<td><code>R01_AE1100</code></td>
<td><p>Has the participant ever used e-cigarettes fairly regularly?</p>
<p>2 levels:<code>yes</code>,<code>no</code></p></td>
<td>Binary Categorical Variable</td>
<td>Logistic regression <strong>Outcome</strong></td>
<td>0</td>
<td></td>
</tr>
<tr class="even">
<td><code>harm_perc</code></td>
<td><code>R01_AE1099</code></td>
<td><p>To the participant, is using e-cigarettes less harmful, about the same, or more harmful than smoking cigarettes?</p>
<p>2 levels:<code>1</code>,<code>2</code></p></td>
<td>Binary Categorical Variable</td>
<td>Predictor</td>
<td>12</td>
<td></td>
</tr>
<tr class="odd">
<td><code>price_paid</code></td>
<td><code>R01_AE9004</code></td>
<td><p>About how much did the participant pay for their e-cigarette?</p>
<p>4 levels: <code>Below$10</code>,<code>$10to$20</code>,</p>
<p><code>$21t$100</code>, <code>&gt;$100</code></p></td>
<td>Multi-Categorical Variable with 4 factors</td>
<td>Predictor</td>
<td>393</td>
<td></td>
</tr>
<tr class="even">
<td><code>ecig_nico</code></td>
<td><code>R01_AE9010</code></td>
<td><p>Does the e-cigarette the participant usually uses contain nicotine?</p>
<p>2 levels:<code>yes</code>,<code>no</code></p></td>
<td>Binary Categorical Variable</td>
<td>Predictor</td>
<td>832</td>
<td></td>
</tr>
<tr class="odd">
<td><code>ecig_flavored</code></td>
<td><code>R01_AE9010</code></td>
<td><p>Is the regular / last brand of e-cigarettes used by the participant flavored to taste like menthol, mint,clove, spice, candy, fruit, chocolate, alcohol or other sweets?</p>
<p>2 levels:<code>yes</code>,<code>no</code></p></td>
<td>Binary Categorical Variable</td>
<td>Predictor</td>
<td>831</td>
<td></td>
</tr>
<tr class="even">
<td><code>min_num</code></td>
<td><code>R01R_A_MINFIRST_ECIG</code></td>
<td>Amount of time from waking to smoking first e-cigarette of any given day (in minutes).</td>
<td>Quantitative Variable</td>
<td>Predictor</td>
<td>853</td>
<td></td>
</tr>
</tbody>
</table>
<p>The levels of the categorical variables and their description are as follows:</p>
<p><strong><code>age_range</code></strong></p>
<p><strong>How old was the participant when they first used an e-cigarette, even one or two times?</strong></p>
<table class="table">
<thead>
<tr class="header">
<th>Level</th>
<th>Description</th>
<th>Distinct Observations in Level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>&lt;18</code></td>
<td>Less than 18 years old</td>
<td>54</td>
</tr>
<tr class="even">
<td><code>18to24</code></td>
<td>18 to 24 years old</td>
<td>365</td>
</tr>
<tr class="odd">
<td><code>25to34</code></td>
<td>25 to 34 years old</td>
<td>276</td>
</tr>
<tr class="even">
<td><code>35to44</code></td>
<td>35 to 44 years old</td>
<td>181</td>
</tr>
<tr class="odd">
<td><code>45to54</code></td>
<td>45 to 54 years old</td>
<td>169</td>
</tr>
<tr class="even">
<td><code>&gt;55</code></td>
<td>55 years old or older</td>
<td>147</td>
</tr>
</tbody>
</table>
<p><strong><code>less_harm</code></strong></p>
<p><strong>Did the participant use / used to use e-cigarettes because they might be / have been less harmful to them?</strong></p>
<table class="table">
<thead>
<tr class="header">
<th>Level</th>
<th>Description</th>
<th>Distinct Observations in Level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>yes</code></td>
<td>Yes</td>
<td>955</td>
</tr>
<tr class="even">
<td><code>no</code></td>
<td>No</td>
<td>239</td>
</tr>
</tbody>
</table>
<p><strong><code>ecig_reg</code></strong></p>
<p><strong>Has the participant ever used e-cigarettes fairly regularly?</strong></p>
<table class="table">
<thead>
<tr class="header">
<th>Level</th>
<th>Description</th>
<th>Distinct Observations in Level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>yes</code></td>
<td>Yes</td>
<td>369</td>
</tr>
<tr class="even">
<td><code>no</code></td>
<td>No</td>
<td>831</td>
</tr>
</tbody>
</table>
<p><strong><code>harm_perc</code></strong></p>
<p><strong>To the participant, is using e-cigarettes less harmful, about the same, or more harmful than smoking cigarettes?</strong></p>
<table class="table">
<colgroup>
<col style="width: 19%">
<col style="width: 39%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th>Level</th>
<th>Description</th>
<th>Distinct Observations in Level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>1</code></td>
<td>Less harmful</td>
<td>822</td>
</tr>
<tr class="even">
<td><code>2</code></td>
<td>About the Same / More harmful</td>
<td>366</td>
</tr>
</tbody>
</table>
<p><strong><code>price_paid</code></strong></p>
<p><strong>About how much did the participant pay for their e-cigarette?</strong></p>
<table class="table">
<thead>
<tr class="header">
<th>Level</th>
<th>Description</th>
<th>Distinct Observations in Level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Below$10</code></td>
<td>Less than $10</td>
<td>189</td>
</tr>
<tr class="even">
<td><code>$10to$20</code></td>
<td>$10 to $20</td>
<td>260</td>
</tr>
<tr class="odd">
<td><code>$21to$100</code></td>
<td>$21 to $100</td>
<td>328</td>
</tr>
<tr class="even">
<td><code>&gt;$100</code></td>
<td>More than $100</td>
<td>30</td>
</tr>
</tbody>
</table>
<p><strong><code>ecig_nico</code></strong></p>
<p><strong>Does the e-cigarette the participant usually uses contain nicotine?</strong></p>
<table class="table">
<thead>
<tr class="header">
<th>Level</th>
<th>Description</th>
<th>Distinct Observations in Level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>yes</code></td>
<td>Yes</td>
<td>320</td>
</tr>
<tr class="even">
<td><code>no</code></td>
<td>No</td>
<td>48</td>
</tr>
</tbody>
</table>
<p><strong><code>ecig_flavored</code></strong></p>
<p><strong>Is the regular/last brand of e-cigarettes used by the participant flavored to taste like menthol, mint, clove, spice, candy, fruit, chocolate, alcohol or other sweets?</strong></p>
<table class="table">
<thead>
<tr class="header">
<th>Level</th>
<th>Description</th>
<th>Distinct Observations in Level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>yes</code></td>
<td>Yes</td>
<td>246</td>
</tr>
<tr class="even">
<td><code>no</code></td>
<td>No</td>
<td>123</td>
</tr>
</tbody>
</table>
</section>
<section id="numerical-description" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="numerical-description"><span class="header-section-number">5.2</span> Numerical Description</h2>
<p>The <code>describe</code> function from the <code>Hmisc</code> package was used on the entire tibble.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(data_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>data_final 

 12  Variables      1200  Observations
--------------------------------------------------------------------------------
personid 
       n  missing distinct 
    1200        0     1200 

lowest : P000000176 P000000318 P000000457 P000001710 P000001806
highest: P000497409 P000498677 P000499021 P000499448 P000499846
--------------------------------------------------------------------------------
ecig_30day 
       n  missing distinct     Info     Mean      Gmd      .05      .10 
    1200        0       28    0.972     5.11    6.663        0        0 
     .25      .50      .75      .90      .95 
       0        2        6       15       20 

lowest :  0  1  2  3  4, highest: 25 26 28 29 30
--------------------------------------------------------------------------------
puff_num 
       n  missing distinct     Info     Mean      Gmd      .05      .10 
     351      849       28     0.99    10.77    10.15        2        3 
     .25      .50      .75      .90      .95 
       4        6       10       25       30 

lowest :   1   2   3   4   5, highest:  50  51  60  75 100
--------------------------------------------------------------------------------
age_range 
       n  missing distinct 
    1192        8        6 
                                                    
Value         &lt;18 18to24 25to34 35to44 45to54    &gt;55
Frequency      54    365    276    181    169    147
Proportion  0.045  0.306  0.232  0.152  0.142  0.123
--------------------------------------------------------------------------------
less_harm 
       n  missing distinct 
    1194        6        2 
                  
Value      Yes  No
Frequency  955 239
Proportion 0.8 0.2
--------------------------------------------------------------------------------
ecig_reg 
       n  missing distinct 
    1200        0        2 
                      
Value        Yes    No
Frequency    369   831
Proportion 0.308 0.693
--------------------------------------------------------------------------------
harm_perc 
       n  missing distinct 
    1188       12        2 
                                    
Value         less_harm same_or_more
Frequency           822          366
Proportion        0.692        0.308
--------------------------------------------------------------------------------
price_paid 
       n  missing distinct 
     807      393        4 
                                                  
Value       Below$10  $10to$20 $21to$100     &gt;$100
Frequency        189       260       328        30
Proportion     0.234     0.322     0.406     0.037
--------------------------------------------------------------------------------
ecig_nico 
       n  missing distinct 
     368      832        2 
                    
Value       Yes   No
Frequency   320   48
Proportion 0.87 0.13
--------------------------------------------------------------------------------
ecig_flavored 
       n  missing distinct 
     369      831        2 
                      
Value        Yes    No
Frequency    246   123
Proportion 0.667 0.333
--------------------------------------------------------------------------------
min_num 
       n  missing distinct     Info     Mean      Gmd      .05      .10 
     347      853       30    0.993    149.1      182        3        5 
     .25      .50      .75      .90      .95 
      15       60      240      360      522 

lowest :    1    2    3    4    5, highest:  720  780  840  900 1020
--------------------------------------------------------------------------------
ecig_smoker 
       n  missing distinct 
    1200        0        2 
                      
Value          1     2
Frequency     41  1159
Proportion 0.034 0.966
--------------------------------------------------------------------------------</code></pre>
</div>
</div>
</section>
</section>
<section id="linear-regression-plans" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Linear Regression Plans</h1>
<section id="my-first-research-question" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="my-first-research-question"><span class="header-section-number">6.1</span> My First Research Question</h2>
<p><em>E-Cigarette Perception, Smoking Habits, and their association with Heavy E-Cigarette Use:</em></p>
<p><strong>Are smoking e-cigarettes that contain nicotine, the perception of the purported healthiness of e-cigarettes when compared to smoking regular cigarettes, and smoking habits strong predictors of heavy e-cigarette use in adulthood?</strong></p>
</section>
<section id="my-quantitative-outcome" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="my-quantitative-outcome"><span class="header-section-number">6.2</span> My Quantitative Outcome</h2>
<p>The quantitative variable I will be predicting is <code>ecig_30day</code>.</p>
<p>In the United States, e-cigarettes are not subject to the same marketing and promotion restrictions that apply to cigarettes. E-cigarette companies are permitted to advertise their products through mass media, and via the internet. Previous studies have demonstrated that e-cigarettes companies exacerbate and expand the tobacco epidemic by bringing lower risk youth into the market.<sup>[1]</sup> E-Cigarette use among young adults has been rapidly expanding, and has surpassed conventional cigarette use among young adults.<sup>[2]</sup></p>
<p>From a study conducted in 2017, while the demographic and behavioral risk profiles of most youth who reported smoking cigarettes (both cigarettes and e-cigarettes) are consistent with smoking cigarettes, the risk profiles of the remaining e-cigarette-only users (about 25% of e-cigarette users) suggested that these individuals would have been unlikely to have initiated tobacco product use with cigarettes.<sup>[3]</sup></p>
<p>E-cigarettes are reducing smoking cessation rates and expanding the nicotine market by attracting low-risk youth who would be unlikely to initiate nicotine use with conventional cigarettes.<sup>[4]</sup></p>
<p>By attempting to predict higher use of e-cigarettes in the past 30 days(at the time of data collection) with the variables under study, the association between e-cigarette perception and smoking habits with heavy e-cigarette use can be studied.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>data_lin <span class="sc">|&gt;</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">complete.cases</span>(ecig_30day)) <span class="sc">|&gt;</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1200    6</code></pre>
</div>
</div>
<p>Out of the 1200 rows in <code>data_lin</code>, all 1200 have complete data on the outcome variable <code>ecig_30day</code>.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_lin, <span class="fu">aes</span>(<span class="at">x =</span> ecig_30day)) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">15</span>, </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="st">"#2b8cbe"</span>, <span class="at">col =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x =</span> <span class="st">"Number of days used an e-cigarette"</span>, <span class="at">y =</span><span class="st">""</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_lin, <span class="fu">aes</span>(<span class="at">sample =</span> ecig_30day)) <span class="sc">+</span> </span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>(<span class="at">col =</span> <span class="st">"#2b8cbe"</span>) <span class="sc">+</span> <span class="fu">geom_qq_line</span>(<span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Number of days used an e-cigarette"</span>)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> </span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_lin, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> ecig_30day)) <span class="sc">+</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="st">"#2b8cbe"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"#2b8cbe"</span>, <span class="at">width =</span> <span class="fl">0.3</span>,</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Number of days used an e-cigarette"</span>, <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">coord_flip</span>()</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span> p1 <span class="sc">-</span> p3 <span class="sc">+</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">height =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"Distribution of the number of days participants used an e-cigarette in the past 30 days"</span>,</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">glue</span>(<span class="st">"Across "</span>, <span class="fu">nrow</span>(data_lin), </span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>                           <span class="st">" participants, taken as a random sample from the DS1001 dataset."</span>),</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"Data taken from the Population Assessment of Tobacco and Health (PATH) Study."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>The distribution is very notably right skewed. Taking the logarithm of the outcome variable might help in making it’s distribution more normalized.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(data_lin<span class="sc">$</span>ecig_30day)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>data_lin$ecig_30day 
       n  missing distinct     Info     Mean      Gmd      .05      .10 
    1200        0       28    0.972     5.11    6.663        0        0 
     .25      .50      .75      .90      .95 
       0        2        6       15       20 

lowest :  0  1  2  3  4, highest: 25 26 28 29 30</code></pre>
</div>
</div>
<p>The <code>describe</code> function shows that there are 28 distinct values for the <code>ecig_30day</code> variable, and the variable has at least 10 different, ordered, observed values.</p>
</section>
<section id="my-planned-predictors-linear-model" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="my-planned-predictors-linear-model"><span class="header-section-number">6.3</span> My Planned Predictors (Linear Model)</h2>
<p>The inputs that will be used in the linear regression model are:</p>
<ul>
<li><code>puff_num</code>: This is a quantitative variable that has atleast 10 distinct, ordered, observed values.</li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(data_lin<span class="sc">$</span>puff_num)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>data_lin$puff_num 
       n  missing distinct     Info     Mean      Gmd      .05      .10 
     351      849       28     0.99    10.77    10.15        2        3 
     .25      .50      .75      .90      .95 
       4        6       10       25       30 

lowest :   1   2   3   4   5, highest:  50  51  60  75 100</code></pre>
</div>
</div>
<ul>
<li><code>age_range</code>: This is a categorical variable which has 6 categories, that has at least 30 observations in each level of the factor.</li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>data_lin<span class="sc">|&gt;</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(age_range) <span class="sc">|&gt;</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">age_range</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">percent</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">valid_percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">&lt;18</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">0.0450000</td>
<td style="text-align: right;">0.0453020</td>
</tr>
<tr class="even">
<td style="text-align: left;">18to24</td>
<td style="text-align: right;">365</td>
<td style="text-align: right;">0.3041667</td>
<td style="text-align: right;">0.3062081</td>
</tr>
<tr class="odd">
<td style="text-align: left;">25to34</td>
<td style="text-align: right;">276</td>
<td style="text-align: right;">0.2300000</td>
<td style="text-align: right;">0.2315436</td>
</tr>
<tr class="even">
<td style="text-align: left;">35to44</td>
<td style="text-align: right;">181</td>
<td style="text-align: right;">0.1508333</td>
<td style="text-align: right;">0.1518456</td>
</tr>
<tr class="odd">
<td style="text-align: left;">45to54</td>
<td style="text-align: right;">169</td>
<td style="text-align: right;">0.1408333</td>
<td style="text-align: right;">0.1417785</td>
</tr>
<tr class="even">
<td style="text-align: left;">&gt;55</td>
<td style="text-align: right;">147</td>
<td style="text-align: right;">0.1225000</td>
<td style="text-align: right;">0.1233221</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NA</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.0066667</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>


</div>
</div>
<ul>
<li><code>less_harm</code>, which is a binary categorical variable.</li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>data_lin<span class="sc">|&gt;</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(less_harm) <span class="sc">|&gt;</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">less_harm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">percent</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">valid_percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">955</td>
<td style="text-align: right;">0.7958333</td>
<td style="text-align: right;">0.7998325</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: right;">239</td>
<td style="text-align: right;">0.1991667</td>
<td style="text-align: right;">0.2001675</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NA</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.0050000</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>


</div>
</div>
<ul>
<li><code>ecig_nico</code>, which is a binary categorical variable.</li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>data_lin<span class="sc">|&gt;</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(ecig_nico)<span class="sc">|&gt;</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">ecig_nico</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">percent</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">valid_percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">320</td>
<td style="text-align: right;">0.2666667</td>
<td style="text-align: right;">0.8695652</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">0.0400000</td>
<td style="text-align: right;">0.1304348</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NA</td>
<td style="text-align: right;">832</td>
<td style="text-align: right;">0.6933333</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>There are a total of 4 predictors.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>datatest1 <span class="ot">&lt;-</span> data_lin <span class="sc">|&gt;</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">complete.cases</span>(personid,ecig_30day,puff_num,age_range,less_harm,ecig_nico)) <span class="sc">|&gt;</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(personid,ecig_30day,puff_num,age_range,less_harm,ecig_nico)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(datatest1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 137   6</code></pre>
</div>
</div>
<p>With 137 rows having complete observations on all the variables under study, <strong>[4 + (N1 - 100)/100]</strong> is 4.3, and the number of predictors does not exceed this value.</p>
<p>From the cited literature,</p>
<p>I expect higher values of <code>puff_num</code> to be associated with higher values of <code>ecig_30day</code>. For <code>less_harm</code> and <code>ecig_nico</code>, I expect the <code>yes</code> factor to be associated with higher values of <code>ecig_30day</code>, ie, as the two variables change from <code>no</code> to <code>yes</code>, the value of <code>ecig_30day</code> is expected to increase.</p>
<p>I expect the lower levels of <code>age_range</code> to be associated with higher values of <code>ecig_30day</code>, ie, as <code>age_range</code> factors go from the lowest factors to the higher factors, I expect <code>ecig_30day</code> to decrease.</p>
</section>
</section>
<section id="logistic-regression-plans" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Logistic Regression Plans</h1>
<section id="my-second-research-question" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="my-second-research-question"><span class="header-section-number">7.1</span> My Second Research Question</h2>
<p><em>Regular e-cigarette use and it’s associated factors:</em></p>
<p><strong>Are factors such as using flavored e-cigarettes, or needing to use e-cigarettes immediately after waking up, or using e-cigarettes with nicotine, or use of e-cigarettes as a healthier alternative to regular cigarettes associated with regular e-cigarette use?</strong></p>
</section>
<section id="my-binary-outcome" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="my-binary-outcome"><span class="header-section-number">7.2</span> My Binary Outcome</h2>
<p>The binary outcome I will be predicting is <code>ecig_reg</code>.</p>
<p>In the United States, e-cigarettes and their market value have rapidly expanded over the past years.<sup>[2]</sup> E-cigarette use and it’s prevalent adoption have resulted in youth and young adults who would otherwise not have been exposed to nicotine/tobacco products to begin the use of the drug via e-cigarettes.<sup>[3]</sup></p>
<p>Reasons for this increased use of e-cigarettes are many, including the perception of e-cigarettes as being healthier than regular cigarettes, the presence of flavored e-cigarettes available for use, and the availability of cheap, refillable cartridges that only require e-cigarette fluid.<sup>[1]</sup> By attempting to predict the odds of being a regular user of e-cigarettes using the predictors under study, the association between these factors and the odds of adoption of regular e-cigarette use can be more thoroughly studied.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>data_log<span class="sc">|&gt;</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(ecig_reg)<span class="sc">|&gt;</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">ecig_reg</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">369</td>
<td style="text-align: right;">0.3075</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: right;">831</td>
<td style="text-align: right;">0.6925</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>There are no missing values for the outcome variable.</p>
</section>
<section id="my-planned-predictors-logistic-model" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="my-planned-predictors-logistic-model"><span class="header-section-number">7.3</span> My Planned Predictors (Logistic Model)</h2>
<p>For the logistic regression model, the following are the predictors I intend to use:</p>
<ul>
<li><code>min_num</code>: This is a quantitative variable that has atleast 10 distinct, ordered, observed values.</li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(data_log<span class="sc">$</span>min_num)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>data_log$min_num 
       n  missing distinct     Info     Mean      Gmd      .05      .10 
     347      853       30    0.993    149.1      182        3        5 
     .25      .50      .75      .90      .95 
      15       60      240      360      522 

lowest :    1    2    3    4    5, highest:  720  780  840  900 1020</code></pre>
</div>
</div>
<ul>
<li><code>price_paid</code>: This is a categorical variable which has 4 categories, that has at least 30 observations in each level of the factor.</li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>data_log <span class="sc">|&gt;</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(price_paid)<span class="sc">|&gt;</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">price_paid</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">percent</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">valid_percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Below$10</td>
<td style="text-align: right;">189</td>
<td style="text-align: right;">0.1575000</td>
<td style="text-align: right;">0.2342007</td>
</tr>
<tr class="even">
<td style="text-align: left;">$10to$20</td>
<td style="text-align: right;">260</td>
<td style="text-align: right;">0.2166667</td>
<td style="text-align: right;">0.3221809</td>
</tr>
<tr class="odd">
<td style="text-align: left;">$21to$100</td>
<td style="text-align: right;">328</td>
<td style="text-align: right;">0.2733333</td>
<td style="text-align: right;">0.4064436</td>
</tr>
<tr class="even">
<td style="text-align: left;">&gt;$100</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">0.0250000</td>
<td style="text-align: right;">0.0371747</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NA</td>
<td style="text-align: right;">393</td>
<td style="text-align: right;">0.3275000</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>


</div>
</div>
<ul>
<li><code>harm_perc</code>, which is a binary categorical variable.</li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>data_log <span class="sc">|&gt;</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(harm_perc)<span class="sc">|&gt;</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">harm_perc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">percent</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">valid_percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">less_harm</td>
<td style="text-align: right;">822</td>
<td style="text-align: right;">0.685</td>
<td style="text-align: right;">0.6919192</td>
</tr>
<tr class="even">
<td style="text-align: left;">same_or_more</td>
<td style="text-align: right;">366</td>
<td style="text-align: right;">0.305</td>
<td style="text-align: right;">0.3080808</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NA</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>-<code>ecig_nico</code>, which is a binary categorical variable.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>data_log <span class="sc">|&gt;</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(ecig_nico)<span class="sc">|&gt;</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">ecig_nico</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">percent</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">valid_percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">320</td>
<td style="text-align: right;">0.2666667</td>
<td style="text-align: right;">0.8695652</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">0.0400000</td>
<td style="text-align: right;">0.1304348</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NA</td>
<td style="text-align: right;">832</td>
<td style="text-align: right;">0.6933333</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>-<code>ecig_flavored</code>, which is a binary categorical variable.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>data_log <span class="sc">|&gt;</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(ecig_flavored)<span class="sc">|&gt;</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">ecig_flavored</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">percent</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">valid_percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">246</td>
<td style="text-align: right;">0.2050</td>
<td style="text-align: right;">0.6666667</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: right;">123</td>
<td style="text-align: right;">0.1025</td>
<td style="text-align: right;">0.3333333</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NA</td>
<td style="text-align: right;">831</td>
<td style="text-align: right;">0.6925</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>There are 5 predictors.</p>
<p>With 369 subjects in the smaller of my two outcome groups, <strong>[4 + (N2 - 100)/100]</strong> is 6.69, and the number of predictors does not exceed this value.</p>
<p>From the cited literature,</p>
<p>I expect lower values of <code>min_num</code> to be associated with higher odds of being in the <code>yes</code> category of <code>ecig_reg</code>.I also expect lower values of <code>price_paid</code> to be associated with higher odds of being in the <code>yes</code> category of <code>ecig_reg</code>. I also expect <code>yes</code> values for <code>ecig_nico</code> and <code>ecig_flavored</code> to be associated with higher odds of being in the <code>yes</code> category of <code>ecig_reg</code>. I expect <code>less_harm</code> values for <code>harm_perc</code> to be associated with higher odds of being in the <code>yes</code> category of <code>ecig_reg</code>.</p>
</section>
</section>
<section id="linear-regression-analyses" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Linear Regression Analyses</h1>
<section id="missingness" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="missingness"><span class="header-section-number">8.1</span> Missingness</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>data_lin <span class="sc">|&gt;</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">miss_var_summary</span>() <span class="sc">|&gt;</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n_miss</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pct_miss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">puff_num</td>
<td style="text-align: right;">849</td>
<td style="text-align: right;">70.7500000</td>
</tr>
<tr class="even">
<td style="text-align: left;">ecig_nico</td>
<td style="text-align: right;">832</td>
<td style="text-align: right;">69.3333333</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age_range</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.6666667</td>
</tr>
<tr class="even">
<td style="text-align: left;">less_harm</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.5000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">personid</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">ecig_30day</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000000</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>There is missing data in all of the variables under study, and the outcome variable <code>ecig_30day</code> does not have any missing values. There are missing predictor values for more than 10% of the subjects under study, and more than 50 subjects have missing values.</p>
<p>The data can be assumed to be MAR (Missing At Random), since the missing data are not randomly distributed. It cannot be assumed to be MNAR (Missing Not At Random) since there does not appear to be a relationship between the magnitude of a value and it’s missingness (or inclusion in the non-missing data), since there is no preponderance of values with lower or higher magnitude being missing.</p>
<p>Single imputation was then performed on the dataset, to account for missingness. The complete dataset, containing the data for both the analyses had it’s missing values imputed.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4322023</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>data_final_i <span class="ot">&lt;-</span> data_final <span class="sc">|&gt;</span> <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">impute_rhd</span>(less_harm <span class="sc">~</span> ecig_30day <span class="sc">+</span> ecig_reg) <span class="sc">|&gt;</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">impute_rhd</span>(age_range <span class="sc">~</span> ecig_30day <span class="sc">+</span> ecig_reg <span class="sc">+</span> less_harm) <span class="sc">|&gt;</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">impute_rhd</span>(ecig_nico <span class="sc">~</span> age_range ) <span class="sc">|&gt;</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">impute_rlm</span>(puff_num <span class="sc">~</span> ecig_30day ) <span class="sc">|&gt;</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">impute_cart</span>(harm_perc <span class="sc">~</span> ecig_reg) <span class="sc">|&gt;</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">impute_cart</span>(price_paid <span class="sc">~</span> ecig_reg <span class="sc">+</span> harm_perc) <span class="sc">|&gt;</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">impute_cart</span>(ecig_flavored <span class="sc">~</span> ecig_reg <span class="sc">+</span> price_paid) <span class="sc">|&gt;</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">impute_cart</span>(ecig_nico <span class="sc">~</span> ecig_reg <span class="sc">+</span> ecig_flavored) <span class="sc">|&gt;</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">impute_pmm</span>(min_num <span class="sc">~</span> ecig_30day <span class="sc">+</span> age_range <span class="sc">+</span> less_harm) <span class="sc">|&gt;</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>data_lin_i <span class="ot">&lt;-</span> data_final_i <span class="sc">|&gt;</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(personid,ecig_30day,puff_num,ecig_nico,age_range,less_harm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The imputed dataset was then checked to see if it was still missing any values.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_summary</span>(data_lin_i) <span class="sc">|&gt;</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n_miss</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pct_miss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">personid</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">ecig_30day</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">puff_num</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">ecig_nico</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age_range</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">less_harm</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="outcome-transformation" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="outcome-transformation"><span class="header-section-number">8.2</span> Outcome Transformation</h2>
<p>The distribution of the outcome variable was plotted.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_lin_i, <span class="fu">aes</span>(<span class="at">x =</span> ecig_30day)) <span class="sc">+</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">15</span>, </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="st">"#2b8cbe"</span>, <span class="at">col =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x =</span> <span class="st">"Number of days used an e-cigarette"</span>, <span class="at">y =</span><span class="st">""</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> </span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_lin_i, <span class="fu">aes</span>(<span class="at">sample =</span> ecig_30day)) <span class="sc">+</span> </span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>(<span class="at">col =</span> <span class="st">"#2b8cbe"</span>) <span class="sc">+</span> <span class="fu">geom_qq_line</span>(<span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Number of days used an e-cigarette"</span>)</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> </span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_lin_i, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> ecig_30day)) <span class="sc">+</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="st">"#2b8cbe"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"#2b8cbe"</span>, <span class="at">width =</span> <span class="fl">0.3</span>,</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Number of days used an e-cigarette"</span>, <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">coord_flip</span>()</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span> p1 <span class="sc">-</span> p3 <span class="sc">+</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">height =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"Distribution of the number of days participants used an e-cigarette in the past 30 days"</span>,</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">glue</span>(<span class="st">"Across "</span>, <span class="fu">nrow</span>(data_lin_i), </span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>                           <span class="st">" participants, taken as a random sample from the DS1001 dataset."</span>),</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"Data taken from the Population Assessment of Tobacco and Health (PATH) Study."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>The outcome variable was modified so that the data would be strictly positive, making it possible to assess the need for transformation. 1 was added to each value.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>data_lin_i <span class="ot">&lt;-</span> data_lin_i <span class="sc">|&gt;</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">int_ecig_30day =</span> ecig_30day <span class="sc">+</span> <span class="dv">1</span>) </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxCox</span>(data_lin_i<span class="sc">$</span>int_ecig_30day <span class="sc">~</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">powerTransform</span>(data_lin_i<span class="sc">$</span>int_ecig_30day <span class="sc">~</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Estimated transformation parameter 
        Y1 
-0.1938334 </code></pre>
</div>
</div>
<p>The Box-Cox plot peaks at a Y value of -0.19, which is approximately close enough to -1 to justify using -1 on Tukey’s ladder of power transformations, which suggests taking the inverse of the outcome.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_lin_i, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(int_ecig_30day))) <span class="sc">+</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">15</span>, </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="st">"#2b8cbe"</span>, <span class="at">col =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x =</span> <span class="st">"Natural Logarithm of the Number of days participant used an e-cigarette"</span>, <span class="at">y =</span><span class="st">""</span>)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> </span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_lin_i, <span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">log</span>(int_ecig_30day))) <span class="sc">+</span> </span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>(<span class="at">col =</span> <span class="st">"#2b8cbe"</span>) <span class="sc">+</span> <span class="fu">geom_qq_line</span>(<span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">str_wrap</span>(<span class="st">"Natural Logarithm of the Number of days participant used an e-cigarette"</span>, <span class="at">width =</span> <span class="dv">50</span>))</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> </span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_lin_i, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">log</span>(int_ecig_30day))) <span class="sc">+</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="st">"#2b8cbe"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"#2b8cbe"</span>, <span class="at">width =</span> <span class="fl">0.3</span>,</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Natural Logarithm of the Number of days participant used an e-cigarette"</span>, <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">coord_flip</span>()</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span> p1 <span class="sc">-</span> p3 <span class="sc">+</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">height =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"Distribution of the natural logarithm of the number of days participants used an e-cigarette in the past 30 days"</span>,</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">glue</span>(<span class="st">"Across "</span>, <span class="fu">nrow</span>(data_lin_i), </span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>                           <span class="st">" participants, taken as a random sample from the DS1001 dataset."</span>),</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"Data taken from the Population Assessment of Tobacco and Health (PATH) Study."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</section>
<section id="scatterplot-matrix-and-collinearity" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="scatterplot-matrix-and-collinearity"><span class="header-section-number">8.3</span> Scatterplot Matrix and Collinearity</h2>
<p>A new variable <code>log_ecig_30day</code> was created by taking the natural logarithm of the outcome variable, which itself was modified by adding 1 to each of it’s values.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>data_lin_i <span class="ot">&lt;-</span> data_lin_i <span class="sc">|&gt;</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_ecig_30day =</span> <span class="fu">log</span>(int_ecig_30day))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The <code>ggpairs</code> function was used to plot a scatterplot matrix.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(data_lin_i, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"puff_num"</span>, <span class="st">"age_range"</span>, <span class="st">"less_harm"</span>, </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"ecig_nico"</span>, <span class="st">"log_ecig_30day"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p><code>mod_A</code> was fit using the <code>lm</code> function. The <code>vif</code> function from the <code>car</code> package was used to estimate if the variables had significant collinearity with each other.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>mod_A_car <span class="ot">&lt;-</span> <span class="fu">lm</span>(ecig_30day <span class="sc">~</span> puff_num <span class="sc">+</span> age_range <span class="sc">+</span> less_harm <span class="sc">+</span> ecig_nico, <span class="at">data =</span> data_lin_i )</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">vif</span>(mod_A_car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              GVIF Df GVIF^(1/(2*Df))
puff_num  1.011415  1        1.005691
age_range 1.045301  5        1.004440
less_harm 1.006246  1        1.003118
ecig_nico 1.044649  1        1.022081</code></pre>
</div>
</div>
<p>From the output, the variables do not seem to have significant collinearity with each other.</p>
</section>
<section id="model-a" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="model-a"><span class="header-section-number">8.4</span> Model A</h2>
<section id="fitting-model-a" class="level3" data-number="8.4.1">
<h3 data-number="8.4.1" class="anchored" data-anchor-id="fitting-model-a"><span class="header-section-number">8.4.1</span> Fitting Model A</h3>
<p>Model A was fit using both <code>lm</code> and <code>ols</code>. The outcome variable is <code>log_ecig_30day</code>, and the predictors are <code>puff_num</code> (A Quantitative variable), <code>age_range</code> (A multi-categorical variable), <code>less_harm</code> and <code>ecig_nico</code>(both binary variables).</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>mod_A <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_ecig_30day <span class="sc">~</span> puff_num <span class="sc">+</span> age_range <span class="sc">+</span> less_harm <span class="sc">+</span> ecig_nico, <span class="at">data =</span> data_lin_i )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">datadist</span>(data_lin_i)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">datadist =</span> <span class="st">"dd"</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>mod_A_ols <span class="ot">&lt;-</span> <span class="fu">ols</span>(log_ecig_30day <span class="sc">~</span> puff_num <span class="sc">+</span> age_range <span class="sc">+</span> less_harm <span class="sc">+</span> ecig_nico, <span class="at">data =</span> data_lin_i, </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x =</span> <span class="cn">TRUE</span>, <span class="at">y =</span> <span class="cn">TRUE</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tidied-coefficient-estimates-model-a" class="level3" data-number="8.4.2">
<h3 data-number="8.4.2" class="anchored" data-anchor-id="tidied-coefficient-estimates-model-a"><span class="header-section-number">8.4.2</span> Tidied Coefficient Estimates (Model A)</h3>
<p>With confidence levels of 90%, the lm model (<code>mod_A</code>) had it’s coefficients tidied and placed in a table that was presented using <code>kable</code>.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(mod_A, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.90</span>) <span class="sc">|&gt;</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, <span class="at">se =</span> std.error, </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">low90 =</span> conf.low, <span class="at">high90 =</span> conf.high, </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">p =</span> p.value) <span class="sc">|&gt;</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">se</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">low90</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">high90</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.980</td>
<td style="text-align: right;">0.138</td>
<td style="text-align: right;">0.753</td>
<td style="text-align: right;">1.207</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">puff_num</td>
<td style="text-align: right;">0.055</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.048</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age_range18to24</td>
<td style="text-align: right;">-0.204</td>
<td style="text-align: right;">0.142</td>
<td style="text-align: right;">-0.437</td>
<td style="text-align: right;">0.030</td>
<td style="text-align: right;">0.151</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_range25to34</td>
<td style="text-align: right;">-0.082</td>
<td style="text-align: right;">0.145</td>
<td style="text-align: right;">-0.320</td>
<td style="text-align: right;">0.157</td>
<td style="text-align: right;">0.574</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age_range35to44</td>
<td style="text-align: right;">-0.169</td>
<td style="text-align: right;">0.151</td>
<td style="text-align: right;">-0.417</td>
<td style="text-align: right;">0.080</td>
<td style="text-align: right;">0.263</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_range45to54</td>
<td style="text-align: right;">-0.040</td>
<td style="text-align: right;">0.152</td>
<td style="text-align: right;">-0.290</td>
<td style="text-align: right;">0.210</td>
<td style="text-align: right;">0.794</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age_range&gt;55</td>
<td style="text-align: right;">0.068</td>
<td style="text-align: right;">0.155</td>
<td style="text-align: right;">-0.187</td>
<td style="text-align: right;">0.324</td>
<td style="text-align: right;">0.660</td>
</tr>
<tr class="even">
<td style="text-align: left;">less_harmNo</td>
<td style="text-align: right;">-0.183</td>
<td style="text-align: right;">0.070</td>
<td style="text-align: right;">-0.298</td>
<td style="text-align: right;">-0.067</td>
<td style="text-align: right;">0.009</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ecig_nicoNo</td>
<td style="text-align: right;">-0.117</td>
<td style="text-align: right;">0.086</td>
<td style="text-align: right;">-0.258</td>
<td style="text-align: right;">0.024</td>
<td style="text-align: right;">0.172</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="summarizing-fit-model-a" class="level3" data-number="8.4.3">
<h3 data-number="8.4.3" class="anchored" data-anchor-id="summarizing-fit-model-a"><span class="header-section-number">8.4.3</span> Summarizing Fit (Model A)</h3>
<p>Using the <code>glance</code> function. the numerical summaries of <code>mod_A</code>’s fit were placed in a table.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(mod_A) <span class="sc">|&gt;</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">r2 =</span> r.squared, <span class="at">adjr2 =</span> adj.r.squared, sigma, </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>         AIC, BIC, nobs, df, df.residual) <span class="sc">|&gt;</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))<span class="sc">|&gt;</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">r2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">adjr2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sigma</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">nobs</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df.residual</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.142</td>
<td style="text-align: right;">0.137</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: right;">3350.3</td>
<td style="text-align: right;">3401.2</td>
<td style="text-align: right;">1200</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1191</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="regression-diagnostics-model-a" class="level3" data-number="8.4.4">
<h3 data-number="8.4.4" class="anchored" data-anchor-id="regression-diagnostics-model-a"><span class="header-section-number">8.4.4</span> Regression Diagnostics (Model A)</h3>
<p>The four main diagnostic residual plots were visualized.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)); <span class="fu">plot</span>(mod_A); <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>From the normal Q-Q plot, there appears to be serious problems with the assumption of normality, despite the transformation of the outcome variable. There is also a definite pattern in the residuals vs fitted values plot, which has implications regarding the assumption of linearity. The scale-location plot also has a definite non-linear pattern, indicating problems with the assumption of constant variance.</p>
</section>
</section>
<section id="non-linearity" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="non-linearity"><span class="header-section-number">8.5</span> Non-Linearity</h2>
<p>Adding a non-linear term to model A might help with the problems visualized with the various assumptions made in a linear regression model. A Spearman <span class="math inline">\(p^2\)</span> plot was made with the predictors in model A.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">spearman2</span>(log_ecig_30day <span class="sc">~</span> puff_num <span class="sc">+</span> age_range <span class="sc">+</span> less_harm <span class="sc">+</span> ecig_nico, <span class="at">data =</span> data_lin_i ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the plot, if a non-linear term were to improve the fit of the model, the predictor most likely to do so would be <code>puff_num</code>, followed much less closely by <code>less_harm</code>.</p>
<p>A restricted cubic spline with 4 knots in <code>puff_num</code> was then added to the model, spending 2 <strong>additional</strong> degrees of freedom as compared to model A (with the main effect of <code>puff_num</code>).</p>
<p>An interaction term between the main effects of <code>puff_num</code> and <code>less_harm</code> was added to the model, spending a <strong>single</strong> additional degree of freedom.</p>
<p>Overall, this would result in 3 additional degrees of freedom being spent.</p>
</section>
<section id="model-b" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="model-b"><span class="header-section-number">8.6</span> Model B</h2>
<section id="fitting-model-b" class="level3" data-number="8.6.1">
<h3 data-number="8.6.1" class="anchored" data-anchor-id="fitting-model-b"><span class="header-section-number">8.6.1</span> Fitting Model B</h3>
<p>Using <code>lm</code> and <code>ols</code>, model B was fit, using a restricted cubic spline on <code>puff_num</code> and an interaction term between the main effects of <code>puff_num</code> and <code>less_harm</code>.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>mod_B <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_ecig_30day <span class="sc">~</span> <span class="fu">rcs</span>(puff_num,<span class="dv">4</span>) <span class="sc">+</span> age_range <span class="sc">+</span> less_harm <span class="sc">+</span> ecig_nico <span class="sc">+</span> puff_num<span class="sc">%ia%</span>less_harm, <span class="at">data =</span> data_lin_i )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">datadist</span>(data_lin_i)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">datadist =</span> <span class="st">"dd"</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>mod_B_ols <span class="ot">&lt;-</span> <span class="fu">ols</span>(log_ecig_30day <span class="sc">~</span> <span class="fu">rcs</span>(puff_num,<span class="dv">4</span>) <span class="sc">+</span> age_range <span class="sc">+</span> less_harm <span class="sc">+</span> ecig_nico <span class="sc">+</span> puff_num<span class="sc">%ia%</span>less_harm, <span class="at">data =</span> data_lin_i,</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x =</span> <span class="cn">TRUE</span>, <span class="at">y =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tidied-coefficient-estimates-model-b" class="level3" data-number="8.6.2">
<h3 data-number="8.6.2" class="anchored" data-anchor-id="tidied-coefficient-estimates-model-b"><span class="header-section-number">8.6.2</span> Tidied Coefficient Estimates (Model B)</h3>
<p><code>mod_B</code> had it’s coefficients tidied with a 90% confidence interval and placed in a tidy table.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(mod_B, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.90</span>) <span class="sc">|&gt;</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, <span class="at">se =</span> std.error, </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">low90 =</span> conf.low, <span class="at">high90 =</span> conf.high, </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">p =</span> p.value) <span class="sc">|&gt;</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">se</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">low90</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">high90</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">3.476</td>
<td style="text-align: right;">0.214</td>
<td style="text-align: right;">3.124</td>
<td style="text-align: right;">3.828</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">rcs(puff_num, 4)puff_num</td>
<td style="text-align: right;">-0.620</td>
<td style="text-align: right;">0.040</td>
<td style="text-align: right;">-0.686</td>
<td style="text-align: right;">-0.554</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rcs(puff_num, 4)puff_num'</td>
<td style="text-align: right;">11.472</td>
<td style="text-align: right;">0.493</td>
<td style="text-align: right;">10.660</td>
<td style="text-align: right;">12.283</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">rcs(puff_num, 4)puff_num''</td>
<td style="text-align: right;">-57.329</td>
<td style="text-align: right;">2.382</td>
<td style="text-align: right;">-61.251</td>
<td style="text-align: right;">-53.408</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age_range18to24</td>
<td style="text-align: right;">-0.103</td>
<td style="text-align: right;">0.112</td>
<td style="text-align: right;">-0.287</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">0.357</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_range25to34</td>
<td style="text-align: right;">0.020</td>
<td style="text-align: right;">0.114</td>
<td style="text-align: right;">-0.169</td>
<td style="text-align: right;">0.208</td>
<td style="text-align: right;">0.863</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age_range35to44</td>
<td style="text-align: right;">-0.060</td>
<td style="text-align: right;">0.119</td>
<td style="text-align: right;">-0.256</td>
<td style="text-align: right;">0.135</td>
<td style="text-align: right;">0.612</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_range45to54</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">0.120</td>
<td style="text-align: right;">-0.173</td>
<td style="text-align: right;">0.222</td>
<td style="text-align: right;">0.838</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age_range&gt;55</td>
<td style="text-align: right;">0.155</td>
<td style="text-align: right;">0.122</td>
<td style="text-align: right;">-0.047</td>
<td style="text-align: right;">0.356</td>
<td style="text-align: right;">0.206</td>
</tr>
<tr class="even">
<td style="text-align: left;">less_harmNo</td>
<td style="text-align: right;">0.144</td>
<td style="text-align: right;">0.114</td>
<td style="text-align: right;">-0.043</td>
<td style="text-align: right;">0.331</td>
<td style="text-align: right;">0.204</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ecig_nicoNo</td>
<td style="text-align: right;">-0.121</td>
<td style="text-align: right;">0.068</td>
<td style="text-align: right;">-0.232</td>
<td style="text-align: right;">-0.009</td>
<td style="text-align: right;">0.076</td>
</tr>
<tr class="even">
<td style="text-align: left;">puff_num %ia% less_harm</td>
<td style="text-align: right;">-0.031</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">-0.054</td>
<td style="text-align: right;">-0.008</td>
<td style="text-align: right;">0.029</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="effects-plot-for-model-b" class="level3" data-number="8.6.3">
<h3 data-number="8.6.3" class="anchored" data-anchor-id="effects-plot-for-model-b"><span class="header-section-number">8.6.3</span> Effects Plot for Model B</h3>
<p>The effects plot for model <code>mod_B_ols</code> was created.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">summary</span>(mod_B_ols))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="summarizing-fit-model-b" class="level3" data-number="8.6.4">
<h3 data-number="8.6.4" class="anchored" data-anchor-id="summarizing-fit-model-b"><span class="header-section-number">8.6.4</span> Summarizing Fit (Model B)</h3>
<p>Using the <code>glance</code> function, the numerical summaries of model B’s fit were placed in a table.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(mod_B) <span class="sc">|&gt;</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">r2 =</span> r.squared, <span class="at">adjr2 =</span> adj.r.squared, sigma, </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>         AIC, BIC, nobs, df, df.residual) <span class="sc">|&gt;</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">|&gt;</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">r2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">adjr2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sigma</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">nobs</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df.residual</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.468</td>
<td style="text-align: right;">0.463</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: right;">2782.8</td>
<td style="text-align: right;">2849</td>
<td style="text-align: right;">1200</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">1188</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="regression-diagnostics-model-b" class="level3" data-number="8.6.5">
<h3 data-number="8.6.5" class="anchored" data-anchor-id="regression-diagnostics-model-b"><span class="header-section-number">8.6.5</span> Regression Diagnostics (Model B)</h3>
<p>The four residual diagnostic plots for model B were obtained.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)); <span class="fu">plot</span>(mod_B); <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>The residual plots are improved from the plots in model A. The q-q plot follows a more normal distribution. The residuals vs fitted values plot shows a more linear line, and the scale-location plot shows a more linear model as well. The assumptions of normality, linearity and constant variance are adhered to more rigorously in the residuals of model B, as compared to model A.</p>
<p>While there are significant outliers in the q-q plot, the residuals vs leverage plot does not show points that have a Cook’s distance of more than 0.5, indicating that these outliers do not exert an undue influence on the model. There are points that have an unusual combination of predictor variables, but their influence on the model is not significant.</p>
</section>
</section>
<section id="validating-models-a-and-b" class="level2" data-number="8.7">
<h2 data-number="8.7" class="anchored" data-anchor-id="validating-models-a-and-b"><span class="header-section-number">8.7</span> Validating Models A and B</h2>
<p>After setting a seed, the <code>data_lin_i</code> dataset was divided into a training and a testing sample. Two models were created, one model with linear terms alone, and the other model with the non-linear terms recommended by the Spearman <span class="math inline">\(p^2\)</span> plot. The coefficients obtained from these models were then used to obtain the predicted <code>log_ecig_30day</code> values in the holdout test sample.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4322023</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>data_lin_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(data_lin_i, <span class="at">prop =</span> <span class="fl">0.7</span>)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>data_lin_train <span class="ot">&lt;-</span> <span class="fu">training</span>(data_lin_split)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>data_lin_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(data_lin_split)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Functions from the <code>yardstick</code> package were used to obtain key summary of fit statistics for both the models’ predictions of the holdout testing sample. The metrics were then placed in a tibble and displayed using kable.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>mod_A_train <span class="ot">&lt;-</span> <span class="fu">ols</span>(log_ecig_30day <span class="sc">~</span> puff_num <span class="sc">+</span> age_range <span class="sc">+</span> less_harm <span class="sc">+</span> ecig_nico, <span class="at">data =</span> data_lin_train)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>mod_B_train <span class="ot">&lt;-</span> <span class="fu">ols</span>(log_ecig_30day <span class="sc">~</span> <span class="fu">rcs</span>(puff_num,<span class="dv">4</span>) <span class="sc">+</span> age_range <span class="sc">+</span> less_harm <span class="sc">+</span> ecig_nico <span class="sc">+</span> puff_num<span class="sc">%ia%</span>less_harm,</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> data_lin_train )</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>mod_A_test_aug <span class="ot">&lt;-</span> <span class="fu">augment</span>(mod_A, <span class="at">newdata =</span> data_lin_test)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>mod_B_test_aug <span class="ot">&lt;-</span> <span class="fu">augment</span>(mod_B, <span class="at">newdata =</span> data_lin_test)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>rep1 <span class="ot">&lt;-</span> <span class="fu">rmse</span>(<span class="at">data =</span> mod_A_test_aug, <span class="at">truth =</span> log_ecig_30day, <span class="at">estimate =</span> .fitted)</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>rep2 <span class="ot">&lt;-</span> <span class="fu">rmse</span>(<span class="at">data =</span> mod_B_test_aug, <span class="at">truth =</span> log_ecig_30day, <span class="at">estimate =</span> .fitted)</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>rep3 <span class="ot">&lt;-</span> <span class="fu">rsq</span>(<span class="at">data =</span> mod_A_test_aug, <span class="at">truth =</span> log_ecig_30day, <span class="at">estimate =</span> .fitted)</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>rep4 <span class="ot">&lt;-</span> <span class="fu">rsq</span>(<span class="at">data =</span> mod_B_test_aug, <span class="at">truth =</span> log_ecig_30day, <span class="at">estimate =</span> .fitted)</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>rep5 <span class="ot">&lt;-</span> <span class="fu">mae</span>(<span class="at">data =</span> mod_A_test_aug, <span class="at">truth =</span> log_ecig_30day, <span class="at">estimate =</span> .fitted)</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>rep6 <span class="ot">&lt;-</span> <span class="fu">mae</span>(<span class="at">data =</span> mod_B_test_aug, <span class="at">truth =</span> log_ecig_30day, <span class="at">estimate =</span> .fitted)</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>rep_full <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(rep1, rep2, rep3, rep4, rep5, rep6)</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>rep_full <span class="ot">&lt;-</span> rep_full <span class="sc">|&gt;</span> </span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Models =</span> <span class="fu">c</span>(<span class="st">"Model A Holdout RMSE"</span>,<span class="st">"Model B Holdout RMSE"</span>,<span class="st">"Model A Holdout $R^2$"</span>,<span class="st">"Model B Holdout $R^2$"</span>,<span class="st">"Model A Holdout MAE"</span>,<span class="st">"Model B Holdout MAE"</span>))</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>rep_full <span class="ot">&lt;-</span> rep_full <span class="sc">|&gt;</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Models, <span class="at">Metric =</span> .metric, <span class="at">Estimate =</span> .estimate)</span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>rep_full <span class="sc">|&gt;</span> <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Models</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Metric</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Model A Holdout RMSE</td>
<td style="text-align: left;">rmse</td>
<td style="text-align: right;">0.9562983</td>
</tr>
<tr class="even">
<td style="text-align: left;">Model B Holdout RMSE</td>
<td style="text-align: left;">rmse</td>
<td style="text-align: right;">0.7614010</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Model A Holdout $R^2$</td>
<td style="text-align: left;">rsq</td>
<td style="text-align: right;">0.1708639</td>
</tr>
<tr class="even">
<td style="text-align: left;">Model B Holdout $R^2$</td>
<td style="text-align: left;">rsq</td>
<td style="text-align: right;">0.4727390</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Model A Holdout MAE</td>
<td style="text-align: left;">mae</td>
<td style="text-align: right;">0.8158778</td>
</tr>
<tr class="even">
<td style="text-align: left;">Model B Holdout MAE</td>
<td style="text-align: left;">mae</td>
<td style="text-align: right;">0.6037231</td>
</tr>
</tbody>
</table>


</div>
</div>
<section id="holdout-rmse-r2-and-mae" class="level3" data-number="8.7.1">
<h3 data-number="8.7.1" class="anchored" data-anchor-id="holdout-rmse-r2-and-mae"><span class="header-section-number">8.7.1</span> Holdout RMSE, <span class="math inline">\(R^2\)</span> and MAE</h3>
<table class="table">
<thead>
<tr class="header">
<th>Model</th>
<th>Holdout RMSE</th>
<th>Holdout <span class="math inline">\(R^2\)</span></th>
<th>Holdout MAE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>0.9563</td>
<td>0.1709</td>
<td>0.8159</td>
</tr>
<tr class="even">
<td>B</td>
<td>0.7614</td>
<td>0.4727</td>
<td>0.5992</td>
</tr>
</tbody>
</table>
</section>
<section id="validated-r2-mse-and-ic-statistics" class="level3" data-number="8.7.2">
<h3 data-number="8.7.2" class="anchored" data-anchor-id="validated-r2-mse-and-ic-statistics"><span class="header-section-number">8.7.2</span> Validated <span class="math inline">\(R^2\)</span>, MSE and IC statistics</h3>
<p>After setting a seed, the validate function was used to obtain the validated R-squared and MSE values for models A and B.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4322023</span>); (valA <span class="ot">&lt;-</span> <span class="fu">validate</span>(mod_A_ols)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          index.orig training   test optimism index.corrected  n
R-square      0.1423   0.1495 0.1330   0.0165          0.1258 40
MSE           0.9393   0.9284 0.9495  -0.0210          0.9603 40
g             0.3083   0.3251 0.3141   0.0110          0.2972 40
Intercept     0.0000   0.0000 0.0266  -0.0266          0.0266 40
Slope         1.0000   1.0000 0.9811   0.0189          0.9811 40</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4322023</span>); (valB <span class="ot">&lt;-</span> <span class="fu">validate</span>(mod_B_ols))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          index.orig training   test optimism index.corrected  n
R-square      0.4682   0.4825 0.4596   0.0229          0.4452 40
MSE           0.5824   0.5647 0.5918  -0.0272          0.6096 40
g             0.7450   0.7545 0.7403   0.0142          0.7308 40
Intercept     0.0000   0.0000 0.0273  -0.0273          0.0273 40
Slope         1.0000   1.0000 0.9757   0.0243          0.9757 40</code></pre>
</div>
</div>
<table class="table">
<thead>
<tr class="header">
<th>Model</th>
<th>Validated <span class="math inline">\(R^2\)</span></th>
<th>Validated MSE</th>
<th>AIC</th>
<th>BIC</th>
<th>DF</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>0.1258</td>
<td>0.9603</td>
<td>3349.8</td>
<td>3400.7</td>
<td>8</td>
</tr>
<tr class="even">
<td>B</td>
<td>0.4452</td>
<td>0.6096</td>
<td>2782.8</td>
<td>2849</td>
<td>11</td>
</tr>
</tbody>
</table>
</section>
<section id="anova-to-compare-models-a-and-b" class="level3" data-number="8.7.3">
<h3 data-number="8.7.3" class="anchored" data-anchor-id="anova-to-compare-models-a-and-b"><span class="header-section-number">8.7.3</span> ANOVA to compare Models A and B</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_A, mod_B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: log_ecig_30day ~ puff_num + age_range + less_harm + ecig_nico
Model 2: log_ecig_30day ~ rcs(puff_num, 4) + age_range + less_harm + ecig_nico + 
    puff_num %ia% less_harm
  Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    
1   1191 1127.17                                  
2   1188  698.93  3    428.24 242.63 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>This ANOVA table shows that model B has 3 additional degrees of freedom as compared to model A, and that adding non linear terms has resulted in a significant improvement in the predictive power of the model.</p>
</section>
</section>
<section id="final-linear-regression-model" class="level2" data-number="8.8">
<h2 data-number="8.8" class="anchored" data-anchor-id="final-linear-regression-model"><span class="header-section-number">8.8</span> Final Linear Regression Model</h2>
<p>I prefer Model <code>B</code>, because:</p>
<ul>
<li><p>Model B has a higher validated <span class="math inline">\(R^2\)</span>, and a higher holdout sample <span class="math inline">\(R^2\)</span>.</p></li>
<li><p>Model B has a lower validated MSE (Mean Squared Error) and a lower holdout RMSE.</p></li>
<li><p>Model B has a lower holdout MAE, and a lower AIC and BIC.</p></li>
<li><p>Model B’s residual plots show that the assumptions of linearity, normality and non-heteroscedasticity are not violated.</p></li>
</ul>
<section id="winning-models-parameter-estimates" class="level3" data-number="8.8.1">
<h3 data-number="8.8.1" class="anchored" data-anchor-id="winning-models-parameter-estimates"><span class="header-section-number">8.8.1</span> Winning Model’s Parameter Estimates</h3>
<p>The model B’s raw and adjusted <span class="math inline">\(R^2\)</span> were obtained.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>mod_B_ols</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear Regression Model

ols(formula = log_ecig_30day ~ rcs(puff_num, 4) + age_range + 
    less_harm + ecig_nico + puff_num %ia% less_harm, data = data_lin_i, 
    x = TRUE, y = TRUE)

                Model Likelihood    Discrimination    
                      Ratio Test           Indexes    
Obs    1200    LR chi2    757.68    R2       0.468    
sigma0.7670    d.f.           11    R2 adj   0.463    
d.f.   1188    Pr(&gt; chi2) 0.0000    g        0.745    

Residuals

     Min       1Q   Median       3Q      Max 
-3.17538 -0.63628  0.04184  0.48501  2.62802 

                        Coef     S.E.   t      Pr(&gt;|t|)
Intercept                 3.4764 0.2139  16.26 &lt;0.0001 
puff_num                 -0.6200 0.0398 -15.57 &lt;0.0001 
puff_num'                11.4717 0.4931  23.26 &lt;0.0001 
puff_num''              -57.3292 2.3822 -24.07 &lt;0.0001 
age_range=18to24         -0.1032 0.1119  -0.92 0.3568  
age_range=25to34          0.0197 0.1143   0.17 0.8635  
age_range=35to44         -0.0605 0.1190  -0.51 0.6115  
age_range=45to54          0.0246 0.1199   0.20 0.8377  
age_range=&gt;55             0.1549 0.1224   1.27 0.2059  
less_harm=No              0.1445 0.1136   1.27 0.2037  
ecig_nico=No             -0.1206 0.0678  -1.78 0.0756  
puff_num * less_harm=No  -0.0309 0.0141  -2.19 0.0290  </code></pre>
</div>
</div>
</section>
<section id="model-coefficients" class="level3" data-number="8.8.2">
<h3 data-number="8.8.2" class="anchored" data-anchor-id="model-coefficients"><span class="header-section-number">8.8.2</span> Model Coefficients</h3>
<p>Model B’s coefficients were obtained with 90% confidence intervals and presented using kable.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>tidy_mod_B <span class="ot">&lt;-</span> <span class="fu">tidy</span>(mod_B, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.90</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>tidy_mod_B <span class="sc">|&gt;</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">digits =</span> <span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>, <span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">3.4764</td>
<td style="text-align: right;">0.2139</td>
<td style="text-align: right;">16.2554</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">3.1243</td>
<td style="text-align: right;">3.8284</td>
</tr>
<tr class="even">
<td style="text-align: left;">rcs(puff_num, 4)puff_num</td>
<td style="text-align: right;">-0.6200</td>
<td style="text-align: right;">0.0398</td>
<td style="text-align: right;">-15.5677</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.6855</td>
<td style="text-align: right;">-0.5544</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rcs(puff_num, 4)puff_num'</td>
<td style="text-align: right;">11.4717</td>
<td style="text-align: right;">0.4931</td>
<td style="text-align: right;">23.2637</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">10.6599</td>
<td style="text-align: right;">12.2834</td>
</tr>
<tr class="even">
<td style="text-align: left;">rcs(puff_num, 4)puff_num''</td>
<td style="text-align: right;">-57.3292</td>
<td style="text-align: right;">2.3822</td>
<td style="text-align: right;">-24.0658</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-61.2506</td>
<td style="text-align: right;">-53.4078</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age_range18to24</td>
<td style="text-align: right;">-0.1032</td>
<td style="text-align: right;">0.1119</td>
<td style="text-align: right;">-0.9219</td>
<td style="text-align: right;">0.3568</td>
<td style="text-align: right;">-0.2874</td>
<td style="text-align: right;">0.0811</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_range25to34</td>
<td style="text-align: right;">0.0197</td>
<td style="text-align: right;">0.1143</td>
<td style="text-align: right;">0.1720</td>
<td style="text-align: right;">0.8635</td>
<td style="text-align: right;">-0.1685</td>
<td style="text-align: right;">0.2079</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age_range35to44</td>
<td style="text-align: right;">-0.0605</td>
<td style="text-align: right;">0.1190</td>
<td style="text-align: right;">-0.5080</td>
<td style="text-align: right;">0.6115</td>
<td style="text-align: right;">-0.2564</td>
<td style="text-align: right;">0.1355</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_range45to54</td>
<td style="text-align: right;">0.0246</td>
<td style="text-align: right;">0.1199</td>
<td style="text-align: right;">0.2048</td>
<td style="text-align: right;">0.8377</td>
<td style="text-align: right;">-0.1728</td>
<td style="text-align: right;">0.2219</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age_range&gt;55</td>
<td style="text-align: right;">0.1549</td>
<td style="text-align: right;">0.1224</td>
<td style="text-align: right;">1.2655</td>
<td style="text-align: right;">0.2059</td>
<td style="text-align: right;">-0.0466</td>
<td style="text-align: right;">0.3564</td>
</tr>
<tr class="even">
<td style="text-align: left;">less_harmNo</td>
<td style="text-align: right;">0.1445</td>
<td style="text-align: right;">0.1136</td>
<td style="text-align: right;">1.2718</td>
<td style="text-align: right;">0.2037</td>
<td style="text-align: right;">-0.0425</td>
<td style="text-align: right;">0.3314</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ecig_nicoNo</td>
<td style="text-align: right;">-0.1206</td>
<td style="text-align: right;">0.0678</td>
<td style="text-align: right;">-1.7783</td>
<td style="text-align: right;">0.0756</td>
<td style="text-align: right;">-0.2322</td>
<td style="text-align: right;">-0.0090</td>
</tr>
<tr class="even">
<td style="text-align: left;">puff_num %ia% less_harm</td>
<td style="text-align: right;">-0.0309</td>
<td style="text-align: right;">0.0141</td>
<td style="text-align: right;">-2.1867</td>
<td style="text-align: right;">0.0290</td>
<td style="text-align: right;">-0.0541</td>
<td style="text-align: right;">-0.0076</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">Predict</span>(mod_B_ols))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The coefficients for the non-linear term are significantly larger than expected. Given that the outcome of interest is a count outcome, and the predictor (<code>puff_num</code>) has a very intuitive relationship with the outcome variable, in that individuals who have a zero for their outcome (<code>ecig_30day</code>) could be expected to have significantly lower (or even zero) values of <code>puff_num</code>, and individuals with any particular value of <code>puff_num</code> would have a collinear relationship with the outcome variable. It can be reasonably expected that the model is being driven significantly towards a particular value of <code>log_ecig_30day</code>, which could result in the exploding coefficients seen in the table of coefficients.</p>
<p>This indicates that model B is not the ideal sort of model to be used for a count outcome like <code>ecig_30day</code>.</p>
<p>Following this, the validated <span class="math inline">\(R^2\)</span> was also obtained, along with the validated MSE.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4322023</span>); (valB_imp <span class="ot">&lt;-</span> <span class="fu">validate</span>(mod_B_ols))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          index.orig training   test optimism index.corrected  n
R-square      0.4682   0.4825 0.4596   0.0229          0.4452 40
MSE           0.5824   0.5647 0.5918  -0.0272          0.6096 40
g             0.7450   0.7545 0.7403   0.0142          0.7308 40
Intercept     0.0000   0.0000 0.0273  -0.0273          0.0273 40
Slope         1.0000   1.0000 0.9757   0.0243          0.9757 40</code></pre>
</div>
</div>
<p>An ANOVA test performed on <code>mod_B_ols</code> shows that a non linear term (a restricted cubic spline with 4 knots) on <code>puff_num</code> had significant impact on the predictive ability of model B, along with the interaction term between the main effect of <code>puff_num</code> and <code>less_harm</code>.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_B_ols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                Analysis of Variance          Response: log_ecig_30day 

 Factor                                              d.f. Partial SS
 puff_num  (Factor+Higher Order Factors)                4 589.511975
  All Interactions                                      1   2.813085
  Nonlinear                                             2 425.614545
 age_range                                              5   8.073412
 less_harm  (Factor+Higher Order Factors)               2   3.811854
  All Interactions                                      1   2.813085
 ecig_nico                                              1   1.860506
 puff_num * less_harm  (Factor+Higher Order Factors)    1   2.813085
 TOTAL NONLINEAR + INTERACTION                          3 428.235704
 REGRESSION                                            11 615.229768
 ERROR                                               1188 698.931962
 MS          F      P     
 147.3779937 250.50 &lt;.0001
   2.8130849   4.78 0.0290
 212.8072723 361.72 &lt;.0001
   1.6146824   2.74 0.0179
   1.9059270   3.24 0.0395
   2.8130849   4.78 0.0290
   1.8605056   3.16 0.0756
   2.8130849   4.78 0.0290
 142.7452346 242.63 &lt;.0001
  55.9299789  95.07 &lt;.0001
   0.5883266              </code></pre>
</div>
</div>
<p>The ANOVA table shows that model B has 12 total degrees of freedom, with 4 non-linear terms of freedom.</p>
<table class="table">
<thead>
<tr class="header">
<th>Metric</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Raw <span class="math inline">\(R^2\)</span></td>
<td>0.468</td>
</tr>
<tr class="even">
<td>Adjusted <span class="math inline">\(R^2\)</span></td>
<td>0.463</td>
</tr>
<tr class="odd">
<td>Validated <span class="math inline">\(R^2\)</span></td>
<td>0.4452</td>
</tr>
<tr class="even">
<td>AIC</td>
<td>2782.8</td>
</tr>
<tr class="odd">
<td>BIC</td>
<td>2849</td>
</tr>
<tr class="even">
<td>Validated MSE (Mean Squared Error)</td>
<td>0.6096</td>
</tr>
</tbody>
</table>
</section>
<section id="effects-plot-for-winning-model" class="level3" data-number="8.8.3">
<h3 data-number="8.8.3" class="anchored" data-anchor-id="effects-plot-for-winning-model"><span class="header-section-number">8.8.3</span> Effects Plot for Winning Model</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_B_ols, <span class="at">conf.int =</span> <span class="fl">0.90</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             Effects              Response : log_ecig_30day 

 Factor                    Low    High   Diff.  Effect    S.E.     Lower 0.9
 puff_num                  5.7586 7.0476 1.2889  0.596830 0.021791  0.560960
 age_range - &lt;18:18to24    2.0000 1.0000     NA  0.103180 0.111920 -0.081062
 age_range - 25to34:18to24 2.0000 3.0000     NA  0.122840 0.061711  0.021257
 age_range - 35to44:18to24 2.0000 4.0000     NA  0.042718 0.069549 -0.071770
 age_range - 45to54:18to24 2.0000 5.0000     NA  0.127730 0.071094  0.010703
 age_range - &gt;55:18to24    2.0000 6.0000     NA  0.258070 0.075061  0.134510
 less_harm - No:Yes        1.0000 2.0000     NA -0.041346 0.057248 -0.135580
 ecig_nico - No:Yes        1.0000 2.0000     NA -0.120600 0.067818 -0.232240
 Upper 0.9 
  0.6327000
  0.2874200
  0.2244300
  0.1572000
  0.2447600
  0.3816300
  0.0528930
 -0.0089634

Adjusted to: puff_num=6.016428 less_harm=Yes  </code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">summary</span>(mod_B_ols, <span class="at">conf.int =</span> <span class="fl">0.90</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the summary above, for the <code>puff_num</code> coefficient, in model <code>mod_b_ols</code>,</p>
<p>We can conclude that the estimated effect of moving <code>puff_num</code> from 5.76 to 7.05 results in an increase of 0.597 in <code>log_ecig_30day</code>, with 90% confidence intervals of 0.595 to 0.733. IE, for model B,</p>
<p><strong>As an individual’s number of e-cigarette puffs taken the last time they smoked an e-cigarette increases from 5.76 to 7.05, the predicted logarithm of the number of days they smoked an e-cigarette in the past 30 days (plus one day) increases by 0.597, with 90% CI(0.561 to 0.633), provided the individual’s age when they began smoking, their perception of the harmfulness of e-cigarettes, and their use or lack thereof of nicotine containing e-cigarettes are all held constant.</strong></p>
<p>Given that this confidence interval does not include 0, this is a scientifically meaningful effect.</p>
</section>
<section id="model-calibration" class="level3" data-number="8.8.4">
<h3 data-number="8.8.4" class="anchored" data-anchor-id="model-calibration"><span class="header-section-number">8.8.4</span> Model Calibration</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4322023</span>); <span class="fu">plot</span>(<span class="fu">calibrate</span>(mod_B_ols))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
n=1200   Mean absolute error=0.222   Mean squared error=0.06564
0.9 Quantile of absolute error=0.364</code></pre>
</div>
</div>
<p>The model does not appear to be particularly well calibrated. It under-predicts at the high and low ends of the actual <code>log_ecig_30day</code> values, and over-predicts elsewhere.</p>
</section>
<section id="numerical-description-of-effect-sizes" class="level3" data-number="8.8.5">
<h3 data-number="8.8.5" class="anchored" data-anchor-id="numerical-description-of-effect-sizes"><span class="header-section-number">8.8.5</span> Numerical Description of Effect Sizes</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_B_ols, <span class="at">conf.int =</span> <span class="fl">0.90</span>) <span class="sc">|&gt;</span> <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>, <span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">High</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Diff.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Effect</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">S.E.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Lower 0.9</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Upper 0.9</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">puff_num</td>
<td style="text-align: right;">5.759</td>
<td style="text-align: right;">7.048</td>
<td style="text-align: right;">1.289</td>
<td style="text-align: right;">0.597</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.561</td>
<td style="text-align: right;">0.633</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_range - &lt;18:18to24</td>
<td style="text-align: right;">2.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.103</td>
<td style="text-align: right;">0.112</td>
<td style="text-align: right;">-0.081</td>
<td style="text-align: right;">0.287</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age_range - 25to34:18to24</td>
<td style="text-align: right;">2.000</td>
<td style="text-align: right;">3.000</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.123</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.224</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_range - 35to44:18to24</td>
<td style="text-align: right;">2.000</td>
<td style="text-align: right;">4.000</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.043</td>
<td style="text-align: right;">0.070</td>
<td style="text-align: right;">-0.072</td>
<td style="text-align: right;">0.157</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age_range - 45to54:18to24</td>
<td style="text-align: right;">2.000</td>
<td style="text-align: right;">5.000</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.128</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">0.011</td>
<td style="text-align: right;">0.245</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_range - &gt;55:18to24</td>
<td style="text-align: right;">2.000</td>
<td style="text-align: right;">6.000</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.258</td>
<td style="text-align: right;">0.075</td>
<td style="text-align: right;">0.135</td>
<td style="text-align: right;">0.382</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">less_harm - No:Yes</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">2.000</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">-0.041</td>
<td style="text-align: right;">0.057</td>
<td style="text-align: right;">-0.136</td>
<td style="text-align: right;">0.053</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">ecig_nico - No:Yes</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">2.000</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">-0.121</td>
<td style="text-align: right;">0.068</td>
<td style="text-align: right;">-0.232</td>
<td style="text-align: right;">-0.009</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><strong><code>puff_num</code></strong> description :</p>
<p>For two subjects with the same age range at which they started smoking e-cigarettes, the same perception of the harmfulness of e-cigarettes, the same kind of usage or lack thereof of e-cigarettes containing nicotine, and if one subject took 5.76 e-cigarette puffs the last time they smoked an e-cigarette, and the other took 7.05 e-cigarettes puffs 7.05 the last time they smoked an e-cigarette, the model estimates that subject 1 will have a log(number of days smoked in the past 30 days + 1) value <strong>0.597 units higher</strong> than subject 2’s log(number of days smoked in the past 30 days + 1). The 90% confidence interval for that estimate ranges from 0.561 to 0.633.</p>
</section>
<section id="nomogram-of-winning-model" class="level3" data-number="8.8.6">
<h3 data-number="8.8.6" class="anchored" data-anchor-id="nomogram-of-winning-model"><span class="header-section-number">8.8.6</span> Nomogram of Winning Model</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">nomogram</span>(mod_B_ols))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="prediction-for-a-new-subject" class="level3" data-number="8.8.7">
<h3 data-number="8.8.7" class="anchored" data-anchor-id="prediction-for-a-new-subject"><span class="header-section-number">8.8.7</span> Prediction for a New Subject</h3>
<p>A new theoretical subject, who took 5 puffs from an e-cigarette the last time they smoked an e-cigarette, who started smoking e-cigarettes when they were under 18, who uses e-cigarettes because they thought e-cigarettes might be less harmful to them than regular cigarettes, who usually uses an e-cigarette containing nicotine, was created. Their predicted <code>log_ecig_30day</code> value was then obtained and exponentiated. 1 was added to the exponentiated value to complete the transformation back into the original value.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod_B_ols, <span class="fu">expand.grid</span>(<span class="at">puff_num =</span> <span class="dv">7</span>, <span class="at">age_range =</span> <span class="st">"&lt;18"</span>,</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">less_harm =</span> <span class="st">"Yes"</span>, <span class="at">ecig_nico =</span> <span class="st">"Yes"</span>),</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="at">conf.int =</span> <span class="fl">0.90</span>, <span class="at">conf.type =</span> <span class="st">"individual"</span>) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">point_estimate =</span> (<span class="fu">exp</span>(linear.predictors) <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower_orig =</span> (<span class="fu">exp</span>(lower) <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">upper_orig =</span> (<span class="fu">exp</span>(upper) <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(point_estimate,lower_orig,upper_orig)</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>preds <span class="sc">|&gt;</span> <span class="fu">kable</span>() <span class="sc">|&gt;</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">point_estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower_orig</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper_orig</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2.720541</td>
<td style="text-align: right;">0.040103</td>
<td style="text-align: right;">12.3087</td>
</tr>
</tbody>
</table>


</div>
</div>
<table class="table">
<colgroup>
<col style="width: 52%">
<col style="width: 22%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Predictor Values</th>
<th>Predicted days participant used an e-cigarette in the past 30 days</th>
<th>90% Confidence Interval</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>puff_num = 7, age_range = “&lt;18”,less_harm = “Yes”, ecig_nico = “Yes”</td>
<td>2.72</td>
<td>0.04 to 12.31</td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="logistic-regression-analyses" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Logistic Regression Analyses</h1>
<section id="missingness-1" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="missingness-1"><span class="header-section-number">9.1</span> Missingness</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>data_log <span class="sc">|&gt;</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">miss_var_summary</span>() <span class="sc">|&gt;</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n_miss</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pct_miss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">min_num</td>
<td style="text-align: right;">853</td>
<td style="text-align: right;">71.08333</td>
</tr>
<tr class="even">
<td style="text-align: left;">ecig_nico</td>
<td style="text-align: right;">832</td>
<td style="text-align: right;">69.33333</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ecig_flavored</td>
<td style="text-align: right;">831</td>
<td style="text-align: right;">69.25000</td>
</tr>
<tr class="even">
<td style="text-align: left;">price_paid</td>
<td style="text-align: right;">393</td>
<td style="text-align: right;">32.75000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">harm_perc</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">1.00000</td>
</tr>
<tr class="even">
<td style="text-align: left;">personid</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ecig_reg</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00000</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>There is missing data in all of the variables under study, and the outcome variable <code>ecig_reg</code> does not have any missing values. There are missing predictor values for more than 10% of the subjects under study, and more than 50 subjects have missing values.</p>
<p>The data can be assumed to be MAR (Missing At Random), since the missing data are not randomly distributed. It cannot be assumed to be MNAR (Missing Not At Random) since there does not appear to be a relationship between the magnitude of a value and it’s missingness (or inclusion in the non-missing data), since there is no preponderance of values with lower or higher magnitude being missing.</p>
<p>Single imputation was already performed on the complete dataset, to account for missingness. The logistic regression dataset was selected.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>data_log_i <span class="ot">&lt;-</span> data_final_i <span class="sc">|&gt;</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(personid,ecig_reg,harm_perc,price_paid,ecig_flavored,ecig_nico,min_num)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_summary</span>(data_log_i)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
  variable      n_miss pct_miss
  &lt;chr&gt;          &lt;int&gt;    &lt;dbl&gt;
1 personid           0        0
2 ecig_reg           0        0
3 harm_perc          0        0
4 price_paid         0        0
5 ecig_flavored      0        0
6 ecig_nico          0        0
7 min_num            0        0</code></pre>
</div>
</div>
<p>There are no missing predictor variables in the logistic regression dataset after performing single imputation.</p>
</section>
<section id="model-y" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="model-y"><span class="header-section-number">9.2</span> Model Y</h2>
<section id="fitting-model-y" class="level3" data-number="9.2.1">
<h3 data-number="9.2.1" class="anchored" data-anchor-id="fitting-model-y"><span class="header-section-number">9.2.1</span> Fitting Model Y</h3>
<p>Model Y was fit with both <code>lrm</code> and <code>glm</code>. <code>ecig_reg</code> was the outcome variable, and the predictors were <code>min_num</code>, <code>ecig_nico</code>, <code>harm_perc</code> and <code>price_paid</code>.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>mod_Y <span class="ot">&lt;-</span> <span class="fu">glm</span>(ecig_reg <span class="sc">~</span> min_num <span class="sc">+</span> ecig_nico <span class="sc">+</span> ecig_flavored <span class="sc">+</span> harm_perc <span class="sc">+</span> price_paid,</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> data_log_i, <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>ddd <span class="ot">&lt;-</span> <span class="fu">datadist</span>(data_log_i)</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">datadist =</span> <span class="st">"ddd"</span>)</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>mod_Y_lrm <span class="ot">&lt;-</span> <span class="fu">lrm</span>(ecig_reg <span class="sc">~</span> min_num <span class="sc">+</span> ecig_nico <span class="sc">+</span> ecig_flavored <span class="sc">+</span> harm_perc <span class="sc">+</span> price_paid,</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> data_log_i, <span class="at">x =</span> <span class="cn">TRUE</span>, <span class="at">y =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tidied-odds-ratio-estimates-model-y" class="level3" data-number="9.2.2">
<h3 data-number="9.2.2" class="anchored" data-anchor-id="tidied-odds-ratio-estimates-model-y"><span class="header-section-number">9.2.2</span> Tidied Odds Ratio Estimates (Model Y)</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(mod_Y, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>) <span class="sc">|&gt;</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, <span class="at">se =</span> std.error, </span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">low95 =</span> conf.low, <span class="at">high95 =</span> conf.high, <span class="at">p =</span> p.value) <span class="sc">|&gt;</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">se</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">low95</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">high95</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">18.682</td>
<td style="text-align: right;">0.314</td>
<td style="text-align: right;">10.250</td>
<td style="text-align: right;">35.172</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">min_num</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">0.999</td>
<td style="text-align: right;">1.001</td>
<td style="text-align: right;">0.733</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ecig_nicoNo</td>
<td style="text-align: right;">0.927</td>
<td style="text-align: right;">0.198</td>
<td style="text-align: right;">0.632</td>
<td style="text-align: right;">1.375</td>
<td style="text-align: right;">0.700</td>
</tr>
<tr class="even">
<td style="text-align: left;">ecig_flavoredNo</td>
<td style="text-align: right;">0.116</td>
<td style="text-align: right;">0.248</td>
<td style="text-align: right;">0.070</td>
<td style="text-align: right;">0.186</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">harm_percsame_or_more</td>
<td style="text-align: right;">1.196</td>
<td style="text-align: right;">0.164</td>
<td style="text-align: right;">0.869</td>
<td style="text-align: right;">1.653</td>
<td style="text-align: right;">0.274</td>
</tr>
<tr class="even">
<td style="text-align: left;">price_paid$10to$20</td>
<td style="text-align: right;">0.230</td>
<td style="text-align: right;">0.299</td>
<td style="text-align: right;">0.126</td>
<td style="text-align: right;">0.409</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">price_paid$21to$100</td>
<td style="text-align: right;">0.117</td>
<td style="text-align: right;">0.293</td>
<td style="text-align: right;">0.065</td>
<td style="text-align: right;">0.204</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">price_paid&gt;$100</td>
<td style="text-align: right;">0.055</td>
<td style="text-align: right;">0.479</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.140</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="effects-plot-model-y" class="level3" data-number="9.2.3">
<h3 data-number="9.2.3" class="anchored" data-anchor-id="effects-plot-model-y"><span class="header-section-number">9.2.3</span> Effects Plot (Model Y)</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">summary</span>(mod_Y_lrm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="summarizing-fit-model-y" class="level3" data-number="9.2.4">
<h3 data-number="9.2.4" class="anchored" data-anchor-id="summarizing-fit-model-y"><span class="header-section-number">9.2.4</span> Summarizing Fit (Model Y)</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>mod_Y_lrm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Logistic Regression Model

lrm(formula = ecig_reg ~ min_num + ecig_nico + ecig_flavored + 
    harm_perc + price_paid, data = data_log_i, x = TRUE, y = TRUE)

                       Model Likelihood      Discrimination    Rank Discrim.    
                             Ratio Test             Indexes          Indexes    
Obs          1200    LR chi2     129.72      R2       0.145    C       0.630    
 Yes          369    d.f.             7     R2(7,1200)0.097    Dxy     0.261    
 No           831    Pr(&gt; chi2) &lt;0.0001    R2(7,766.6)0.148    gamma   0.264    
max |deriv| 1e-07                            Brier    0.181    tau-a   0.111    

                       Coef    S.E.   Wald Z Pr(&gt;|Z|)
Intercept               2.9276 0.3140  9.32  &lt;0.0001 
min_num                -0.0002 0.0006 -0.34  0.7335  
ecig_nico=No           -0.0762 0.1979 -0.39  0.7001  
ecig_flavored=No       -2.1513 0.2479 -8.68  &lt;0.0001 
harm_perc=same_or_more  0.1790 0.1638  1.09  0.2743  
price_paid=$10to$20    -1.4684 0.2994 -4.91  &lt;0.0001 
price_paid=$21to$100   -2.1453 0.2925 -7.33  &lt;0.0001 
price_paid=&gt;$100       -2.8969 0.4788 -6.05  &lt;0.0001 </code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(mod_Y) <span class="sc">|&gt;</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">df =</span> nobs <span class="sc">-</span> df.residual <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(AIC, BIC, df, df.residual, nobs) <span class="sc">|&gt;</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">1</span>)<span class="sc">|&gt;</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">AIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df.residual</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1367.3</td>
<td style="text-align: right;">1408</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">1192</td>
<td style="text-align: right;">1200</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="confusion-matrix-model-y" class="level3" data-number="9.2.5">
<h3 data-number="9.2.5" class="anchored" data-anchor-id="confusion-matrix-model-y"><span class="header-section-number">9.2.5</span> Confusion Matrix (Model Y)</h3>
<p>A temporary dataset, log_i_temp, for the putpose of generating a confusion matrix, was created. The outcome variable <code>ecig_reg</code> had it’s levels changed from “Yes” and “No” to 1 and 0.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>log_i_temp <span class="ot">&lt;-</span> data_log_i <span class="sc">|&gt;</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ecig_reg =</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(ecig_reg <span class="sc">==</span> <span class="st">"Yes"</span>,<span class="dv">1</span>,<span class="dv">0</span>)))</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>mod_Y_cm <span class="ot">&lt;-</span> <span class="fu">glm</span>(ecig_reg <span class="sc">~</span> min_num <span class="sc">+</span> ecig_nico <span class="sc">+</span> ecig_flavored <span class="sc">+</span> harm_perc <span class="sc">+</span> price_paid,</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> log_i_temp, <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>resY_aug <span class="ot">&lt;-</span> <span class="fu">augment</span>(mod_Y_cm, <span class="at">type.predict =</span> <span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>My prediction rule is that the fitted value of pr(ecig_reg = 1) needs to be greater than or equal to 0.5 for me to predict that <code>ecig_reg</code> is 1.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>cm_Y <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">factor</span>(resY_aug<span class="sc">$</span>.fitted <span class="sc">&gt;=</span> <span class="fl">0.5</span>),</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">reference =</span> <span class="fu">factor</span>(resY_aug<span class="sc">$</span>ecig_reg <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">positive =</span> <span class="st">"TRUE"</span>)</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>cm_Y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction FALSE TRUE
     FALSE   826  274
     TRUE      5   95
                                          
               Accuracy : 0.7675          
                 95% CI : (0.7425, 0.7911)
    No Information Rate : 0.6925          
    P-Value [Acc &gt; NIR] : 4.676e-09       
                                          
                  Kappa : 0.3153          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.25745         
            Specificity : 0.99398         
         Pos Pred Value : 0.95000         
         Neg Pred Value : 0.75091         
             Prevalence : 0.30750         
         Detection Rate : 0.07917         
   Detection Prevalence : 0.08333         
      Balanced Accuracy : 0.62572         
                                          
       'Positive' Class : TRUE            
                                          </code></pre>
</div>
</div>
</section>
</section>
<section id="non-linearity-1" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="non-linearity-1"><span class="header-section-number">9.3</span> Non-Linearity</h2>
<p>A Spearman <span class="math inline">\(p^2\)</span> plot was created for assessing the terms that are most likely to add predictive power to the model.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">spearman2</span>(ecig_reg <span class="sc">~</span> min_num <span class="sc">+</span> ecig_nico <span class="sc">+</span> ecig_flavored <span class="sc">+</span> harm_perc <span class="sc">+</span> price_paid,</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> data_log_i))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The Spearman plot suggests the use of a non-linear term in <code>min_num</code>, so a restricted cubic spline with 4 knots in <code>min_num</code> will be added to the model, spending <em>two additional degrees of freedom</em> than the main effects model.</p>
<p>An interaction term between the main effect of <code>ecig_flavored</code> and <code>min_num</code> will be added, spending <em>an additional degree of freedom</em>.</p>
</section>
<section id="model-z" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="model-z"><span class="header-section-number">9.4</span> Model Z</h2>
<p>Model Z will add a total of 3 additional degrees of freedom to Model Y, using two non-linear terms.</p>
<section id="fitting-model-z" class="level3" data-number="9.4.1">
<h3 data-number="9.4.1" class="anchored" data-anchor-id="fitting-model-z"><span class="header-section-number">9.4.1</span> Fitting Model Z</h3>
<p>Model Z was fit using both <code>glm</code> and <code>lrm</code>.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>mod_Z <span class="ot">&lt;-</span> <span class="fu">glm</span>(ecig_reg <span class="sc">~</span> ecig_nico <span class="sc">+</span> <span class="fu">rcs</span>(min_num,<span class="dv">4</span>) <span class="sc">+</span> ecig_flavored <span class="sc">+</span> harm_perc <span class="sc">+</span> price_paid <span class="sc">+</span> ecig_flavored <span class="sc">%ia%</span> min_num,</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> data_log_i, <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>ddd <span class="ot">&lt;-</span> <span class="fu">datadist</span>(data_log_i)</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">datadist =</span> <span class="st">"ddd"</span>)</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>mod_Z_lrm <span class="ot">&lt;-</span> <span class="fu">lrm</span>(ecig_reg <span class="sc">~</span> <span class="fu">rcs</span>(min_num,<span class="dv">4</span>) <span class="sc">+</span> ecig_nico <span class="sc">+</span> ecig_flavored <span class="sc">+</span> harm_perc <span class="sc">+</span> price_paid <span class="sc">+</span> ecig_flavored <span class="sc">%ia%</span> min_num,</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> data_log_i, <span class="at">x =</span> <span class="cn">TRUE</span>, <span class="at">y =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tidied-odds-ratio-estimates-model-z" class="level3" data-number="9.4.2">
<h3 data-number="9.4.2" class="anchored" data-anchor-id="tidied-odds-ratio-estimates-model-z"><span class="header-section-number">9.4.2</span> Tidied Odds Ratio Estimates (Model Z)</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(mod_Z, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.90</span>) <span class="sc">|&gt;</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, <span class="at">se =</span> std.error, </span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">low90 =</span> conf.low, <span class="at">high90 =</span> conf.high, <span class="at">p =</span> p.value) <span class="sc">|&gt;</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)<span class="sc">|&gt;</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">se</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">low90</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">high90</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.726</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">0.065</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">ecig_nicoNo</td>
<td style="text-align: right;">0.796</td>
<td style="text-align: right;">0.277</td>
<td style="text-align: right;">0.510</td>
<td style="text-align: right;">1.271</td>
<td style="text-align: right;">0.412</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rcs(min_num, 4)min_num</td>
<td style="text-align: right;">1.104</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">1.088</td>
<td style="text-align: right;">1.121</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">rcs(min_num, 4)min_num'</td>
<td style="text-align: right;">0.843</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.814</td>
<td style="text-align: right;">0.871</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rcs(min_num, 4)min_num''</td>
<td style="text-align: right;">1.538</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">1.349</td>
<td style="text-align: right;">1.760</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">ecig_flavoredNo</td>
<td style="text-align: right;">0.048</td>
<td style="text-align: right;">0.715</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.151</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">harm_percsame_or_more</td>
<td style="text-align: right;">1.589</td>
<td style="text-align: right;">0.254</td>
<td style="text-align: right;">1.052</td>
<td style="text-align: right;">2.429</td>
<td style="text-align: right;">0.068</td>
</tr>
<tr class="even">
<td style="text-align: left;">price_paid$10to$20</td>
<td style="text-align: right;">0.111</td>
<td style="text-align: right;">0.432</td>
<td style="text-align: right;">0.054</td>
<td style="text-align: right;">0.224</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">price_paid$21to$100</td>
<td style="text-align: right;">0.057</td>
<td style="text-align: right;">0.424</td>
<td style="text-align: right;">0.028</td>
<td style="text-align: right;">0.113</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">price_paid&gt;$100</td>
<td style="text-align: right;">0.035</td>
<td style="text-align: right;">0.709</td>
<td style="text-align: right;">0.011</td>
<td style="text-align: right;">0.112</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ecig_flavored %ia% min_num</td>
<td style="text-align: right;">1.003</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.997</td>
<td style="text-align: right;">1.009</td>
<td style="text-align: right;">0.446</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="effects-plot-model-z" class="level3" data-number="9.4.3">
<h3 data-number="9.4.3" class="anchored" data-anchor-id="effects-plot-model-z"><span class="header-section-number">9.4.3</span> Effects Plot (Model Z)</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">summary</span>(mod_Z_lrm, <span class="at">conf.int =</span> <span class="fl">0.90</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="summarizing-fit-model-z" class="level3" data-number="9.4.4">
<h3 data-number="9.4.4" class="anchored" data-anchor-id="summarizing-fit-model-z"><span class="header-section-number">9.4.4</span> Summarizing Fit (Model Z)</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>mod_Z_lrm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Logistic Regression Model

lrm(formula = ecig_reg ~ rcs(min_num, 4) + ecig_nico + ecig_flavored + 
    harm_perc + price_paid + ecig_flavored %ia% min_num, data = data_log_i, 
    x = TRUE, y = TRUE)

                       Model Likelihood       Discrimination    Rank Discrim.    
                             Ratio Test              Indexes          Indexes    
Obs          1200    LR chi2     773.30       R2       0.670    C       0.891    
 Yes          369    d.f.            10     R2(10,1200)0.471    Dxy     0.783    
 No           831    Pr(&gt; chi2) &lt;0.0001    R2(10,766.6)0.631    gamma   0.792    
max |deriv| 2e-08                             Brier    0.084    tau-a   0.334    

                           Coef    S.E.   Wald Z Pr(&gt;|Z|)
Intercept                  -3.8676 0.7261 -5.33  &lt;0.0001 
min_num                     0.0987 0.0090 10.99  &lt;0.0001 
min_num'                   -0.1707 0.0206 -8.29  &lt;0.0001 
min_num''                   0.4303 0.0807  5.33  &lt;0.0001 
ecig_nico=No               -0.2277 0.2773 -0.82  0.4116  
ecig_flavored=No           -3.0412 0.7147 -4.26  &lt;0.0001 
harm_perc=same_or_more      0.4633 0.2540  1.82  0.0682  
price_paid=$10to$20        -2.1952 0.4318 -5.08  &lt;0.0001 
price_paid=$21to$100       -2.8602 0.4241 -6.74  &lt;0.0001 
price_paid=&gt;$100           -3.3635 0.7092 -4.74  &lt;0.0001 
ecig_flavored=No * min_num  0.0028 0.0037  0.76  0.4457  </code></pre>
</div>
</div>
<p>The Nagelkerke <span class="math inline">\(R^2\)</span> for model Z is 0.670. The C statistic is 0.891.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(mod_Z) <span class="sc">|&gt;</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">df =</span> nobs <span class="sc">-</span> df.residual <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(AIC, BIC, df, df.residual, nobs) <span class="sc">|&gt;</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">1</span>)<span class="sc">|&gt;</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">AIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df.residual</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">729.7</td>
<td style="text-align: right;">785.7</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">1189</td>
<td style="text-align: right;">1200</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="confusion-matrix-model-z" class="level3" data-number="9.4.5">
<h3 data-number="9.4.5" class="anchored" data-anchor-id="confusion-matrix-model-z"><span class="header-section-number">9.4.5</span> Confusion Matrix (Model Z)</h3>
<p>As in Model Y, my prediction rule is that the fitted value of pr(ecig_reg = 1) needs to be greater than or equal to 0.5 for me to predict that <code>ecig_reg</code> is 1.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>mod_Z_cm <span class="ot">&lt;-</span> <span class="fu">glm</span>(ecig_reg <span class="sc">~</span> ecig_nico <span class="sc">+</span> <span class="fu">rcs</span>(min_num,<span class="dv">4</span>) <span class="sc">+</span> ecig_flavored <span class="sc">+</span> harm_perc <span class="sc">+</span> price_paid <span class="sc">+</span> ecig_flavored <span class="sc">%ia%</span> min_num,</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> log_i_temp, <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>resZ_aug <span class="ot">&lt;-</span> <span class="fu">augment</span>(mod_Z_cm, <span class="at">type.predict =</span> <span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>cm_Z <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">factor</span>(resZ_aug<span class="sc">$</span>.fitted <span class="sc">&gt;=</span> <span class="fl">0.5</span>),</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">reference =</span> <span class="fu">factor</span>(resZ_aug<span class="sc">$</span>ecig_reg <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">positive =</span> <span class="st">"TRUE"</span>)</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>cm_Z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction FALSE TRUE
     FALSE   817   99
     TRUE     14  270
                                          
               Accuracy : 0.9058          
                 95% CI : (0.8879, 0.9218)
    No Information Rate : 0.6925          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7638          
                                          
 Mcnemar's Test P-Value : 2.743e-15       
                                          
            Sensitivity : 0.7317          
            Specificity : 0.9832          
         Pos Pred Value : 0.9507          
         Neg Pred Value : 0.8919          
             Prevalence : 0.3075          
         Detection Rate : 0.2250          
   Detection Prevalence : 0.2367          
      Balanced Accuracy : 0.8574          
                                          
       'Positive' Class : TRUE            
                                          </code></pre>
</div>
</div>
<table class="table">
<thead>
<tr class="header">
<th>MODEL</th>
<th>NAGELKERKE <span class="math inline">\(R^2\)</span></th>
<th>C STATISTIC</th>
<th>AIC</th>
<th>BIC</th>
<th>DF</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Y</td>
<td>0.145</td>
<td>0.630</td>
<td>1367.3</td>
<td>1408</td>
<td>7</td>
</tr>
<tr class="even">
<td>Z</td>
<td>0.670</td>
<td>0.891</td>
<td>729.7</td>
<td>785.7</td>
<td>10</td>
</tr>
</tbody>
</table>
<table class="table">
<thead>
<tr class="header">
<th>MODEL</th>
<th>SENSITIVITY</th>
<th>SPECIFICITY</th>
<th>POSITIVE PREDICTIVE VALUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Y</td>
<td>0.258</td>
<td>0.994</td>
<td>0.950</td>
</tr>
<tr class="even">
<td>Z</td>
<td>0.732</td>
<td>0.983</td>
<td>0.951</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="validating-models-y-and-z" class="level2" data-number="9.5">
<h2 data-number="9.5" class="anchored" data-anchor-id="validating-models-y-and-z"><span class="header-section-number">9.5</span> Validating Models Y and Z</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4322023</span>); (valY <span class="ot">&lt;-</span> <span class="fu">validate</span>(mod_Y_lrm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          index.orig training   test optimism index.corrected  n
Dxy           0.2606   0.3282 0.2917   0.0366          0.2241 40
R2            0.1445   0.1617 0.1356   0.0260          0.1185 40
Intercept     0.0000   0.0000 0.0657  -0.0657          0.0657 40
Slope         1.0000   1.0000 0.9093   0.0907          0.9093 40
Emax          0.0000   0.0000 0.0325   0.0325          0.0325 40
D             0.1073   0.1211 0.1003   0.0208          0.0864 40
U            -0.0017  -0.0017 0.0011  -0.0028          0.0011 40
Q             0.1089   0.1228 0.0992   0.0236          0.0853 40
B             0.1814   0.1786 0.1828  -0.0042          0.1856 40
g             0.7310   0.7958 0.7134   0.0824          0.6486 40
gp            0.1421   0.1532 0.1406   0.0126          0.1295 40</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4322023</span>); (valZ <span class="ot">&lt;-</span> <span class="fu">validate</span>(mod_Z_lrm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          index.orig training   test optimism index.corrected  n
Dxy           0.7827   0.7994 0.7809   0.0186          0.7641 40
R2            0.6701   0.6814 0.6641   0.0173          0.6528 40
Intercept     0.0000   0.0000 0.0495  -0.0495          0.0495 40
Slope         1.0000   1.0000 0.9496   0.0504          0.9496 40
Emax          0.0000   0.0000 0.0202   0.0202          0.0202 40
D             0.6436   0.6591 0.6356   0.0235          0.6201 40
U            -0.0017  -0.0017 0.0003  -0.0020          0.0003 40
Q             0.6452   0.6607 0.6353   0.0254          0.6198 40
B             0.0839   0.0815 0.0852  -0.0037          0.0876 40
g             3.3667   3.4866 3.3112   0.1754          3.1914 40
gp            0.3511   0.3546 0.3497   0.0049          0.3462 40</code></pre>
</div>
</div>
<section id="validated-r2-and-c-statistics-for-each-model" class="level3" data-number="9.5.1">
<h3 data-number="9.5.1" class="anchored" data-anchor-id="validated-r2-and-c-statistics-for-each-model"><span class="header-section-number">9.5.1</span> Validated <span class="math inline">\(R^2\)</span> and <span class="math inline">\(C\)</span> statistics for each model</h3>
<table class="table">
<thead>
<tr class="header">
<th>MODEL</th>
<th>VALIDATED <span class="math inline">\(R^2\)</span></th>
<th>VALIDATED <span class="math inline">\(C\)</span> STATISTIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Y</td>
<td>0.1185</td>
<td>0.612</td>
</tr>
<tr class="even">
<td>Z</td>
<td>0.6528</td>
<td>0.882</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="final-logistic-regression-model" class="level2" data-number="9.6">
<h2 data-number="9.6" class="anchored" data-anchor-id="final-logistic-regression-model"><span class="header-section-number">9.6</span> Final Logistic Regression Model</h2>
<p>I prefer Model <code>Z</code>, for the following reasons:</p>
<ul>
<li><p>Model Z has a higher validated <span class="math inline">\(R^2\)</span> and <span class="math inline">\(C\)</span> statistic</p></li>
<li><p>Model Z has a higher Naegelkerke <span class="math inline">\(R^2\)</span></p></li>
<li><p>Model Z has a lower AIC and BIC</p></li>
<li><p>Model Z has a higher sensitivity, and a higher positive predictive value. While it has the lower specificity, the difference is not wide.</p></li>
</ul>
<section id="winning-models-parameter-estimates-1" class="level3" data-number="9.6.1">
<h3 data-number="9.6.1" class="anchored" data-anchor-id="winning-models-parameter-estimates-1"><span class="header-section-number">9.6.1</span> Winning Model’s Parameter Estimates</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>mod_Z_lrm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Logistic Regression Model

lrm(formula = ecig_reg ~ rcs(min_num, 4) + ecig_nico + ecig_flavored + 
    harm_perc + price_paid + ecig_flavored %ia% min_num, data = data_log_i, 
    x = TRUE, y = TRUE)

                       Model Likelihood       Discrimination    Rank Discrim.    
                             Ratio Test              Indexes          Indexes    
Obs          1200    LR chi2     773.30       R2       0.670    C       0.891    
 Yes          369    d.f.            10     R2(10,1200)0.471    Dxy     0.783    
 No           831    Pr(&gt; chi2) &lt;0.0001    R2(10,766.6)0.631    gamma   0.792    
max |deriv| 2e-08                             Brier    0.084    tau-a   0.334    

                           Coef    S.E.   Wald Z Pr(&gt;|Z|)
Intercept                  -3.8676 0.7261 -5.33  &lt;0.0001 
min_num                     0.0987 0.0090 10.99  &lt;0.0001 
min_num'                   -0.1707 0.0206 -8.29  &lt;0.0001 
min_num''                   0.4303 0.0807  5.33  &lt;0.0001 
ecig_nico=No               -0.2277 0.2773 -0.82  0.4116  
ecig_flavored=No           -3.0412 0.7147 -4.26  &lt;0.0001 
harm_perc=same_or_more      0.4633 0.2540  1.82  0.0682  
price_paid=$10to$20        -2.1952 0.4318 -5.08  &lt;0.0001 
price_paid=$21to$100       -2.8602 0.4241 -6.74  &lt;0.0001 
price_paid=&gt;$100           -3.3635 0.7092 -4.74  &lt;0.0001 
ecig_flavored=No * min_num  0.0028 0.0037  0.76  0.4457  </code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtaining model coefficients and exponentiating them</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(mod_Z, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.90</span>) <span class="sc">|&gt;</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>, <span class="at">full_width =</span> F) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.726</td>
<td style="text-align: right;">-5.327</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">0.065</td>
</tr>
<tr class="even">
<td style="text-align: left;">ecig_nicoNo</td>
<td style="text-align: right;">0.796</td>
<td style="text-align: right;">0.277</td>
<td style="text-align: right;">-0.821</td>
<td style="text-align: right;">0.412</td>
<td style="text-align: right;">0.510</td>
<td style="text-align: right;">1.271</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rcs(min_num, 4)min_num</td>
<td style="text-align: right;">1.104</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">10.992</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.088</td>
<td style="text-align: right;">1.121</td>
</tr>
<tr class="even">
<td style="text-align: left;">rcs(min_num, 4)min_num'</td>
<td style="text-align: right;">0.843</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">-8.289</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.814</td>
<td style="text-align: right;">0.871</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rcs(min_num, 4)min_num''</td>
<td style="text-align: right;">1.538</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">5.330</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.349</td>
<td style="text-align: right;">1.760</td>
</tr>
<tr class="even">
<td style="text-align: left;">ecig_flavoredNo</td>
<td style="text-align: right;">0.048</td>
<td style="text-align: right;">0.715</td>
<td style="text-align: right;">-4.255</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.151</td>
</tr>
<tr class="odd">
<td style="text-align: left;">harm_percsame_or_more</td>
<td style="text-align: right;">1.589</td>
<td style="text-align: right;">0.254</td>
<td style="text-align: right;">1.823</td>
<td style="text-align: right;">0.068</td>
<td style="text-align: right;">1.052</td>
<td style="text-align: right;">2.429</td>
</tr>
<tr class="even">
<td style="text-align: left;">price_paid$10to$20</td>
<td style="text-align: right;">0.111</td>
<td style="text-align: right;">0.432</td>
<td style="text-align: right;">-5.084</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.054</td>
<td style="text-align: right;">0.224</td>
</tr>
<tr class="odd">
<td style="text-align: left;">price_paid$21to$100</td>
<td style="text-align: right;">0.057</td>
<td style="text-align: right;">0.424</td>
<td style="text-align: right;">-6.744</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.028</td>
<td style="text-align: right;">0.113</td>
</tr>
<tr class="even">
<td style="text-align: left;">price_paid&gt;$100</td>
<td style="text-align: right;">0.035</td>
<td style="text-align: right;">0.709</td>
<td style="text-align: right;">-4.743</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.011</td>
<td style="text-align: right;">0.112</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ecig_flavored %ia% min_num</td>
<td style="text-align: right;">1.003</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.763</td>
<td style="text-align: right;">0.446</td>
<td style="text-align: right;">0.997</td>
<td style="text-align: right;">1.009</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="plot-of-effect-sizes-for-winning-model" class="level3" data-number="9.6.2">
<h3 data-number="9.6.2" class="anchored" data-anchor-id="plot-of-effect-sizes-for-winning-model"><span class="header-section-number">9.6.2</span> Plot of Effect Sizes for Winning Model</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_Z_lrm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             Effects              Response : ecig_reg 

 Factor                             Low High Diff. Effect    S.E.    Lower 0.95
 min_num                            90  180  90     1.056400 0.24375  0.578620 
  Odds Ratio                        90  180  90     2.875900      NA  1.783600 
 ecig_nico - No:Yes                  1    2  NA    -0.227660 0.27727 -0.771110 
  Odds Ratio                         1    2  NA     0.796390      NA  0.462500 
 ecig_flavored - No:Yes              1    2  NA    -2.705000 0.41467 -3.517800 
  Odds Ratio                         1    2  NA     0.066868      NA  0.029666 
 harm_perc - same_or_more:less_harm  1    2  NA     0.463250 0.25405 -0.034679 
  Odds Ratio                         1    2  NA     1.589200      NA  0.965920 
 price_paid - Below$10:$21to$100     3    1  NA     2.860200 0.42410  2.029000 
  Odds Ratio                         3    1  NA    17.465000      NA  7.606200 
 price_paid - $10to$20:$21to$100     3    2  NA     0.664980 0.25607  0.163100 
  Odds Ratio                         3    2  NA     1.944400      NA  1.177100 
 price_paid - &gt;$100:$21to$100        3    4  NA    -0.503340 0.60451 -1.688200 
  Odds Ratio                         3    4  NA     0.604510      NA  0.184860 
 Upper 0.95
  1.53410  
  4.63710  
  0.31579  
  1.37130  
 -1.89230  
  0.15072  
  0.96118  
  2.61480  
  3.69140  
 40.10100  
  1.16690  
  3.21190  
  0.68147  
  1.97680  

Adjusted to: min_num=120 ecig_flavored=Yes  </code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">summary</span>(mod_Z_lrm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-102-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="numerical-description-of-effect-sizes-1" class="level3" data-number="9.6.3">
<h3 data-number="9.6.3" class="anchored" data-anchor-id="numerical-description-of-effect-sizes-1"><span class="header-section-number">9.6.3</span> Numerical Description of Effect Sizes</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_Z_lrm, <span class="at">conf.int =</span> <span class="fl">0.90</span>) <span class="sc">|&gt;</span> <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>, <span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">High</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Diff.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Effect</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">S.E.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Lower 0.9</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Upper 0.9</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">min_num</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">180</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">1.056</td>
<td style="text-align: right;">0.244</td>
<td style="text-align: right;">0.655</td>
<td style="text-align: right;">1.457</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Odds Ratio</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">180</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">2.876</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.926</td>
<td style="text-align: right;">4.294</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ecig_nico - No:Yes</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">-0.228</td>
<td style="text-align: right;">0.277</td>
<td style="text-align: right;">-0.684</td>
<td style="text-align: right;">0.228</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Odds Ratio</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.796</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.505</td>
<td style="text-align: right;">1.257</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ecig_flavored - No:Yes</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">-2.705</td>
<td style="text-align: right;">0.415</td>
<td style="text-align: right;">-3.387</td>
<td style="text-align: right;">-2.023</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Odds Ratio</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.067</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.034</td>
<td style="text-align: right;">0.132</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">harm_perc - same_or_more:less_harm</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.463</td>
<td style="text-align: right;">0.254</td>
<td style="text-align: right;">0.045</td>
<td style="text-align: right;">0.881</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Odds Ratio</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.589</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.046</td>
<td style="text-align: right;">2.414</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">price_paid - Below$10:$21to$100</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">2.860</td>
<td style="text-align: right;">0.424</td>
<td style="text-align: right;">2.163</td>
<td style="text-align: right;">3.558</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Odds Ratio</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">17.465</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">8.694</td>
<td style="text-align: right;">35.085</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">price_paid - $10to$20:$21to$100</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.665</td>
<td style="text-align: right;">0.256</td>
<td style="text-align: right;">0.244</td>
<td style="text-align: right;">1.086</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Odds Ratio</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.944</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.276</td>
<td style="text-align: right;">2.963</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">price_paid - &gt;$100:$21to$100</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">-0.503</td>
<td style="text-align: right;">0.605</td>
<td style="text-align: right;">-1.498</td>
<td style="text-align: right;">0.491</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Odds Ratio</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.605</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.224</td>
<td style="text-align: right;">1.634</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><code>price_paid</code> description:</p>
<p>For two individuals, subject 1 and 2, who have their first e-cigarette puff of the day the same number of minutes after waking up, who both use nicotine containing e-cigarettes, who have the same perception of the harmfulness of e-cigarettes in comparison to regular cigarettes, and use flavored e-cigarettes, and subject 1 pays less than 10 dollars for their e-cigarettes, and subject 2 pays between 21 to a 100 dollars for their e-cigarettes, according to model Z, <strong>the ratio of the odds of subject 1 being a regular e-cigarette smoker to the odds of subject 2 being a regular e-cigarette smoker is 17.465</strong> The 90% confidence intervals around this estimate are (8.69 to 35.09).</p>
<p>Given that this interval does not include 1, this is a meaningful effect.</p>
</section>
<section id="plot-of-roc-curve-for-winning-model" class="level3" data-number="9.6.4">
<h3 data-number="9.6.4" class="anchored" data-anchor-id="plot-of-roc-curve-for-winning-model"><span class="header-section-number">9.6.4</span> Plot of ROC Curve for Winning Model</h3>
<p>The <code>roc</code> function from the <code>pROC</code> package was used to obtain the ROC curve for model Z(the <code>lrm</code> model). The dataset with the outcome variable recoded as “Yes” = 1, “No” = 0 was used.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>roc.mod <span class="ot">&lt;-</span> </span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">roc</span>(log_i_temp<span class="sc">$</span>ecig_reg <span class="sc">~</span> <span class="fu">predict</span>(mod_Z_lrm, <span class="at">type=</span><span class="st">"fitted"</span>),</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">ci =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &gt; cases</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc.mod, <span class="at">auc.polygon =</span> <span class="cn">TRUE</span>, <span class="at">print.auc =</span> <span class="cn">TRUE</span>,<span class="at">max.auc.polygon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">grid=</span><span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>),</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">grid.col =</span> <span class="fu">c</span>(<span class="st">"green"</span>, <span class="st">"red"</span>),</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">auc.polygon.col =</span> <span class="st">"skyblue"</span>,<span class="at">title =</span> <span class="st">"ROC Curve for Model Z (lrm) with the AUC score"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-105-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="validated-r2-and-c-statistic-for-winning-model" class="level3" data-number="9.6.5">
<h3 data-number="9.6.5" class="anchored" data-anchor-id="validated-r2-and-c-statistic-for-winning-model"><span class="header-section-number">9.6.5</span> Validated <span class="math inline">\(R^2\)</span> and <span class="math inline">\(C\)</span> statistic for Winning Model</h3>
<table class="table">
<thead>
<tr class="header">
<th>MODEL</th>
<th>VALIDATED <span class="math inline">\(R^2\)</span></th>
<th>VALIDATED <span class="math inline">\(C\)</span> STATISTIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Z</td>
<td>0.6528</td>
<td>0.882</td>
</tr>
</tbody>
</table>
</section>
<section id="nomogram-of-winning-model-1" class="level3" data-number="9.6.6">
<h3 data-number="9.6.6" class="anchored" data-anchor-id="nomogram-of-winning-model-1"><span class="header-section-number">9.6.6</span> Nomogram of Winning Model</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">nomogram</span>(mod_Z_lrm, <span class="at">fun =</span> plogis))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Project_A_Portfolio_Naveen_Kannan_files/figure-html/unnamed-chunk-106-1.png" class="img-fluid" width="576"></p>
</div>
</div>
</section>
<section id="predictions-for-two-new-subjects" class="level3" data-number="9.6.7">
<h3 data-number="9.6.7" class="anchored" data-anchor-id="predictions-for-two-new-subjects"><span class="header-section-number">9.6.7</span> Predictions for Two New Subjects</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>new_subj <span class="ot">&lt;-</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">min_num =</span> <span class="fu">c</span>(<span class="dv">60</span>,<span class="dv">60</span>), <span class="at">ecig_flavored =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>,<span class="st">"Yes"</span>),<span class="at">ecig_nico =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>,<span class="st">"Yes"</span>),<span class="at">harm_perc =</span> <span class="fu">c</span>(<span class="st">"less_harm"</span>,<span class="st">"less_harm"</span>), <span class="at">price_paid =</span> <span class="fu">c</span>(<span class="st">"Below$10"</span>,<span class="st">"$21to$100"</span>)) </span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>preds4 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod_Z_lrm, <span class="at">newdata =</span> new_subj, <span class="at">type =</span> <span class="st">"fitted"</span>)</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>preds4 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2 
0.8584043 0.2576755 </code></pre>
</div>
</div>
<table class="table">
<colgroup>
<col style="width: 11%">
<col style="width: 53%">
<col style="width: 35%">
</colgroup>
<thead>
<tr class="header">
<th>Subject Name</th>
<th>Subject Characteristics</th>
<th>Predicted Probability of being a regular E-cigarette smoker</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Subject 1</td>
<td>min_num = 60 minutes, ecig_flavored = Yes, ecig_nico = Yes, harm_perc = “less_harm”, price_paid = “Below$10”</td>
<td>0.858</td>
</tr>
<tr class="even">
<td>Subject 2</td>
<td>min_num = 60 minutes, ecig_flavored = Yes, ecig_nico = Yes, harm_perc = “less_harm”, price_paid = “$21to$100”</td>
<td>0.258</td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="discusssion" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Discusssion</h1>
<section id="answering-my-research-questions" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="answering-my-research-questions"><span class="header-section-number">10.1</span> Answering My Research Questions</h2>
<section id="my-first-research-question-1" class="level3" data-number="10.1.1">
<h3 data-number="10.1.1" class="anchored" data-anchor-id="my-first-research-question-1"><span class="header-section-number">10.1.1</span> My First Research Question</h3>
<p><em>E-Cigarette Perception, Smoking Habits, and their association with Heavy E-Cigarette Use:</em></p>
<p><strong>Are smoking e-cigarettes that contain nicotine, the perception of the purported healthiness of e-cigarettes when compared to smoking regular cigarettes, and smoking habits strong predictors of heavy e-cigarette use in adulthood?</strong></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transforming the coefficients of Model B back to the original variable's scale</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>tidy_mod_B <span class="sc">|&gt;</span> </span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estimate =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>,(<span class="fu">exp</span>(estimate) <span class="sc">-</span> <span class="dv">1</span>)),</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">conf.low =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>,(<span class="fu">exp</span>(conf.low) <span class="sc">-</span> <span class="dv">1</span>)),</span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">conf.high =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>,(<span class="fu">exp</span>(conf.high) <span class="sc">-</span> <span class="dv">1</span>))) <span class="sc">|&gt;</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term,estimate,conf.low,conf.high, p.value) <span class="sc">|&gt;</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>, <span class="at">full_width =</span> F)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">conf.high</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: left;">31.34</td>
<td style="text-align: left;">21.74</td>
<td style="text-align: left;">44.99</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">rcs(puff_num, 4)puff_num</td>
<td style="text-align: left;">-0.46</td>
<td style="text-align: left;">-0.50</td>
<td style="text-align: left;">-0.43</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rcs(puff_num, 4)puff_num'</td>
<td style="text-align: left;">95957.21</td>
<td style="text-align: left;">42612.78</td>
<td style="text-align: left;">216078.82</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">rcs(puff_num, 4)puff_num''</td>
<td style="text-align: left;">-1.00</td>
<td style="text-align: left;">-1.00</td>
<td style="text-align: left;">-1.00</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age_range18to24</td>
<td style="text-align: left;">-0.10</td>
<td style="text-align: left;">-0.25</td>
<td style="text-align: left;">0.08</td>
<td style="text-align: right;">0.357</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_range25to34</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">-0.16</td>
<td style="text-align: left;">0.23</td>
<td style="text-align: right;">0.863</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age_range35to44</td>
<td style="text-align: left;">-0.06</td>
<td style="text-align: left;">-0.23</td>
<td style="text-align: left;">0.15</td>
<td style="text-align: right;">0.612</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_range45to54</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">-0.16</td>
<td style="text-align: left;">0.25</td>
<td style="text-align: right;">0.838</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age_range&gt;55</td>
<td style="text-align: left;">0.17</td>
<td style="text-align: left;">-0.05</td>
<td style="text-align: left;">0.43</td>
<td style="text-align: right;">0.206</td>
</tr>
<tr class="even">
<td style="text-align: left;">less_harmNo</td>
<td style="text-align: left;">0.16</td>
<td style="text-align: left;">-0.04</td>
<td style="text-align: left;">0.39</td>
<td style="text-align: right;">0.204</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ecig_nicoNo</td>
<td style="text-align: left;">-0.11</td>
<td style="text-align: left;">-0.21</td>
<td style="text-align: left;">-0.01</td>
<td style="text-align: right;">0.076</td>
</tr>
<tr class="even">
<td style="text-align: left;">puff_num %ia% less_harm</td>
<td style="text-align: left;">-0.03</td>
<td style="text-align: left;">-0.05</td>
<td style="text-align: left;">-0.01</td>
<td style="text-align: right;">0.029</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><em>E-CIGARETTE PUFFS PER DAY:</em></p>
<p><strong>Higher number of puffs taken per day are correlated with a higher number of days an e-cigarette was smoked in the past 30 days, provided all other variables are held constant.</strong> This is evident from the confidence intervals of <code>puff_num</code>, which do not include zero.</p>
<p><em>USAGE OF E-CIGARETTES WITH NICOTINE:</em></p>
<p><strong>The usage of e-cigarettes that do not contain nicotine are associated with a significantly lower number of days an e-cigarette was smoked by a study participant in the past 30 days, provided all other variables are held constant.</strong></p>
<p>The point estimate for this effect is -0.11, with 90%CI(-0.21 to -0.01). Given that the confidence interval does not include zero, this is a meaningful effect. (p = 0.076)</p>
<p><em>E-CIGARETTE SMOKING INITIATION AGE:</em></p>
<p>Initiation of e-cigarette smoking at a younger age does not have a meaningful correlation with heavy e-cigarette smoking by an individual in the past 30 days, provided all other variables are held constant. This is evident from the confidence intervals for the different levels of <code>age_range</code>, all of which contain zero, when compared to the number of days an e-cigarette was smoked in the past 30 days by individuals who initiated e-cigarette smoking when they were less than 18 years of age.</p>
<p><em>PERCEPTION OF THE HARMFULNESS OF E-CIGARETTES COMPARED TO REGULAR CIGARETTES:</em></p>
<p>The perception of the supposed healthiness of e-cigarettes when compared to regular cigarettes do not have a meaningful correlation with an individual’s e-cigarette smoking in the past 30 days, provided all other variables are held constant. This is evident from the confidence intervals for the term <code>less_harmNo</code> from the table of model B’s coefficients, which include zero. (p = 0.204)</p>
<p><em>In summation, to answer my first research question, </em></p>
<p><strong>Factors such as a higher number of puffs taken from an e-cigarette daily, and usage of nicotine-containing e-cigarettes are correlated with heavier smoking habits over the past 30 days.</strong></p>
<p><strong>Factors such as an individual’s perception of the supposed healthiness of e-cigarettes when compared to regular cigarettes, and their age when they began smoking e-cigarettes, do not have a meaningful impact on an individual’s smoking habits over the past 30 days.</strong></p>
</section>
<section id="my-second-research-question-1" class="level3" data-number="10.1.2">
<h3 data-number="10.1.2" class="anchored" data-anchor-id="my-second-research-question-1"><span class="header-section-number">10.1.2</span> My Second Research Question</h3>
<p><em>Regular e-cigarette use and it’s associated factors:</em></p>
<p><strong>Are factors such as using flavored e-cigarettes, or needing to use e-cigarettes immediately after waking up, or using e-cigarettes with nicotine, or use of e-cigarettes as a healthier alternative to regular cigarettes associated with regular e-cigarette use?</strong></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_Z_lrm, <span class="at">conf.int =</span> <span class="fl">0.90</span>) <span class="sc">|&gt;</span> <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>, <span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic-2 table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">High</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Diff.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Effect</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">S.E.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Lower 0.9</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Upper 0.9</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">min_num</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">180</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">1.056</td>
<td style="text-align: right;">0.244</td>
<td style="text-align: right;">0.655</td>
<td style="text-align: right;">1.457</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Odds Ratio</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">180</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">2.876</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.926</td>
<td style="text-align: right;">4.294</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ecig_nico - No:Yes</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">-0.228</td>
<td style="text-align: right;">0.277</td>
<td style="text-align: right;">-0.684</td>
<td style="text-align: right;">0.228</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Odds Ratio</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.796</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.505</td>
<td style="text-align: right;">1.257</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ecig_flavored - No:Yes</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">-2.705</td>
<td style="text-align: right;">0.415</td>
<td style="text-align: right;">-3.387</td>
<td style="text-align: right;">-2.023</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Odds Ratio</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.067</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.034</td>
<td style="text-align: right;">0.132</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">harm_perc - same_or_more:less_harm</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.463</td>
<td style="text-align: right;">0.254</td>
<td style="text-align: right;">0.045</td>
<td style="text-align: right;">0.881</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Odds Ratio</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.589</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.046</td>
<td style="text-align: right;">2.414</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">price_paid - Below$10:$21to$100</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">2.860</td>
<td style="text-align: right;">0.424</td>
<td style="text-align: right;">2.163</td>
<td style="text-align: right;">3.558</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Odds Ratio</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">17.465</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">8.694</td>
<td style="text-align: right;">35.085</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">price_paid - $10to$20:$21to$100</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.665</td>
<td style="text-align: right;">0.256</td>
<td style="text-align: right;">0.244</td>
<td style="text-align: right;">1.086</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Odds Ratio</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.944</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1.276</td>
<td style="text-align: right;">2.963</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">price_paid - &gt;$100:$21to$100</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">-0.503</td>
<td style="text-align: right;">0.605</td>
<td style="text-align: right;">-1.498</td>
<td style="text-align: right;">0.491</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Odds Ratio</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.605</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.224</td>
<td style="text-align: right;">1.634</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><em>TIME TAKEN FOR THE FIRST E-CIGARETTE PUFF OF THE DAY</em></p>
<p><strong>Individuals who need to use e-cigarettes within an hour or an hour and a half of waking up have detectable higher odds of identifying as regular users of e-cigarettes, provided the other variables are held constant.</strong> This is evident in the 90% confidence intervals for the odds ratio in the coefficient table, which does not include 1.</p>
<p><em>USAGE OF FLAVORED E-CIGARETTES:</em></p>
<p><strong>Individuals who do not use flavored e-cigarettes have detectable lower odds of identifying as regular users of e-cigarettes, provided the other variables are held constant.</strong> This is evident in the 90% confidence intervals for the odds ratio in the coefficient table, which does not include 1. The point estimate for this odds ratio is 0.07, with 90% confidence intervals (0.03 to 0.13). Individuals who do not use flavored e-cigarettes have only 0.07 times the odds(90%CI 0.03 to 0.13) of identifying as regular e-cigarette smokers, compared to individuals who do use flavored e-cigarettes.</p>
<p><em>COST OF E-CIGARETTE BRAND:</em></p>
<p><strong>Individuals who pay less than 10 dollars for their e-cigarettes have detectably higher odds of identifying as regular e-cigarettes, as compared to individuals who paid anywhere between 21 to 100 dollars for their e-cigarette, provided the other variables are held constant.</strong> This is evident in the 90% confidence intervals for the odds ratio in the coefficient table, which do not include zero. Similarly, individuals who pay anywhere between 10 to 20 dollars for their e-cigarette also have detectably higher odds of identifying as regular e-cigarette smokers</p>
<p>However, individuals who pay more than 100 dollars for their e-cigarettes do not have meaningfully different odds of identifying as regular e-cigarette smokers compared to individuals who pay anywhere between 21 to 100 dollars for their e-cigarettes, provided the other variables remain constant. This is evident in the 90% confidence intervals for the odds ratio of this effect in the coefficient table, which includes 1.</p>
<p><em>USAGE OF E-CIGARETTES CONTAINING NICOTINE:</em></p>
<p>Individuals who do not use e-cigarettes with nicotine do not have meaningfully different odds of identifying as regular e-cigarette smokers compared to individuals who use e-cigarettes containing nicotine, provided the other variables are held constant. The 90% confidence intervals for the odds ratio of this effect includes 1.</p>
<p><em>PERCEPTION OF THE HARMFULNESS OF E-CIGARETTES AS COMPARED TO REGULAR CIGARETTES:</em></p>
<p>Individuals who perceive e-cigarettes as being the same or more harmful than regular e-cigarettes do not have meaningfully different odds of identifying as regular e-cigarette smokers compared to individuals who perceive e-cigarettes as being less harmful than regular e-cigarettes, provided the other variables are held constant. The odds ratio for this effect includes 1.</p>
<p><em>In summation, to answer my second research question, </em></p>
<p><strong>Factors such as needing to use e-cigarettes immediately after waking up, using flavored e-cigarettes, and using cheaper e-cigarette brands are all associated with detectably higher odds of identifying as a regular e-cigarette user, provided the other variables are held constant.</strong></p>
<p><strong>Factors such as the usage of nicotine containing e-cigarettes, and the perceptiom of the harmfulness of e-cigarettes as compared to regular cigarettes do not have a meaningful impact on the odds of identifying as a regular e-cigarette user, provided all other variables remain constant.</strong></p>
</section>
</section>
<section id="limitations-and-next-steps" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="limitations-and-next-steps"><span class="header-section-number">10.2</span> Limitations and Next Steps</h2>
<section id="model-b-and-its-limitations" class="level3" data-number="10.2.1">
<h3 data-number="10.2.1" class="anchored" data-anchor-id="model-b-and-its-limitations"><span class="header-section-number">10.2.1</span> Model B and it’s limitations</h3>
<p>Given that model B was predicting a count outcome, and given then the outcome was transformed using a logarithm transformation after adding a non-zero integer to the outcome, the resulting model is very highly driven by the <code>puff_num</code> variable, resulting in exploding coefficients for the restricted cubic spline applied on <code>puff_num</code>.</p>
<p>Model B outperformed Model A on all metrics that were studied. Visualization of the transformed outcome variable showed why that was the case, given the non-linear, skewed nature of the data under study. The data lent itself very well towards a non-linear term, even if the restricted cubic spline had exploding coefficients.</p>
<p>This outcome could be better modeled with a Poisson regression, and by using a larger dataset with lesser missing values. The next ideal step would be to expand the dataset to more than 1200, and model the outcome using a Poisson regression.</p>
</section>
<section id="model-z-and-its-limitations" class="level3" data-number="10.2.2">
<h3 data-number="10.2.2" class="anchored" data-anchor-id="model-z-and-its-limitations"><span class="header-section-number">10.2.2</span> Model Z and it’s limitations</h3>
<p>The glm fit of the model produced a warning stating that predicted probabilities of 0 or 1 had occurred. Given that the data under analysis had a large amount of missingness, imputation possibly skewed the model towards one direction or the other. It is important to note that this warning was only produced in the glm model, while the lrm model did not produce such a warning.</p>
<p>This model could be improved by vastly expanding the sample size, minimizing the effect of the missing data and smoothing out the predicted probabilites so that the preceding skew does not repeat itself.</p>
</section>
</section>
<section id="thoughts-on-project-a" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="thoughts-on-project-a"><span class="header-section-number">10.3</span> Thoughts on Project A</h2>
<p>Project A was more difficult than I expected it to be. I went in knowing it would take a decent amount of work and effort, and I was reasonably confident that I could tackle it, since I knew my experience in 431 had already helped prepare me for the work that would be required. The hardest part of Project A was dealing with the large number of missing values. The impact of imputation on both models was significant, and discussing the limitations and understanding how the models could be improved was a difficult task, although I did learn a lot from the difficulty I had with the data.</p>
<p>At the end of Project A, I wished that I had chosen a non count outcome for the linear regression.We hadn’t covered count outcomes at the time of submission of the Plan, and if I’d known the difficulties inherent in using linear regression for a count outcome when I started, I would have picked a different outcome variable.</p>
</section>
</section>
<section id="affirmation" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Affirmation</h1>
<blockquote class="blockquote">
<p>I am certain that it is completely appropriate for these data to be shared with anyone, without any conditions. There are no concerns about privacy or security.</p>
</blockquote>
</section>
<section id="references" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> References</h1>
<p>[1] Singh, T., Arrazola, R. A., Corey, C. G., Husten, C. G., Neff, L. J., Homa, D. M., &amp; King, B. A. (2016). <strong>Tobacco use among middle and high school students—United States</strong>, 2011–2015. Morbidity and mortality weekly report, 65(14), 361-367.</p>
<p>[2] Dutra, L. M., &amp; Glantz, S. A. (2014). <strong>High international electronic cigarette use among never smoker adolescents.</strong> Journal of Adolescent Health, 55(5), 595-597.</p>
<p>[3] Dutra, L. M., &amp; Glantz, S. A. (2017). <strong>E-cigarettes and national adolescent cigarette use</strong>: 2004–2014. Pediatrics, 139(2).</p>
<p>[4] Glantz, S. A., &amp; Bareham, D. W. (2018). <strong>E-cigarettes: use, effects on smoking, risks, and policy implications</strong>. Annual review of public health, 39, 215-235.</p>
<p>[5] United States Department of Health and Human Services. National Institutes of Health. National Institute on Drug Abuse, and United States Department of Health and Human Services. Food and Drug Administration. Center for Tobacco Products. Population Assessment of Tobacco and Health (PATH) Study [United States] Public-Use Files. Inter-university Consortium for Political and Social Research [distributor], 2022-10-07. https://doi.org/10.3886/ICPSR36498.v17</p>
</section>
<section id="session-information" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Session Information</h1>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>xfun<span class="sc">::</span><span class="fu">session_info</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.2 (2023-10-31 ucrt)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 11 x64 (build 22621)

Locale:
  LC_COLLATE=English_United States.utf8 
  LC_CTYPE=English_United States.utf8   
  LC_MONETARY=English_United States.utf8
  LC_NUMERIC=C                          
  LC_TIME=English_United States.utf8    

Package version:
  abind_1.4-5          askpass_1.2.0        backports_1.4.1     
  base64enc_0.1-3      bit_4.0.5            bit64_4.0.5         
  blob_1.2.4           boot_1.3-28.1        brio_1.1.4          
  broom_1.0.5          broom.helpers_1.14.0 bslib_0.6.1         
  cachem_1.0.8         callr_3.7.3          car_3.1-2           
  carData_3.0-5        caret_6.0-94         cellranger_1.1.0    
  checkmate_2.3.1      class_7.3-22         cli_3.6.1           
  clipr_0.8.0          clock_0.7.0          cluster_2.1.6       
  codetools_0.2-19     colorspace_2.1-0     compiler_4.3.2      
  conflicted_1.2.0     cpp11_0.4.7          crayon_1.5.2        
  curl_5.2.0           data.table_1.14.10   DBI_1.2.0           
  dbplyr_2.4.0         DEoptimR_1.1.3       desc_1.4.3          
  diagram_1.6.5        diffobj_0.3.5        digest_0.6.33       
  doRNG_1.8.6          dplyr_1.1.4          dtplyr_1.3.1        
  e1071_1.7-14         ellipsis_0.3.2       evaluate_0.23       
  fansi_1.0.6          farver_2.1.1         fastmap_1.1.1       
  fontawesome_0.5.2    forcats_1.0.0        foreach_1.5.2       
  foreign_0.8-86       Formula_1.2-5        fs_1.6.3            
  furrr_0.3.1          future_1.33.1        future.apply_1.11.1 
  gargle_1.5.2         generics_0.1.3       GGally_2.2.0        
  ggplot2_3.4.4        ggstats_0.5.1        glmnet_4.1-8        
  globals_0.16.2       glue_1.6.2           googledrive_2.1.1   
  googlesheets4_1.1.1  gower_1.0.1          graphics_4.3.2      
  grDevices_4.3.2      grid_4.3.2           gridExtra_2.3       
  gtable_0.3.4         hardhat_1.3.0        haven_2.5.4         
  highr_0.10           Hmisc_5.1-1          hms_1.1.3           
  htmlTable_2.4.2      htmltools_0.5.7      htmlwidgets_1.6.4   
  httr_1.4.7           ids_1.0.1            ipred_0.9-14        
  isoband_0.2.7        iterators_1.0.14     itertools_0.1.3     
  janitor_2.2.0        jomo_2.7-6           jquerylib_0.1.4     
  jsonlite_1.8.8       kableExtra_1.3.4     KernSmooth_2.23.22  
  knitr_1.45           labeling_0.4.3       labelled_2.12.0     
  laeken_0.5.2         lattice_0.22-5       lava_1.7.3          
  lifecycle_1.0.4      listenv_0.9.0        lme4_1.1-35.1       
  lmtest_0.9.40        lubridate_1.9.3      magrittr_2.0.3      
  MASS_7.3-60          Matrix_1.6-4         MatrixModels_0.5-3  
  memoise_2.0.1        methods_4.3.2        mgcv_1.9.1          
  mice_3.16.0          mime_0.12            minqa_1.2.6         
  missForest_1.5       mitml_0.4-5          ModelMetrics_1.2.2.2
  modelr_0.1.11        multcomp_1.4-25      munsell_0.5.0       
  mvtnorm_1.2-4        naniar_1.0.0         nlme_3.1-164        
  nloptr_2.0.3         nnet_7.3-19          norm_1.0.11.1       
  numDeriv_2016.8.1.1  openssl_2.1.1        ordinal_2023.12.4   
  pan_1.9              parallel_4.3.2       parallelly_1.36.0   
  patchwork_1.1.3      pbkrtest_0.5.2       pillar_1.9.0        
  pkgbuild_1.4.3       pkgconfig_2.0.3      pkgload_1.3.3       
  plyr_1.8.9           polspline_1.1.24     praise_1.0.0        
  prettyunits_1.2.0    pROC_1.18.5          processx_3.8.3      
  prodlim_2023.08.28   progress_1.2.3       progressr_0.14.0    
  proxy_0.4-27         ps_1.7.5             purrr_1.0.2         
  quantreg_5.97        R6_2.5.1             ragg_1.2.7          
  randomForest_4.7.1.1 ranger_0.16.0        rappdirs_0.3.3      
  RColorBrewer_1.1-3   Rcpp_1.0.11          RcppEigen_0.3.3.9.4 
  readr_2.1.4          readxl_1.4.3         recipes_1.0.9       
  rematch_2.0.0        rematch2_2.1.2       reprex_2.0.2        
  reshape2_1.4.4       rlang_1.1.2          rmarkdown_2.25      
  rms_6.7-1            rngtools_1.5.2       robustbase_0.99.1   
  rpart_4.1.23         rprojroot_2.0.4      rsample_1.2.0       
  rstudioapi_0.15.0    rvest_1.0.3          sandwich_3.1-0      
  sass_0.4.8           scales_1.3.0         selectr_0.4.2       
  shape_1.4.6          simputation_0.2.8    slider_0.3.1        
  snakecase_0.11.1     sp_2.1.2             SparseM_1.81        
  splines_4.3.2        SQUAREM_2021.1       stats_4.3.2         
  stats4_4.3.2         stringi_1.8.3        stringr_1.5.1       
  survival_3.5-7       svglite_2.1.3        sys_3.4.2           
  systemfonts_1.0.5    testthat_3.2.1       textshaping_0.3.7   
  TH.data_1.1-2        tibble_3.2.1         tidyr_1.3.0         
  tidyselect_1.2.0     tidyverse_2.0.0      timechange_0.2.0    
  timeDate_4032.109    tinytex_0.49         tools_4.3.2         
  tzdb_0.4.0           ucminf_1.2.1         UpSetR_1.4.0        
  utf8_1.2.4           utils_4.3.2          uuid_1.1.1          
  vcd_1.4.11           vctrs_0.6.5          VIM_6.2.2           
  viridis_0.6.4        viridisLite_0.4.2    visdat_0.6.0        
  vroom_1.6.5          waldo_0.5.2          warp_0.2.1          
  webshot_0.5.5        withr_2.5.2          xfun_0.41           
  xml2_1.3.6           yaml_2.3.7           yardstick_1.2.0     
  zoo_1.8-12          </code></pre>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb146" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Predictors of Heavy E-Cigarette Use among Adults in the United States"</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "An analysis of the Population Assessment of Tobacco and Health (PATH) Study."</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Naveen Kannan"</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 2023-03-19</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: wrap</span></span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a><span class="co">    date-format: iso</span></span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a><span class="fu">## R Packages and Setup {.unnumbered}</span></span>
<span id="cb146-17"><a href="#cb146-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-20"><a href="#cb146-20" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-21"><a href="#cb146-21" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb146-22"><a href="#cb146-22" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb146-23"><a href="#cb146-23" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">comment =</span> <span class="cn">NA</span>) </span>
<span id="cb146-24"><a href="#cb146-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb146-25"><a href="#cb146-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor) </span>
<span id="cb146-26"><a href="#cb146-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb146-27"><a href="#cb146-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb146-28"><a href="#cb146-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rsample)</span>
<span id="cb146-29"><a href="#cb146-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yardstick)</span>
<span id="cb146-30"><a href="#cb146-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb146-31"><a href="#cb146-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb146-32"><a href="#cb146-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb146-33"><a href="#cb146-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb146-34"><a href="#cb146-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb146-35"><a href="#cb146-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rms)</span>
<span id="cb146-36"><a href="#cb146-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(simputation)</span>
<span id="cb146-37"><a href="#cb146-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb146-38"><a href="#cb146-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb146-39"><a href="#cb146-39" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>()) </span>
<span id="cb146-40"><a href="#cb146-40" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-41"><a href="#cb146-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-42"><a href="#cb146-42" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data Source</span></span>
<span id="cb146-43"><a href="#cb146-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-44"><a href="#cb146-44" aria-hidden="true" tabindex="-1"></a>The data under study comes from the Population Assessment of Tobacco and Health (PATH) Study. It was obtained from ICPSR, the Inter-university Consortium for Political and Social Research.</span>
<span id="cb146-45"><a href="#cb146-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-46"><a href="#cb146-46" aria-hidden="true" tabindex="-1"></a>The Population Assessment of Tobacco and Health **(PATH)** Study began originally surveying 45,971 adult and youth respondents. The study sampled over 150,000 mailing addresses across the United States to create a national sample of tobacco users and non-users, and is a collaboration between the National Institute on Drug Abuse (NIDA), National Institutes of Health (NIH), and the Center for Tobacco Products (CTP), Food and Drug Administration (FDA).</span>
<span id="cb146-47"><a href="#cb146-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-48"><a href="#cb146-48" aria-hidden="true" tabindex="-1"></a>The data can be found at (https://www.icpsr.umich.edu/web/ICPSR/studies/36498/datadocumentation).</span>
<span id="cb146-49"><a href="#cb146-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-50"><a href="#cb146-50" aria-hidden="true" tabindex="-1"></a>For adults, data was collected via interviews. Each case constitutes a single completed interview. Each case in a Youth data file represents one youth and his or her parent's responses about that youth. Parents who provided permission for their child to participate in a Youth Interview were asked to complete a brief interview about their child. Youth who turn 18 by the current wave of data collection are considered "aged-up adults" and are invited to complete the Adult Interview.</span>
<span id="cb146-51"><a href="#cb146-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-52"><a href="#cb146-52" aria-hidden="true" tabindex="-1"></a><span class="fu"># The Subjects</span></span>
<span id="cb146-53"><a href="#cb146-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-54"><a href="#cb146-54" aria-hidden="true" tabindex="-1"></a>The dataset from which data is being taken is **Dataset 1001 (DS1001)**, which contains the data from the Wave 1 adult questionnaire. 45,971 adults and youth constitute the first (baseline) wave of data collected by this longitudinal cohort study.</span>
<span id="cb146-55"><a href="#cb146-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-56"><a href="#cb146-56" aria-hidden="true" tabindex="-1"></a>The DS1001 data can be considered a random sample that constitutes a longitudinal cross section of adults(of age 18 and above) across the United States, since the PATH study sampled over 150,000 mailing addresses across the United States to create a national sample of tobacco users and non-users. The DS1001 data contains data on adults (individuals of age 18 and above) alone.</span>
<span id="cb146-57"><a href="#cb146-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-58"><a href="#cb146-58" aria-hidden="true" tabindex="-1"></a>From the DS1001 dataset, individuals who used e-cigarettes at the time of the Wave 1 questionnaire were selected, excluding individuals who did not use e-cigarettes at that time. Dual users of e-cigarettes and other forms of tobacco were not excluded. The DS1001 dataset only contains data on adults, and thus youth below the age of 18 are excluded from the final dataset.</span>
<span id="cb146-59"><a href="#cb146-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-60"><a href="#cb146-60" aria-hidden="true" tabindex="-1"></a>Individuals who had complete data on both outcomes under study were then selected. The resulting dataset had 3000 individuals. A random sample of 1200 individuals was taken from this subset, ensuring that the same respondents were taken for both analyses.</span>
<span id="cb146-61"><a href="#cb146-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-62"><a href="#cb146-62" aria-hidden="true" tabindex="-1"></a>This sample of 1200 PATH study participants (contained in the tibble data_final) can thus be considered as a longitudinal cross-sectional sample of individuals who used e-cigarettes at the time of administering the Wave 1 questionnaire, who may or may not have used other tobacco products, across the United States, of ages 18 and above. Wave 1 began at September 2013 and ended at December 2014.</span>
<span id="cb146-63"><a href="#cb146-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-64"><a href="#cb146-64" aria-hidden="true" tabindex="-1"></a><span class="fu"># Loading and Tidying the Data</span></span>
<span id="cb146-65"><a href="#cb146-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-66"><a href="#cb146-66" aria-hidden="true" tabindex="-1"></a><span class="fu">## Loading the Raw Data</span></span>
<span id="cb146-67"><a href="#cb146-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-68"><a href="#cb146-68" aria-hidden="true" tabindex="-1"></a>Access to the data requires users to log-in to the ICPSR website. Thus, a direct download is not possible. This data can be freely downloaded by the public, and therefore a local copy of the data in the form of a tsv file was read using <span class="in">`read_tsv`</span> from the tidyverse.</span>
<span id="cb146-69"><a href="#cb146-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-72"><a href="#cb146-72" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-73"><a href="#cb146-73" aria-hidden="true" tabindex="-1"></a><span class="co">#data_raw &lt;- read_tsv("36498-1001-Data.tsv", show_col_types = FALSE)</span></span>
<span id="cb146-74"><a href="#cb146-74" aria-hidden="true" tabindex="-1"></a><span class="co">#saveRDS(data_raw, "36498-1001-Data.Rds")</span></span>
<span id="cb146-75"><a href="#cb146-75" aria-hidden="true" tabindex="-1"></a>data_raw <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="st">"36498-1001-Data.Rds"</span>)</span>
<span id="cb146-76"><a href="#cb146-76" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-77"><a href="#cb146-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-78"><a href="#cb146-78" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cleaning the Data</span></span>
<span id="cb146-79"><a href="#cb146-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-80"><a href="#cb146-80" aria-hidden="true" tabindex="-1"></a><span class="fu">### Selecting Variables We'll Use</span></span>
<span id="cb146-81"><a href="#cb146-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-84"><a href="#cb146-84" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-85"><a href="#cb146-85" aria-hidden="true" tabindex="-1"></a>data_var <span class="ot">&lt;-</span> data_raw <span class="sc">|&gt;</span></span>
<span id="cb146-86"><a href="#cb146-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(PERSONID,R01_AE1022,R01_AE0103,R01R_A_AE1006,R01_AE1062,R01_AE1100,R01_AE1099,R01_AE9004,R01_AE9010,R01_AE1050,R01R_A_MINFIRST_ECIG, R01_AE1003)</span>
<span id="cb146-87"><a href="#cb146-87" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-88"><a href="#cb146-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-89"><a href="#cb146-89" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dealing with Missingness</span></span>
<span id="cb146-90"><a href="#cb146-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-91"><a href="#cb146-91" aria-hidden="true" tabindex="-1"></a>The DS1001 dataset provides negative values for variables that are missing. There are several different subtypes of missing data:</span>
<span id="cb146-92"><a href="#cb146-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-93"><a href="#cb146-93" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Data removed due to respondent request</span>
<span id="cb146-94"><a href="#cb146-94" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Data not ascertained</span>
<span id="cb146-95"><a href="#cb146-95" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Respondent answer is "Don't Know"</span>
<span id="cb146-96"><a href="#cb146-96" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Respondent refused to answer</span>
<span id="cb146-97"><a href="#cb146-97" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Question inapplicable to respondent</span>
<span id="cb146-98"><a href="#cb146-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-99"><a href="#cb146-99" aria-hidden="true" tabindex="-1"></a>All of these values are negative in the original DS1001 dataset, and none of the variables under study have negative values. It is also not possible for the variables under study to have negative values. Therefore, all negative values were replaced with <span class="in">`NA`</span> to ensure missing data are correctly identified.</span>
<span id="cb146-100"><a href="#cb146-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-103"><a href="#cb146-103" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-104"><a href="#cb146-104" aria-hidden="true" tabindex="-1"></a>data_var <span class="ot">&lt;-</span> data_var<span class="sc">|&gt;</span> </span>
<span id="cb146-105"><a href="#cb146-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="cf">function</span>(x){<span class="fu">replace</span>(x, <span class="fu">which</span>(x<span class="sc">&lt;</span><span class="dv">0</span>), <span class="cn">NA</span>)}))</span>
<span id="cb146-106"><a href="#cb146-106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-107"><a href="#cb146-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-108"><a href="#cb146-108" aria-hidden="true" tabindex="-1"></a><span class="fu">### Changing Variable Names</span></span>
<span id="cb146-109"><a href="#cb146-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-110"><a href="#cb146-110" aria-hidden="true" tabindex="-1"></a>The variables were renamed to have better, more readable names.</span>
<span id="cb146-111"><a href="#cb146-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-114"><a href="#cb146-114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-115"><a href="#cb146-115" aria-hidden="true" tabindex="-1"></a>data_var <span class="ot">&lt;-</span> data_var<span class="sc">|&gt;</span></span>
<span id="cb146-116"><a href="#cb146-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ecig_30day =</span> <span class="fu">as.integer</span>(R01_AE1022),</span>
<span id="cb146-117"><a href="#cb146-117" aria-hidden="true" tabindex="-1"></a>         <span class="at">puff_num =</span> <span class="fu">as.integer</span>(R01_AE0103),</span>
<span id="cb146-118"><a href="#cb146-118" aria-hidden="true" tabindex="-1"></a>         <span class="at">age_range =</span> <span class="fu">factor</span>(R01R_A_AE1006),</span>
<span id="cb146-119"><a href="#cb146-119" aria-hidden="true" tabindex="-1"></a>         <span class="at">less_harm =</span> <span class="fu">factor</span>(R01_AE1062),</span>
<span id="cb146-120"><a href="#cb146-120" aria-hidden="true" tabindex="-1"></a>         <span class="at">ecig_reg =</span> <span class="fu">factor</span>(R01_AE1100),</span>
<span id="cb146-121"><a href="#cb146-121" aria-hidden="true" tabindex="-1"></a>         <span class="at">harm_perc =</span> <span class="fu">factor</span>(R01_AE1099),</span>
<span id="cb146-122"><a href="#cb146-122" aria-hidden="true" tabindex="-1"></a>         <span class="at">price_paid =</span> <span class="fu">factor</span>(R01_AE9004),</span>
<span id="cb146-123"><a href="#cb146-123" aria-hidden="true" tabindex="-1"></a>         <span class="at">personid =</span> <span class="fu">as.character</span>(PERSONID),</span>
<span id="cb146-124"><a href="#cb146-124" aria-hidden="true" tabindex="-1"></a>         <span class="at">ecig_nico =</span> <span class="fu">as.factor</span>(R01_AE9010),</span>
<span id="cb146-125"><a href="#cb146-125" aria-hidden="true" tabindex="-1"></a>         <span class="at">ecig_flavored =</span> <span class="fu">as.factor</span>(R01_AE1050),</span>
<span id="cb146-126"><a href="#cb146-126" aria-hidden="true" tabindex="-1"></a>         <span class="at">min_num =</span> <span class="fu">as.integer</span>(R01R_A_MINFIRST_ECIG),</span>
<span id="cb146-127"><a href="#cb146-127" aria-hidden="true" tabindex="-1"></a>         <span class="at">ecig_smoker =</span> <span class="fu">factor</span>(R01_AE1003)) <span class="sc">|&gt;</span></span>
<span id="cb146-128"><a href="#cb146-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(personid, ecig_30day,puff_num,age_range,less_harm,ecig_reg,harm_perc,price_paid,ecig_nico, ecig_flavored, min_num, ecig_smoker)</span>
<span id="cb146-129"><a href="#cb146-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-130"><a href="#cb146-130" aria-hidden="true" tabindex="-1"></a>data_var <span class="ot">&lt;-</span> data_var <span class="sc">|&gt;</span></span>
<span id="cb146-131"><a href="#cb146-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() </span>
<span id="cb146-132"><a href="#cb146-132" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb146-133"><a href="#cb146-133" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-134"><a href="#cb146-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-135"><a href="#cb146-135" aria-hidden="true" tabindex="-1"></a><span class="fu">### Sampling the Data</span></span>
<span id="cb146-136"><a href="#cb146-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-137"><a href="#cb146-137" aria-hidden="true" tabindex="-1"></a>The dataset was filtered to select only individuals who were users of e-cigarettes at the time of study. The dataset was then filtered to have complete cases on both the outcomes under study, namely <span class="in">`ecig_30day`</span> and <span class="in">`ecig_reg`</span>.</span>
<span id="cb146-138"><a href="#cb146-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-141"><a href="#cb146-141" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-142"><a href="#cb146-142" aria-hidden="true" tabindex="-1"></a>data_outcome <span class="ot">&lt;-</span> data_var <span class="sc">|&gt;</span></span>
<span id="cb146-143"><a href="#cb146-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ecig_smoker <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> ecig_smoker <span class="sc">==</span> <span class="dv">2</span>)<span class="sc">|&gt;</span> <span class="co"># Excluding individuals who did not use e-cigarettes at the time of Wave 1 </span></span>
<span id="cb146-144"><a href="#cb146-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">complete.cases</span>(ecig_30day, ecig_reg)) <span class="sc">|&gt;</span></span>
<span id="cb146-145"><a href="#cb146-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(personid, ecig_30day,puff_num,age_range,less_harm,ecig_reg,harm_perc,price_paid,ecig_nico, ecig_flavored, min_num, ecig_smoker)</span>
<span id="cb146-146"><a href="#cb146-146" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(data_outcome)</span>
<span id="cb146-147"><a href="#cb146-147" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-148"><a href="#cb146-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-149"><a href="#cb146-149" aria-hidden="true" tabindex="-1"></a>3000 respondents have information on both the outcome variables under study. After setting a seed for reproducibility, a random sample of 1200 respondents was taken from the <span class="in">`data_outcome`</span> tibble. This was also done to ensure that the same respondents are analyzed for both regression models.</span>
<span id="cb146-150"><a href="#cb146-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-153"><a href="#cb146-153" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-154"><a href="#cb146-154" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2023</span>) </span>
<span id="cb146-155"><a href="#cb146-155" aria-hidden="true" tabindex="-1"></a>data_complete <span class="ot">&lt;-</span> <span class="fu">slice_sample</span>(data_outcome, <span class="at">n =</span> <span class="dv">1200</span>) </span>
<span id="cb146-156"><a href="#cb146-156" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-157"><a href="#cb146-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-158"><a href="#cb146-158" aria-hidden="true" tabindex="-1"></a>Once a random sample was taken, the <span class="in">`tabyl`</span> function was used to ensure that all individuals in the tibble <span class="in">`data_complete`</span> were individuals who had used e-cigarettes.</span>
<span id="cb146-159"><a href="#cb146-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-162"><a href="#cb146-162" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-163"><a href="#cb146-163" aria-hidden="true" tabindex="-1"></a>data_complete <span class="sc">|&gt;</span></span>
<span id="cb146-164"><a href="#cb146-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(ecig_smoker) <span class="sc">|&gt;</span></span>
<span id="cb146-165"><a href="#cb146-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-166"><a href="#cb146-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-167"><a href="#cb146-167" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-168"><a href="#cb146-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-169"><a href="#cb146-169" aria-hidden="true" tabindex="-1"></a>From the documentation for the original variable name for <span class="in">`ecig_smoker`</span>(<span class="in">`R01_AE1003`</span>), the question asked was, 'Do you now use e-cigarettes?', with three possible levels.</span>
<span id="cb146-170"><a href="#cb146-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-171"><a href="#cb146-171" aria-hidden="true" tabindex="-1"></a>| Value | Label          | Frequency |</span>
<span id="cb146-172"><a href="#cb146-172" aria-hidden="true" tabindex="-1"></a>|-------|----------------|-----------|</span>
<span id="cb146-173"><a href="#cb146-173" aria-hidden="true" tabindex="-1"></a>| 1     | 1 = Every day  | 41        |</span>
<span id="cb146-174"><a href="#cb146-174" aria-hidden="true" tabindex="-1"></a>| 2     | 2 = Some days  | 1159      |</span>
<span id="cb146-175"><a href="#cb146-175" aria-hidden="true" tabindex="-1"></a>| 3     | 3 = Not at all | 0         |</span>
<span id="cb146-176"><a href="#cb146-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-177"><a href="#cb146-177" aria-hidden="true" tabindex="-1"></a>The above table shows the distribution of the responses to the question, demonstrating that all the individuals under study are individuals who were using e-cigarettes at the time of the Wave 1 questionnaire. Individuals who did not use e-cigarettes at the time are not included in the random sample of 1200 respondents.</span>
<span id="cb146-178"><a href="#cb146-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-179"><a href="#cb146-179" aria-hidden="true" tabindex="-1"></a><span class="fu">### Working with Categorical Predictors</span></span>
<span id="cb146-180"><a href="#cb146-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-181"><a href="#cb146-181" aria-hidden="true" tabindex="-1"></a>The <span class="in">`tabyl`</span> function was used to check if all factor variables have atleast 30 observations at each level.</span>
<span id="cb146-182"><a href="#cb146-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-185"><a href="#cb146-185" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-186"><a href="#cb146-186" aria-hidden="true" tabindex="-1"></a>data_complete <span class="sc">|&gt;</span> </span>
<span id="cb146-187"><a href="#cb146-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(age_range)<span class="sc">|&gt;</span></span>
<span id="cb146-188"><a href="#cb146-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-189"><a href="#cb146-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-190"><a href="#cb146-190" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-191"><a href="#cb146-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-194"><a href="#cb146-194" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-195"><a href="#cb146-195" aria-hidden="true" tabindex="-1"></a>data_complete <span class="sc">|&gt;</span> </span>
<span id="cb146-196"><a href="#cb146-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(less_harm) <span class="sc">|&gt;</span></span>
<span id="cb146-197"><a href="#cb146-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-198"><a href="#cb146-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-199"><a href="#cb146-199" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-200"><a href="#cb146-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-203"><a href="#cb146-203" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-204"><a href="#cb146-204" aria-hidden="true" tabindex="-1"></a>data_complete <span class="sc">|&gt;</span> </span>
<span id="cb146-205"><a href="#cb146-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(ecig_reg) <span class="sc">|&gt;</span></span>
<span id="cb146-206"><a href="#cb146-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-207"><a href="#cb146-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-208"><a href="#cb146-208" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-209"><a href="#cb146-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-212"><a href="#cb146-212" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-213"><a href="#cb146-213" aria-hidden="true" tabindex="-1"></a>data_complete <span class="sc">|&gt;</span> </span>
<span id="cb146-214"><a href="#cb146-214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(harm_perc) <span class="sc">|&gt;</span></span>
<span id="cb146-215"><a href="#cb146-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-216"><a href="#cb146-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-217"><a href="#cb146-217" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-218"><a href="#cb146-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-219"><a href="#cb146-219" aria-hidden="true" tabindex="-1"></a>The <span class="in">`harm_perc`</span> variable was found to have a level <span class="in">`3`</span> which only had 23 observations. Factor levels <span class="in">`2`</span> and <span class="in">`3`</span> for <span class="in">`harm_perc`</span> were collapsed into a single category.</span>
<span id="cb146-220"><a href="#cb146-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-223"><a href="#cb146-223" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-224"><a href="#cb146-224" aria-hidden="true" tabindex="-1"></a>data_complete<span class="sc">$</span>harm_perc <span class="ot">&lt;-</span> <span class="fu">fct_collapse</span>(data_complete<span class="sc">$</span>harm_perc,</span>
<span id="cb146-225"><a href="#cb146-225" aria-hidden="true" tabindex="-1"></a>  <span class="st">'2'</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"2"</span>, <span class="st">"3"</span>),</span>
<span id="cb146-226"><a href="#cb146-226" aria-hidden="true" tabindex="-1"></a>  <span class="st">'1'</span> <span class="ot">=</span> <span class="st">"1"</span>)</span>
<span id="cb146-227"><a href="#cb146-227" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-228"><a href="#cb146-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-229"><a href="#cb146-229" aria-hidden="true" tabindex="-1"></a>Now, <span class="in">`harm_perc`</span> has only 2 levels, each with more than 30 distinct values.</span>
<span id="cb146-230"><a href="#cb146-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-233"><a href="#cb146-233" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-234"><a href="#cb146-234" aria-hidden="true" tabindex="-1"></a>data_complete <span class="sc">|&gt;</span> </span>
<span id="cb146-235"><a href="#cb146-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(harm_perc)<span class="sc">|&gt;</span></span>
<span id="cb146-236"><a href="#cb146-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-237"><a href="#cb146-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-238"><a href="#cb146-238" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-239"><a href="#cb146-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-242"><a href="#cb146-242" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-243"><a href="#cb146-243" aria-hidden="true" tabindex="-1"></a>data_complete <span class="sc">|&gt;</span> </span>
<span id="cb146-244"><a href="#cb146-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(price_paid)<span class="sc">|&gt;</span></span>
<span id="cb146-245"><a href="#cb146-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-246"><a href="#cb146-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-247"><a href="#cb146-247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-248"><a href="#cb146-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-251"><a href="#cb146-251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-252"><a href="#cb146-252" aria-hidden="true" tabindex="-1"></a>data_complete <span class="sc">|&gt;</span> </span>
<span id="cb146-253"><a href="#cb146-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(ecig_nico)<span class="sc">|&gt;</span></span>
<span id="cb146-254"><a href="#cb146-254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-255"><a href="#cb146-255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-256"><a href="#cb146-256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-257"><a href="#cb146-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-260"><a href="#cb146-260" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-261"><a href="#cb146-261" aria-hidden="true" tabindex="-1"></a>data_complete <span class="sc">|&gt;</span> </span>
<span id="cb146-262"><a href="#cb146-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(ecig_flavored)<span class="sc">|&gt;</span></span>
<span id="cb146-263"><a href="#cb146-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-264"><a href="#cb146-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-265"><a href="#cb146-265" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-266"><a href="#cb146-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-267"><a href="#cb146-267" aria-hidden="true" tabindex="-1"></a>The other factor variables were found to have at least 30 observations at each level. Furthermore, none of the categorical variables have more than 6 levels.</span>
<span id="cb146-268"><a href="#cb146-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-269"><a href="#cb146-269" aria-hidden="true" tabindex="-1"></a><span class="fu">### Working with Quantitative Variables</span></span>
<span id="cb146-270"><a href="#cb146-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-273"><a href="#cb146-273" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-274"><a href="#cb146-274" aria-hidden="true" tabindex="-1"></a>data_complete <span class="sc">|&gt;</span> </span>
<span id="cb146-275"><a href="#cb146-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(personid, ecig_30day, puff_num, min_num) <span class="sc">|&gt;</span></span>
<span id="cb146-276"><a href="#cb146-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(personid<span class="sc">:</span>min_num, <span class="sc">~</span> <span class="fu">n_distinct</span>(.)))</span>
<span id="cb146-277"><a href="#cb146-277" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-278"><a href="#cb146-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-279"><a href="#cb146-279" aria-hidden="true" tabindex="-1"></a>The quantitative variables <span class="in">`ecig_30day`</span>,<span class="in">`puff_num`</span> and <span class="in">`min_num`</span> have at least 10 different, ordered, observed values.</span>
<span id="cb146-280"><a href="#cb146-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-283"><a href="#cb146-283" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-284"><a href="#cb146-284" aria-hidden="true" tabindex="-1"></a>data_complete <span class="sc">|&gt;</span> </span>
<span id="cb146-285"><a href="#cb146-285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(personid, ecig_30day, puff_num, min_num) <span class="sc">|&gt;</span></span>
<span id="cb146-286"><a href="#cb146-286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">miss_var_summary</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-287"><a href="#cb146-287" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-288"><a href="#cb146-288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-289"><a href="#cb146-289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-290"><a href="#cb146-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-291"><a href="#cb146-291" aria-hidden="true" tabindex="-1"></a>The <span class="in">`miss_var_summary`</span> function from the <span class="in">`naniar`</span> package was used to identify the number of missing values for the continuous variables under study.</span>
<span id="cb146-292"><a href="#cb146-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-293"><a href="#cb146-293" aria-hidden="true" tabindex="-1"></a><span class="fu">### Renaming the factors</span></span>
<span id="cb146-294"><a href="#cb146-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-295"><a href="#cb146-295" aria-hidden="true" tabindex="-1"></a>The categorical variables had their factors renamed to make the data more readable. The final tidy tibble was designated as <span class="in">`data_final`</span>.</span>
<span id="cb146-296"><a href="#cb146-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-299"><a href="#cb146-299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-300"><a href="#cb146-300" aria-hidden="true" tabindex="-1"></a>data_final <span class="ot">&lt;-</span> data_complete<span class="sc">|&gt;</span></span>
<span id="cb146-301"><a href="#cb146-301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_range =</span> <span class="fu">fct_recode</span>(<span class="fu">factor</span>(age_range),</span>
<span id="cb146-302"><a href="#cb146-302" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"&lt;18"</span> <span class="ot">=</span> <span class="st">"1"</span>,</span>
<span id="cb146-303"><a href="#cb146-303" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"18to24"</span> <span class="ot">=</span> <span class="st">"2"</span>,</span>
<span id="cb146-304"><a href="#cb146-304" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"25to34"</span> <span class="ot">=</span> <span class="st">"3"</span>,</span>
<span id="cb146-305"><a href="#cb146-305" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"35to44"</span> <span class="ot">=</span> <span class="st">"4"</span>,</span>
<span id="cb146-306"><a href="#cb146-306" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"45to54"</span> <span class="ot">=</span> <span class="st">"5"</span>,</span>
<span id="cb146-307"><a href="#cb146-307" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"&gt;55"</span> <span class="ot">=</span> <span class="st">"6"</span>),</span>
<span id="cb146-308"><a href="#cb146-308" aria-hidden="true" tabindex="-1"></a>         <span class="at">less_harm =</span> <span class="fu">fct_recode</span>(<span class="fu">factor</span>(less_harm),</span>
<span id="cb146-309"><a href="#cb146-309" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"1"</span>,</span>
<span id="cb146-310"><a href="#cb146-310" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"No"</span> <span class="ot">=</span> <span class="st">"2"</span>),</span>
<span id="cb146-311"><a href="#cb146-311" aria-hidden="true" tabindex="-1"></a>         <span class="at">ecig_reg =</span> <span class="fu">fct_recode</span>(<span class="fu">factor</span>(ecig_reg),</span>
<span id="cb146-312"><a href="#cb146-312" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"1"</span>,</span>
<span id="cb146-313"><a href="#cb146-313" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"No"</span> <span class="ot">=</span> <span class="st">"2"</span>),</span>
<span id="cb146-314"><a href="#cb146-314" aria-hidden="true" tabindex="-1"></a>         <span class="at">harm_perc =</span> <span class="fu">fct_recode</span>(<span class="fu">factor</span>(harm_perc),</span>
<span id="cb146-315"><a href="#cb146-315" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"less_harm"</span> <span class="ot">=</span> <span class="st">"1"</span>,</span>
<span id="cb146-316"><a href="#cb146-316" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"same_or_more"</span> <span class="ot">=</span> <span class="st">"2"</span>),</span>
<span id="cb146-317"><a href="#cb146-317" aria-hidden="true" tabindex="-1"></a>         <span class="at">price_paid =</span> <span class="fu">fct_recode</span>(<span class="fu">factor</span>(price_paid),</span>
<span id="cb146-318"><a href="#cb146-318" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Below$10"</span> <span class="ot">=</span> <span class="st">"1"</span>,</span>
<span id="cb146-319"><a href="#cb146-319" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"$10to$20"</span> <span class="ot">=</span> <span class="st">"2"</span>,</span>
<span id="cb146-320"><a href="#cb146-320" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"$21to$100"</span> <span class="ot">=</span> <span class="st">"3"</span>,</span>
<span id="cb146-321"><a href="#cb146-321" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"&gt;$100"</span> <span class="ot">=</span> <span class="st">"4"</span>),</span>
<span id="cb146-322"><a href="#cb146-322" aria-hidden="true" tabindex="-1"></a>         <span class="at">ecig_nico =</span> <span class="fu">fct_recode</span>(<span class="fu">factor</span>(ecig_nico),</span>
<span id="cb146-323"><a href="#cb146-323" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"1"</span>,</span>
<span id="cb146-324"><a href="#cb146-324" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"No"</span> <span class="ot">=</span> <span class="st">"2"</span>),</span>
<span id="cb146-325"><a href="#cb146-325" aria-hidden="true" tabindex="-1"></a>         <span class="at">ecig_flavored =</span> <span class="fu">fct_recode</span>(<span class="fu">factor</span>(ecig_flavored),</span>
<span id="cb146-326"><a href="#cb146-326" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"1"</span>,</span>
<span id="cb146-327"><a href="#cb146-327" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"No"</span> <span class="ot">=</span> <span class="st">"2"</span>))</span>
<span id="cb146-328"><a href="#cb146-328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-329"><a href="#cb146-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-330"><a href="#cb146-330" aria-hidden="true" tabindex="-1"></a><span class="fu">### Splitting the Data</span></span>
<span id="cb146-331"><a href="#cb146-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-332"><a href="#cb146-332" aria-hidden="true" tabindex="-1"></a>Once a random sample of 1200 respondents was taken, the data was separated into two tibbles for the purpose of describing the data under study for the two models. <span class="in">`data_log`</span> denotes the dataset for the logistic regression, and <span class="in">`data_lin`</span> denotes the dataset for the linear regression.</span>
<span id="cb146-333"><a href="#cb146-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-336"><a href="#cb146-336" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-337"><a href="#cb146-337" aria-hidden="true" tabindex="-1"></a>data_lin <span class="ot">&lt;-</span> data_final<span class="sc">|&gt;</span></span>
<span id="cb146-338"><a href="#cb146-338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(personid,ecig_30day,puff_num,age_range,less_harm,ecig_nico)</span>
<span id="cb146-339"><a href="#cb146-339" aria-hidden="true" tabindex="-1"></a>data_log <span class="ot">&lt;-</span> data_final<span class="sc">|&gt;</span></span>
<span id="cb146-340"><a href="#cb146-340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(personid,ecig_reg,min_num,harm_perc,price_paid,ecig_nico,ecig_flavored)</span>
<span id="cb146-341"><a href="#cb146-341" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-342"><a href="#cb146-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-343"><a href="#cb146-343" aria-hidden="true" tabindex="-1"></a><span class="fu"># The Tidy Tibble</span></span>
<span id="cb146-344"><a href="#cb146-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-345"><a href="#cb146-345" aria-hidden="true" tabindex="-1"></a><span class="fu">## Listing the Tibble</span></span>
<span id="cb146-346"><a href="#cb146-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-347"><a href="#cb146-347" aria-hidden="true" tabindex="-1"></a>The tidy tibble, <span class="in">`data_final`</span>, was listed.</span>
<span id="cb146-348"><a href="#cb146-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-351"><a href="#cb146-351" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-352"><a href="#cb146-352" aria-hidden="true" tabindex="-1"></a>data_final </span>
<span id="cb146-353"><a href="#cb146-353" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-354"><a href="#cb146-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-355"><a href="#cb146-355" aria-hidden="true" tabindex="-1"></a><span class="fu">## Size and Identifiers</span></span>
<span id="cb146-356"><a href="#cb146-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-357"><a href="#cb146-357" aria-hidden="true" tabindex="-1"></a>There are 1200 rows, with 12 columns in the final tibble <span class="in">`data_final`</span>. One of these columns</span>
<span id="cb146-358"><a href="#cb146-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-361"><a href="#cb146-361" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-362"><a href="#cb146-362" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(data_final)</span>
<span id="cb146-363"><a href="#cb146-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-364"><a href="#cb146-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-365"><a href="#cb146-365" aria-hidden="true" tabindex="-1"></a>The <span class="in">`personid`</span> variable provides the identifier for each row in the tidy tibble. The <span class="in">`n_distinct`</span> function was used to demonstrate 1200 individual values for <span class="in">`personid`</span> in <span class="in">`data_final`</span>, indicating that each row has a unique <span class="in">`personid`</span> value.</span>
<span id="cb146-366"><a href="#cb146-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-369"><a href="#cb146-369" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-370"><a href="#cb146-370" aria-hidden="true" tabindex="-1"></a><span class="fu">n_distinct</span>(data_final<span class="sc">$</span>personid)</span>
<span id="cb146-371"><a href="#cb146-371" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-372"><a href="#cb146-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-373"><a href="#cb146-373" aria-hidden="true" tabindex="-1"></a><span class="fu">## Save The Tibble</span></span>
<span id="cb146-374"><a href="#cb146-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-375"><a href="#cb146-375" aria-hidden="true" tabindex="-1"></a>The <span class="in">`saveRDS`</span> function was used to save the tidy tibble in a .rds file.</span>
<span id="cb146-376"><a href="#cb146-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-379"><a href="#cb146-379" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-380"><a href="#cb146-380" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(data_final, <span class="at">file =</span> <span class="st">"data_final.Rds"</span>)</span>
<span id="cb146-381"><a href="#cb146-381" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-382"><a href="#cb146-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-383"><a href="#cb146-383" aria-hidden="true" tabindex="-1"></a><span class="fu"># The Code Book</span></span>
<span id="cb146-384"><a href="#cb146-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-385"><a href="#cb146-385" aria-hidden="true" tabindex="-1"></a><span class="fu">## Defining the Variables</span></span>
<span id="cb146-386"><a href="#cb146-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-387"><a href="#cb146-387" aria-hidden="true" tabindex="-1"></a>+-----------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+---------------------------------+--------------------+</span>
<span id="cb146-388"><a href="#cb146-388" aria-hidden="true" tabindex="-1"></a>| **Variable**    | **Original DS1001 code** | **Description**                                                                                                                                                           | **Type**                                  | **Analytic Role**               | **Missing values** |</span>
<span id="cb146-389"><a href="#cb146-389" aria-hidden="true" tabindex="-1"></a>+-----------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+---------------------------------+--------------------+</span>
<span id="cb146-390"><a href="#cb146-390" aria-hidden="true" tabindex="-1"></a>| <span class="in">`personid`</span>      | <span class="in">`PERSONID`</span>               | Unique Participant Identifier                                                                                                                                            | Character variable                        | Unique Identifier               | 0                  |</span>
<span id="cb146-391"><a href="#cb146-391" aria-hidden="true" tabindex="-1"></a>+-----------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+---------------------------------+--------------------+</span>
<span id="cb146-392"><a href="#cb146-392" aria-hidden="true" tabindex="-1"></a>| <span class="in">`ecig_30day`</span>    | <span class="in">`R01_AE1022`</span>             | On how many of the past 30 days did the participant use an e-cigarette?                                                                                                  | Quantitative Variable                     | Linear Regression **Outcome**   | 0                  |</span>
<span id="cb146-393"><a href="#cb146-393" aria-hidden="true" tabindex="-1"></a>+-----------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+---------------------------------+--------------------+</span>
<span id="cb146-394"><a href="#cb146-394" aria-hidden="true" tabindex="-1"></a>| <span class="in">`puff_num`</span>      | <span class="in">`R01_AE0103`</span>             | How many puffs from an e-cigarette did the participant take the last time they smoked an e-cigarette?                                                                    | Quantitative Variable                     | Predictor                       | 849                |</span>
<span id="cb146-395"><a href="#cb146-395" aria-hidden="true" tabindex="-1"></a>+-----------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+---------------------------------+--------------------+</span>
<span id="cb146-396"><a href="#cb146-396" aria-hidden="true" tabindex="-1"></a>| <span class="in">`age_range`</span>     | <span class="in">`R01R_A_AE1006`</span>          | How old was the participant when they first used an e-cigarette, even one or two times?                                                                                  | Multi-Categorical Variable with 6 factors | Predictor                       | 8                  |</span>
<span id="cb146-397"><a href="#cb146-397" aria-hidden="true" tabindex="-1"></a>|                 |                          |                                                                                                                                                                          |                                           |                                 |                    |</span>
<span id="cb146-398"><a href="#cb146-398" aria-hidden="true" tabindex="-1"></a>|                 |                          | 6 levels:<span class="in">`&lt;18`</span>,<span class="in">`18to24`</span>,                                                                                                                                                 |                                           |                                 |                    |</span>
<span id="cb146-399"><a href="#cb146-399" aria-hidden="true" tabindex="-1"></a>|                 |                          |                                                                                                                                                                          |                                           |                                 |                    |</span>
<span id="cb146-400"><a href="#cb146-400" aria-hidden="true" tabindex="-1"></a>|                 |                          | <span class="in">`25to34`</span>,<span class="in">`35to44`</span>,                                                                                                                                                       |                                           |                                 |                    |</span>
<span id="cb146-401"><a href="#cb146-401" aria-hidden="true" tabindex="-1"></a>|                 |                          |                                                                                                                                                                          |                                           |                                 |                    |</span>
<span id="cb146-402"><a href="#cb146-402" aria-hidden="true" tabindex="-1"></a>|                 |                          | <span class="in">`45to54`</span>,<span class="in">`&gt;55`</span>                                                                                                                                                           |                                           |                                 |                    |</span>
<span id="cb146-403"><a href="#cb146-403" aria-hidden="true" tabindex="-1"></a>+-----------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+---------------------------------+--------------------+</span>
<span id="cb146-404"><a href="#cb146-404" aria-hidden="true" tabindex="-1"></a>| <span class="in">`less_harm`</span>     | <span class="in">`R01_AE1062`</span>             | Did the participant use / used to use e-cigarettes because they might be / have been less harmful to them?                                                               | Binary Categorical Variable               | Predictor                       | 6                  |</span>
<span id="cb146-405"><a href="#cb146-405" aria-hidden="true" tabindex="-1"></a>|                 |                          |                                                                                                                                                                          |                                           |                                 |                    |</span>
<span id="cb146-406"><a href="#cb146-406" aria-hidden="true" tabindex="-1"></a>|                 |                          | 2 levels: <span class="in">`yes`</span>, <span class="in">`no`</span>                                                                                                                                                    |                                           |                                 |                    |</span>
<span id="cb146-407"><a href="#cb146-407" aria-hidden="true" tabindex="-1"></a>+-----------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+---------------------------------+--------------------+</span>
<span id="cb146-408"><a href="#cb146-408" aria-hidden="true" tabindex="-1"></a>| <span class="in">`ecig_reg`</span>      | <span class="in">`R01_AE1100`</span>             | Has the participant ever used e-cigarettes fairly regularly?                                                                                                             | Binary Categorical Variable               | Logistic regression **Outcome** | 0                  |</span>
<span id="cb146-409"><a href="#cb146-409" aria-hidden="true" tabindex="-1"></a>|                 |                          |                                                                                                                                                                          |                                           |                                 |                    |</span>
<span id="cb146-410"><a href="#cb146-410" aria-hidden="true" tabindex="-1"></a>|                 |                          | 2 levels:<span class="in">`yes`</span>,<span class="in">`no`</span>                                                                                                                                                      |                                           |                                 |                    |</span>
<span id="cb146-411"><a href="#cb146-411" aria-hidden="true" tabindex="-1"></a>+-----------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+---------------------------------+--------------------+</span>
<span id="cb146-412"><a href="#cb146-412" aria-hidden="true" tabindex="-1"></a>| <span class="in">`harm_perc`</span>     | <span class="in">`R01_AE1099`</span>             | To the participant, is using e-cigarettes less harmful, about the same, or more harmful than smoking cigarettes?                                                         | Binary Categorical Variable               | Predictor                       | 12                 |</span>
<span id="cb146-413"><a href="#cb146-413" aria-hidden="true" tabindex="-1"></a>|                 |                          |                                                                                                                                                                          |                                           |                                 |                    |</span>
<span id="cb146-414"><a href="#cb146-414" aria-hidden="true" tabindex="-1"></a>|                 |                          | 2 levels:<span class="in">`1`</span>,<span class="in">`2`</span>                                                                                                                                                         |                                           |                                 |                    |</span>
<span id="cb146-415"><a href="#cb146-415" aria-hidden="true" tabindex="-1"></a>+-----------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+---------------------------------+--------------------+</span>
<span id="cb146-416"><a href="#cb146-416" aria-hidden="true" tabindex="-1"></a>| <span class="in">`price_paid`</span>    | <span class="in">`R01_AE9004`</span>             | About how much did the participant pay for their e-cigarette?                                                                                                            | Multi-Categorical Variable with 4 factors | Predictor                       | 393                |</span>
<span id="cb146-417"><a href="#cb146-417" aria-hidden="true" tabindex="-1"></a>|                 |                          |                                                                                                                                                                          |                                           |                                 |                    |</span>
<span id="cb146-418"><a href="#cb146-418" aria-hidden="true" tabindex="-1"></a>|                 |                          | 4 levels: <span class="in">`Below$10`</span>,<span class="in">`$10to$20`</span>,                                                                                                                                         |                                           |                                 |                    |</span>
<span id="cb146-419"><a href="#cb146-419" aria-hidden="true" tabindex="-1"></a>|                 |                          |                                                                                                                                                                          |                                           |                                 |                    |</span>
<span id="cb146-420"><a href="#cb146-420" aria-hidden="true" tabindex="-1"></a>|                 |                          | <span class="in">`$21t$100`</span>, <span class="in">`&gt;$100`</span>                                                                                                                                                      |                                           |                                 |                    |</span>
<span id="cb146-421"><a href="#cb146-421" aria-hidden="true" tabindex="-1"></a>+-----------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+---------------------------------+--------------------+</span>
<span id="cb146-422"><a href="#cb146-422" aria-hidden="true" tabindex="-1"></a>| <span class="in">`ecig_nico`</span>     | <span class="in">`R01_AE9010`</span>             | Does the e-cigarette the participant usually uses contain nicotine?                                                                                                      | Binary Categorical Variable               | Predictor                       | 832                |</span>
<span id="cb146-423"><a href="#cb146-423" aria-hidden="true" tabindex="-1"></a>|                 |                          |                                                                                                                                                                          |                                           |                                 |                    |</span>
<span id="cb146-424"><a href="#cb146-424" aria-hidden="true" tabindex="-1"></a>|                 |                          | 2 levels:<span class="in">`yes`</span>,<span class="in">`no`</span>                                                                                                                                                      |                                           |                                 |                    |</span>
<span id="cb146-425"><a href="#cb146-425" aria-hidden="true" tabindex="-1"></a>+-----------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+---------------------------------+--------------------+</span>
<span id="cb146-426"><a href="#cb146-426" aria-hidden="true" tabindex="-1"></a>| <span class="in">`ecig_flavored`</span> | <span class="in">`R01_AE9010`</span>             | Is the regular / last brand of e-cigarettes used by the participant flavored to taste like menthol, mint,clove, spice, candy, fruit, chocolate, alcohol or other sweets? | Binary Categorical Variable               | Predictor                       | 831                |</span>
<span id="cb146-427"><a href="#cb146-427" aria-hidden="true" tabindex="-1"></a>|                 |                          |                                                                                                                                                                          |                                           |                                 |                    |</span>
<span id="cb146-428"><a href="#cb146-428" aria-hidden="true" tabindex="-1"></a>|                 |                          | 2 levels:<span class="in">`yes`</span>,<span class="in">`no`</span>                                                                                                                                                      |                                           |                                 |                    |</span>
<span id="cb146-429"><a href="#cb146-429" aria-hidden="true" tabindex="-1"></a>+-----------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+---------------------------------+--------------------+</span>
<span id="cb146-430"><a href="#cb146-430" aria-hidden="true" tabindex="-1"></a>| <span class="in">`min_num`</span>       | <span class="in">`R01R_A_MINFIRST_ECIG`</span>   | Amount of time from waking to smoking first e-cigarette of any given day (in minutes).                                                                                   | Quantitative Variable                     | Predictor                       | 853                |</span>
<span id="cb146-431"><a href="#cb146-431" aria-hidden="true" tabindex="-1"></a>+-----------------+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+---------------------------------+--------------------+</span>
<span id="cb146-432"><a href="#cb146-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-433"><a href="#cb146-433" aria-hidden="true" tabindex="-1"></a>The levels of the categorical variables and their description are as follows:</span>
<span id="cb146-434"><a href="#cb146-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-435"><a href="#cb146-435" aria-hidden="true" tabindex="-1"></a>**`age_range`**</span>
<span id="cb146-436"><a href="#cb146-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-437"><a href="#cb146-437" aria-hidden="true" tabindex="-1"></a>**How old was the participant when they first used an e-cigarette, even one or two times?**</span>
<span id="cb146-438"><a href="#cb146-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-439"><a href="#cb146-439" aria-hidden="true" tabindex="-1"></a>| Level    | Description            | Distinct Observations in Level |</span>
<span id="cb146-440"><a href="#cb146-440" aria-hidden="true" tabindex="-1"></a>|----------|------------------------|--------------------------------|</span>
<span id="cb146-441"><a href="#cb146-441" aria-hidden="true" tabindex="-1"></a>| <span class="in">`&lt;18`</span>    | Less than 18 years old | 54                             |</span>
<span id="cb146-442"><a href="#cb146-442" aria-hidden="true" tabindex="-1"></a>| <span class="in">`18to24`</span> | 18 to 24 years old     | 365                            |</span>
<span id="cb146-443"><a href="#cb146-443" aria-hidden="true" tabindex="-1"></a>| <span class="in">`25to34`</span> | 25 to 34 years old     | 276                            |</span>
<span id="cb146-444"><a href="#cb146-444" aria-hidden="true" tabindex="-1"></a>| <span class="in">`35to44`</span> | 35 to 44 years old     | 181                            |</span>
<span id="cb146-445"><a href="#cb146-445" aria-hidden="true" tabindex="-1"></a>| <span class="in">`45to54`</span> | 45 to 54 years old     | 169                            |</span>
<span id="cb146-446"><a href="#cb146-446" aria-hidden="true" tabindex="-1"></a>| <span class="in">`&gt;55`</span>    | 55 years old or older  | 147                            |</span>
<span id="cb146-447"><a href="#cb146-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-448"><a href="#cb146-448" aria-hidden="true" tabindex="-1"></a>**`less_harm`**</span>
<span id="cb146-449"><a href="#cb146-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-450"><a href="#cb146-450" aria-hidden="true" tabindex="-1"></a>**Did the participant use / used to use e-cigarettes because they might be / have been less harmful to them?**</span>
<span id="cb146-451"><a href="#cb146-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-452"><a href="#cb146-452" aria-hidden="true" tabindex="-1"></a>| Level | Description | Distinct Observations in Level |</span>
<span id="cb146-453"><a href="#cb146-453" aria-hidden="true" tabindex="-1"></a>|-------|-------------|--------------------------------|</span>
<span id="cb146-454"><a href="#cb146-454" aria-hidden="true" tabindex="-1"></a>| <span class="in">`yes`</span> | Yes         | 955                            |</span>
<span id="cb146-455"><a href="#cb146-455" aria-hidden="true" tabindex="-1"></a>| <span class="in">`no`</span>  | No          | 239                            |</span>
<span id="cb146-456"><a href="#cb146-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-457"><a href="#cb146-457" aria-hidden="true" tabindex="-1"></a>**`ecig_reg`**</span>
<span id="cb146-458"><a href="#cb146-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-459"><a href="#cb146-459" aria-hidden="true" tabindex="-1"></a>**Has the participant ever used e-cigarettes fairly regularly?**</span>
<span id="cb146-460"><a href="#cb146-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-461"><a href="#cb146-461" aria-hidden="true" tabindex="-1"></a>| Level | Description | Distinct Observations in Level |</span>
<span id="cb146-462"><a href="#cb146-462" aria-hidden="true" tabindex="-1"></a>|-------|-------------|--------------------------------|</span>
<span id="cb146-463"><a href="#cb146-463" aria-hidden="true" tabindex="-1"></a>| <span class="in">`yes`</span> | Yes         | 369                            |</span>
<span id="cb146-464"><a href="#cb146-464" aria-hidden="true" tabindex="-1"></a>| <span class="in">`no`</span>  | No          | 831                            |</span>
<span id="cb146-465"><a href="#cb146-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-466"><a href="#cb146-466" aria-hidden="true" tabindex="-1"></a>**`harm_perc`**</span>
<span id="cb146-467"><a href="#cb146-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-468"><a href="#cb146-468" aria-hidden="true" tabindex="-1"></a>**To the participant, is using e-cigarettes less harmful, about the same, or more harmful than smoking cigarettes?**</span>
<span id="cb146-469"><a href="#cb146-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-470"><a href="#cb146-470" aria-hidden="true" tabindex="-1"></a>+---------------+-------------------------------+--------------------------------+</span>
<span id="cb146-471"><a href="#cb146-471" aria-hidden="true" tabindex="-1"></a>| Level         | Description                   | Distinct Observations in Level |</span>
<span id="cb146-472"><a href="#cb146-472" aria-hidden="true" tabindex="-1"></a>+===============+===============================+================================+</span>
<span id="cb146-473"><a href="#cb146-473" aria-hidden="true" tabindex="-1"></a>| <span class="in">`1`</span>           | Less harmful                  | 822                            |</span>
<span id="cb146-474"><a href="#cb146-474" aria-hidden="true" tabindex="-1"></a>+---------------+-------------------------------+--------------------------------+</span>
<span id="cb146-475"><a href="#cb146-475" aria-hidden="true" tabindex="-1"></a>| <span class="in">`2`</span>           | About the Same / More harmful | 366                            |</span>
<span id="cb146-476"><a href="#cb146-476" aria-hidden="true" tabindex="-1"></a>+---------------+-------------------------------+--------------------------------+</span>
<span id="cb146-477"><a href="#cb146-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-478"><a href="#cb146-478" aria-hidden="true" tabindex="-1"></a>**`price_paid`**</span>
<span id="cb146-479"><a href="#cb146-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-480"><a href="#cb146-480" aria-hidden="true" tabindex="-1"></a>**About how much did the participant pay for their e-cigarette?**</span>
<span id="cb146-481"><a href="#cb146-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-482"><a href="#cb146-482" aria-hidden="true" tabindex="-1"></a>| Level       | Description     | Distinct Observations in Level |</span>
<span id="cb146-483"><a href="#cb146-483" aria-hidden="true" tabindex="-1"></a>|-------------|-----------------|--------------------------------|</span>
<span id="cb146-484"><a href="#cb146-484" aria-hidden="true" tabindex="-1"></a>| <span class="in">`Below$10`</span>  | Less than \$10  | 189                            |</span>
<span id="cb146-485"><a href="#cb146-485" aria-hidden="true" tabindex="-1"></a>| <span class="in">`$10to$20`</span>  | \$10 to \$20    | 260                            |</span>
<span id="cb146-486"><a href="#cb146-486" aria-hidden="true" tabindex="-1"></a>| <span class="in">`$21to$100`</span> | \$21 to \$100   | 328                            |</span>
<span id="cb146-487"><a href="#cb146-487" aria-hidden="true" tabindex="-1"></a>| <span class="in">`&gt;$100`</span>     | More than \$100 | 30                             |</span>
<span id="cb146-488"><a href="#cb146-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-489"><a href="#cb146-489" aria-hidden="true" tabindex="-1"></a>**`ecig_nico`**</span>
<span id="cb146-490"><a href="#cb146-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-491"><a href="#cb146-491" aria-hidden="true" tabindex="-1"></a>**Does the e-cigarette the participant usually uses contain nicotine?**</span>
<span id="cb146-492"><a href="#cb146-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-493"><a href="#cb146-493" aria-hidden="true" tabindex="-1"></a>| Level | Description | Distinct Observations in Level |</span>
<span id="cb146-494"><a href="#cb146-494" aria-hidden="true" tabindex="-1"></a>|-------|-------------|--------------------------------|</span>
<span id="cb146-495"><a href="#cb146-495" aria-hidden="true" tabindex="-1"></a>| <span class="in">`yes`</span> | Yes         | 320                            |</span>
<span id="cb146-496"><a href="#cb146-496" aria-hidden="true" tabindex="-1"></a>| <span class="in">`no`</span>  | No          | 48                             |</span>
<span id="cb146-497"><a href="#cb146-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-498"><a href="#cb146-498" aria-hidden="true" tabindex="-1"></a>**`ecig_flavored`**</span>
<span id="cb146-499"><a href="#cb146-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-500"><a href="#cb146-500" aria-hidden="true" tabindex="-1"></a>**Is the regular/last brand of e-cigarettes used by the participant flavored to taste like menthol, mint, clove, spice, candy, fruit, chocolate, alcohol or other sweets?**</span>
<span id="cb146-501"><a href="#cb146-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-502"><a href="#cb146-502" aria-hidden="true" tabindex="-1"></a>| Level | Description | Distinct Observations in Level |</span>
<span id="cb146-503"><a href="#cb146-503" aria-hidden="true" tabindex="-1"></a>|-------|-------------|--------------------------------|</span>
<span id="cb146-504"><a href="#cb146-504" aria-hidden="true" tabindex="-1"></a>| <span class="in">`yes`</span> | Yes         | 246                            |</span>
<span id="cb146-505"><a href="#cb146-505" aria-hidden="true" tabindex="-1"></a>| <span class="in">`no`</span>  | No          | 123                            |</span>
<span id="cb146-506"><a href="#cb146-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-507"><a href="#cb146-507" aria-hidden="true" tabindex="-1"></a><span class="fu">## Numerical Description</span></span>
<span id="cb146-508"><a href="#cb146-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-509"><a href="#cb146-509" aria-hidden="true" tabindex="-1"></a>The <span class="in">`describe`</span> function from the <span class="in">`Hmisc`</span> package was used on the entire tibble.</span>
<span id="cb146-510"><a href="#cb146-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-513"><a href="#cb146-513" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-514"><a href="#cb146-514" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(data_final)</span>
<span id="cb146-515"><a href="#cb146-515" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-516"><a href="#cb146-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-517"><a href="#cb146-517" aria-hidden="true" tabindex="-1"></a><span class="fu"># Linear Regression Plans</span></span>
<span id="cb146-518"><a href="#cb146-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-519"><a href="#cb146-519" aria-hidden="true" tabindex="-1"></a><span class="fu">## My First Research Question</span></span>
<span id="cb146-520"><a href="#cb146-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-521"><a href="#cb146-521" aria-hidden="true" tabindex="-1"></a>*E-Cigarette Perception, Smoking Habits, and their association with Heavy E-Cigarette Use:*</span>
<span id="cb146-522"><a href="#cb146-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-523"><a href="#cb146-523" aria-hidden="true" tabindex="-1"></a>**Are smoking e-cigarettes that contain nicotine, the perception of the purported healthiness of e-cigarettes when compared to smoking regular cigarettes, and smoking habits strong predictors of heavy e-cigarette use in adulthood?**</span>
<span id="cb146-524"><a href="#cb146-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-525"><a href="#cb146-525" aria-hidden="true" tabindex="-1"></a><span class="fu">## My Quantitative Outcome</span></span>
<span id="cb146-526"><a href="#cb146-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-527"><a href="#cb146-527" aria-hidden="true" tabindex="-1"></a>The quantitative variable I will be predicting is <span class="in">`ecig_30day`</span>.</span>
<span id="cb146-528"><a href="#cb146-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-529"><a href="#cb146-529" aria-hidden="true" tabindex="-1"></a>In the United States, e-cigarettes are not subject to the same marketing and promotion restrictions that apply to cigarettes. E-cigarette companies are permitted to advertise their products through mass media, and via the internet. Previous studies have demonstrated that e-cigarettes companies exacerbate and expand the tobacco epidemic by bringing lower risk youth into the market.^<span class="sc">\[</span>1<span class="sc">\]</span>^ E-Cigarette use among young adults has been rapidly expanding, and has surpassed conventional cigarette use among young adults.^<span class="sc">\[</span>2<span class="sc">\]</span>^</span>
<span id="cb146-530"><a href="#cb146-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-531"><a href="#cb146-531" aria-hidden="true" tabindex="-1"></a>From a study conducted in 2017, while the demographic and behavioral risk profiles of most youth who reported smoking cigarettes (both cigarettes and e-cigarettes) are consistent with smoking cigarettes, the risk profiles of the remaining e-cigarette-only users (about 25% of e-cigarette users) suggested that these individuals would have been unlikely to have initiated tobacco product use with cigarettes.^<span class="sc">\[</span>3<span class="sc">\]</span>^</span>
<span id="cb146-532"><a href="#cb146-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-533"><a href="#cb146-533" aria-hidden="true" tabindex="-1"></a>E-cigarettes are reducing smoking cessation rates and expanding the nicotine market by attracting low-risk youth who would be unlikely to initiate nicotine use with conventional cigarettes.^<span class="sc">\[</span>4<span class="sc">\]</span>^</span>
<span id="cb146-534"><a href="#cb146-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-535"><a href="#cb146-535" aria-hidden="true" tabindex="-1"></a>By attempting to predict higher use of e-cigarettes in the past 30 days(at the time of data collection) with the variables under study, the association between e-cigarette perception and smoking habits with heavy e-cigarette use can be studied.</span>
<span id="cb146-536"><a href="#cb146-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-539"><a href="#cb146-539" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-540"><a href="#cb146-540" aria-hidden="true" tabindex="-1"></a>data_lin <span class="sc">|&gt;</span></span>
<span id="cb146-541"><a href="#cb146-541" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">complete.cases</span>(ecig_30day)) <span class="sc">|&gt;</span></span>
<span id="cb146-542"><a href="#cb146-542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>()</span>
<span id="cb146-543"><a href="#cb146-543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-544"><a href="#cb146-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-545"><a href="#cb146-545" aria-hidden="true" tabindex="-1"></a>Out of the 1200 rows in <span class="in">`data_lin`</span>, all 1200 have complete data on the outcome variable <span class="in">`ecig_30day`</span>.</span>
<span id="cb146-546"><a href="#cb146-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-547"><a href="#cb146-547" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width = 10, fig.height = 8}</span></span>
<span id="cb146-548"><a href="#cb146-548" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> </span>
<span id="cb146-549"><a href="#cb146-549" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_lin, <span class="fu">aes</span>(<span class="at">x =</span> ecig_30day)) <span class="sc">+</span></span>
<span id="cb146-550"><a href="#cb146-550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">15</span>, </span>
<span id="cb146-551"><a href="#cb146-551" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="st">"#2b8cbe"</span>, <span class="at">col =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb146-552"><a href="#cb146-552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x =</span> <span class="st">"Number of days used an e-cigarette"</span>, <span class="at">y =</span><span class="st">""</span>)</span>
<span id="cb146-553"><a href="#cb146-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-554"><a href="#cb146-554" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> </span>
<span id="cb146-555"><a href="#cb146-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_lin, <span class="fu">aes</span>(<span class="at">sample =</span> ecig_30day)) <span class="sc">+</span> </span>
<span id="cb146-556"><a href="#cb146-556" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>(<span class="at">col =</span> <span class="st">"#2b8cbe"</span>) <span class="sc">+</span> <span class="fu">geom_qq_line</span>(<span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb146-557"><a href="#cb146-557" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Number of days used an e-cigarette"</span>)</span>
<span id="cb146-558"><a href="#cb146-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-559"><a href="#cb146-559" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> </span>
<span id="cb146-560"><a href="#cb146-560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_lin, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> ecig_30day)) <span class="sc">+</span></span>
<span id="cb146-561"><a href="#cb146-561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="st">"#2b8cbe"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb146-562"><a href="#cb146-562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"#2b8cbe"</span>, <span class="at">width =</span> <span class="fl">0.3</span>,</span>
<span id="cb146-563"><a href="#cb146-563" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb146-564"><a href="#cb146-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Number of days used an e-cigarette"</span>, <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">coord_flip</span>()</span>
<span id="cb146-565"><a href="#cb146-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-566"><a href="#cb146-566" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span> p1 <span class="sc">-</span> p3 <span class="sc">+</span></span>
<span id="cb146-567"><a href="#cb146-567" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">height =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb146-568"><a href="#cb146-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"Distribution of the number of days participants used an e-cigarette in the past 30 days"</span>,</span>
<span id="cb146-569"><a href="#cb146-569" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">glue</span>(<span class="st">"Across "</span>, <span class="fu">nrow</span>(data_lin), </span>
<span id="cb146-570"><a href="#cb146-570" aria-hidden="true" tabindex="-1"></a>                           <span class="st">" participants, taken as a random sample from the DS1001 dataset."</span>),</span>
<span id="cb146-571"><a href="#cb146-571" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"Data taken from the Population Assessment of Tobacco and Health (PATH) Study."</span>)</span>
<span id="cb146-572"><a href="#cb146-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-573"><a href="#cb146-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-574"><a href="#cb146-574" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-575"><a href="#cb146-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-576"><a href="#cb146-576" aria-hidden="true" tabindex="-1"></a>The distribution is very notably right skewed. Taking the logarithm of the outcome variable might help in making it's distribution more normalized.</span>
<span id="cb146-577"><a href="#cb146-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-580"><a href="#cb146-580" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-581"><a href="#cb146-581" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(data_lin<span class="sc">$</span>ecig_30day)</span>
<span id="cb146-582"><a href="#cb146-582" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-583"><a href="#cb146-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-584"><a href="#cb146-584" aria-hidden="true" tabindex="-1"></a>The <span class="in">`describe`</span> function shows that there are 28 distinct values for the <span class="in">`ecig_30day`</span> variable, and the variable has at least 10 different, ordered, observed values.</span>
<span id="cb146-585"><a href="#cb146-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-586"><a href="#cb146-586" aria-hidden="true" tabindex="-1"></a><span class="fu">## My Planned Predictors (Linear Model)</span></span>
<span id="cb146-587"><a href="#cb146-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-588"><a href="#cb146-588" aria-hidden="true" tabindex="-1"></a>The inputs that will be used in the linear regression model are:</span>
<span id="cb146-589"><a href="#cb146-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-590"><a href="#cb146-590" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`puff_num`</span>: This is a quantitative variable that has atleast 10 distinct, ordered, observed values.</span>
<span id="cb146-591"><a href="#cb146-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-594"><a href="#cb146-594" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-595"><a href="#cb146-595" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(data_lin<span class="sc">$</span>puff_num)</span>
<span id="cb146-596"><a href="#cb146-596" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-597"><a href="#cb146-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-598"><a href="#cb146-598" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`age_range`</span>: This is a categorical variable which has 6 categories, that has at least 30 observations in each level of the factor.</span>
<span id="cb146-599"><a href="#cb146-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-602"><a href="#cb146-602" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-603"><a href="#cb146-603" aria-hidden="true" tabindex="-1"></a>data_lin<span class="sc">|&gt;</span></span>
<span id="cb146-604"><a href="#cb146-604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(age_range) <span class="sc">|&gt;</span></span>
<span id="cb146-605"><a href="#cb146-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-606"><a href="#cb146-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-607"><a href="#cb146-607" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-608"><a href="#cb146-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-609"><a href="#cb146-609" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`less_harm`</span>, which is a binary categorical variable.</span>
<span id="cb146-610"><a href="#cb146-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-613"><a href="#cb146-613" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-614"><a href="#cb146-614" aria-hidden="true" tabindex="-1"></a>data_lin<span class="sc">|&gt;</span></span>
<span id="cb146-615"><a href="#cb146-615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(less_harm) <span class="sc">|&gt;</span></span>
<span id="cb146-616"><a href="#cb146-616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-617"><a href="#cb146-617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-618"><a href="#cb146-618" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-619"><a href="#cb146-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-620"><a href="#cb146-620" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`ecig_nico`</span>, which is a binary categorical variable.</span>
<span id="cb146-621"><a href="#cb146-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-624"><a href="#cb146-624" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-625"><a href="#cb146-625" aria-hidden="true" tabindex="-1"></a>data_lin<span class="sc">|&gt;</span></span>
<span id="cb146-626"><a href="#cb146-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(ecig_nico)<span class="sc">|&gt;</span></span>
<span id="cb146-627"><a href="#cb146-627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-628"><a href="#cb146-628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-629"><a href="#cb146-629" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-630"><a href="#cb146-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-631"><a href="#cb146-631" aria-hidden="true" tabindex="-1"></a>There are a total of 4 predictors.</span>
<span id="cb146-632"><a href="#cb146-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-635"><a href="#cb146-635" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-636"><a href="#cb146-636" aria-hidden="true" tabindex="-1"></a>datatest1 <span class="ot">&lt;-</span> data_lin <span class="sc">|&gt;</span></span>
<span id="cb146-637"><a href="#cb146-637" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">complete.cases</span>(personid,ecig_30day,puff_num,age_range,less_harm,ecig_nico)) <span class="sc">|&gt;</span></span>
<span id="cb146-638"><a href="#cb146-638" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(personid,ecig_30day,puff_num,age_range,less_harm,ecig_nico)</span>
<span id="cb146-639"><a href="#cb146-639" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(datatest1)</span>
<span id="cb146-640"><a href="#cb146-640" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-641"><a href="#cb146-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-642"><a href="#cb146-642" aria-hidden="true" tabindex="-1"></a>With 137 rows having complete observations on all the variables under study, **\[4 + (N1 - 100)/100\]** is 4.3, and the number of predictors does not exceed this value.</span>
<span id="cb146-643"><a href="#cb146-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-644"><a href="#cb146-644" aria-hidden="true" tabindex="-1"></a>From the cited literature,</span>
<span id="cb146-645"><a href="#cb146-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-646"><a href="#cb146-646" aria-hidden="true" tabindex="-1"></a>I expect higher values of <span class="in">`puff_num`</span> to be associated with higher values of <span class="in">`ecig_30day`</span>. For <span class="in">`less_harm`</span> and <span class="in">`ecig_nico`</span>, I expect the <span class="in">`yes`</span> factor to be associated with higher values of <span class="in">`ecig_30day`</span>, ie, as the two variables change from <span class="in">`no`</span> to <span class="in">`yes`</span>, the value of <span class="in">`ecig_30day`</span> is expected to increase.</span>
<span id="cb146-647"><a href="#cb146-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-648"><a href="#cb146-648" aria-hidden="true" tabindex="-1"></a>I expect the lower levels of <span class="in">`age_range`</span> to be associated with higher values of <span class="in">`ecig_30day`</span>, ie, as <span class="in">`age_range`</span> factors go from the lowest factors to the higher factors, I expect <span class="in">`ecig_30day`</span> to decrease.</span>
<span id="cb146-649"><a href="#cb146-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-650"><a href="#cb146-650" aria-hidden="true" tabindex="-1"></a><span class="fu"># Logistic Regression Plans</span></span>
<span id="cb146-651"><a href="#cb146-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-652"><a href="#cb146-652" aria-hidden="true" tabindex="-1"></a><span class="fu">## My Second Research Question</span></span>
<span id="cb146-653"><a href="#cb146-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-654"><a href="#cb146-654" aria-hidden="true" tabindex="-1"></a>*Regular e-cigarette use and it's associated factors:*</span>
<span id="cb146-655"><a href="#cb146-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-656"><a href="#cb146-656" aria-hidden="true" tabindex="-1"></a>**Are factors such as using flavored e-cigarettes, or needing to use e-cigarettes immediately after waking up, or using e-cigarettes with nicotine, or use of e-cigarettes as a healthier alternative to regular cigarettes associated with regular e-cigarette use?**</span>
<span id="cb146-657"><a href="#cb146-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-658"><a href="#cb146-658" aria-hidden="true" tabindex="-1"></a><span class="fu">## My Binary Outcome</span></span>
<span id="cb146-659"><a href="#cb146-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-660"><a href="#cb146-660" aria-hidden="true" tabindex="-1"></a>The binary outcome I will be predicting is <span class="in">`ecig_reg`</span>.</span>
<span id="cb146-661"><a href="#cb146-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-662"><a href="#cb146-662" aria-hidden="true" tabindex="-1"></a>In the United States, e-cigarettes and their market value have rapidly expanded over the past years.^<span class="sc">\[</span>2<span class="sc">\]</span>^ E-cigarette use and it's prevalent adoption have resulted in youth and young adults who would otherwise not have been exposed to nicotine/tobacco products to begin the use of the drug via e-cigarettes.^<span class="sc">\[</span>3<span class="sc">\]</span>^</span>
<span id="cb146-663"><a href="#cb146-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-664"><a href="#cb146-664" aria-hidden="true" tabindex="-1"></a>Reasons for this increased use of e-cigarettes are many, including the perception of e-cigarettes as being healthier than regular cigarettes, the presence of flavored e-cigarettes available for use, and the availability of cheap, refillable cartridges that only require e-cigarette fluid.^<span class="sc">\[</span>1<span class="sc">\]</span>^ By attempting to predict the odds of being a regular user of e-cigarettes using the predictors under study, the association between these factors and the odds of adoption of regular e-cigarette use can be more thoroughly studied.</span>
<span id="cb146-665"><a href="#cb146-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-668"><a href="#cb146-668" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-669"><a href="#cb146-669" aria-hidden="true" tabindex="-1"></a>data_log<span class="sc">|&gt;</span></span>
<span id="cb146-670"><a href="#cb146-670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(ecig_reg)<span class="sc">|&gt;</span></span>
<span id="cb146-671"><a href="#cb146-671" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-672"><a href="#cb146-672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-673"><a href="#cb146-673" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-674"><a href="#cb146-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-675"><a href="#cb146-675" aria-hidden="true" tabindex="-1"></a>There are no missing values for the outcome variable.</span>
<span id="cb146-676"><a href="#cb146-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-677"><a href="#cb146-677" aria-hidden="true" tabindex="-1"></a><span class="fu">## My Planned Predictors (Logistic Model)</span></span>
<span id="cb146-678"><a href="#cb146-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-679"><a href="#cb146-679" aria-hidden="true" tabindex="-1"></a>For the logistic regression model, the following are the predictors I intend to use:</span>
<span id="cb146-680"><a href="#cb146-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-681"><a href="#cb146-681" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`min_num`</span>: This is a quantitative variable that has atleast 10 distinct, ordered, observed values.</span>
<span id="cb146-682"><a href="#cb146-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-685"><a href="#cb146-685" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-686"><a href="#cb146-686" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(data_log<span class="sc">$</span>min_num)</span>
<span id="cb146-687"><a href="#cb146-687" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-688"><a href="#cb146-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-689"><a href="#cb146-689" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`price_paid`</span>: This is a categorical variable which has 4 categories, that has at least 30 observations in each level of the factor.</span>
<span id="cb146-690"><a href="#cb146-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-693"><a href="#cb146-693" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-694"><a href="#cb146-694" aria-hidden="true" tabindex="-1"></a>data_log <span class="sc">|&gt;</span></span>
<span id="cb146-695"><a href="#cb146-695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(price_paid)<span class="sc">|&gt;</span></span>
<span id="cb146-696"><a href="#cb146-696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-697"><a href="#cb146-697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-698"><a href="#cb146-698" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-699"><a href="#cb146-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-700"><a href="#cb146-700" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`harm_perc`</span>, which is a binary categorical variable.</span>
<span id="cb146-701"><a href="#cb146-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-704"><a href="#cb146-704" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-705"><a href="#cb146-705" aria-hidden="true" tabindex="-1"></a>data_log <span class="sc">|&gt;</span></span>
<span id="cb146-706"><a href="#cb146-706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(harm_perc)<span class="sc">|&gt;</span></span>
<span id="cb146-707"><a href="#cb146-707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-708"><a href="#cb146-708" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-709"><a href="#cb146-709" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-710"><a href="#cb146-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-711"><a href="#cb146-711" aria-hidden="true" tabindex="-1"></a><span class="sc">\-</span><span class="in">`ecig_nico`</span>, which is a binary categorical variable.</span>
<span id="cb146-712"><a href="#cb146-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-715"><a href="#cb146-715" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-716"><a href="#cb146-716" aria-hidden="true" tabindex="-1"></a>data_log <span class="sc">|&gt;</span></span>
<span id="cb146-717"><a href="#cb146-717" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(ecig_nico)<span class="sc">|&gt;</span></span>
<span id="cb146-718"><a href="#cb146-718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-719"><a href="#cb146-719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-720"><a href="#cb146-720" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-721"><a href="#cb146-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-722"><a href="#cb146-722" aria-hidden="true" tabindex="-1"></a><span class="sc">\-</span><span class="in">`ecig_flavored`</span>, which is a binary categorical variable.</span>
<span id="cb146-723"><a href="#cb146-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-726"><a href="#cb146-726" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-727"><a href="#cb146-727" aria-hidden="true" tabindex="-1"></a>data_log <span class="sc">|&gt;</span></span>
<span id="cb146-728"><a href="#cb146-728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(ecig_flavored)<span class="sc">|&gt;</span></span>
<span id="cb146-729"><a href="#cb146-729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-730"><a href="#cb146-730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-731"><a href="#cb146-731" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-732"><a href="#cb146-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-733"><a href="#cb146-733" aria-hidden="true" tabindex="-1"></a>There are 5 predictors.</span>
<span id="cb146-734"><a href="#cb146-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-735"><a href="#cb146-735" aria-hidden="true" tabindex="-1"></a>With 369 subjects in the smaller of my two outcome groups, **\[4 + (N2 - 100)/100\]** is 6.69, and the number of predictors does not exceed this value.</span>
<span id="cb146-736"><a href="#cb146-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-737"><a href="#cb146-737" aria-hidden="true" tabindex="-1"></a>From the cited literature,</span>
<span id="cb146-738"><a href="#cb146-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-739"><a href="#cb146-739" aria-hidden="true" tabindex="-1"></a>I expect lower values of <span class="in">`min_num`</span> to be associated with higher odds of being in the <span class="in">`yes`</span> category of <span class="in">`ecig_reg`</span>.I also expect lower values of <span class="in">`price_paid`</span> to be associated with higher odds of being in the <span class="in">`yes`</span> category of <span class="in">`ecig_reg`</span>. I also expect <span class="in">`yes`</span> values for <span class="in">`ecig_nico`</span> and <span class="in">`ecig_flavored`</span> to be associated with higher odds of being in the <span class="in">`yes`</span> category of <span class="in">`ecig_reg`</span>. I expect <span class="in">`less_harm`</span> values for <span class="in">`harm_perc`</span> to be associated with higher odds of being in the <span class="in">`yes`</span> category of <span class="in">`ecig_reg`</span>.</span>
<span id="cb146-740"><a href="#cb146-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-741"><a href="#cb146-741" aria-hidden="true" tabindex="-1"></a><span class="fu"># Linear Regression Analyses</span></span>
<span id="cb146-742"><a href="#cb146-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-743"><a href="#cb146-743" aria-hidden="true" tabindex="-1"></a><span class="fu">## Missingness</span></span>
<span id="cb146-744"><a href="#cb146-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-747"><a href="#cb146-747" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-748"><a href="#cb146-748" aria-hidden="true" tabindex="-1"></a>data_lin <span class="sc">|&gt;</span></span>
<span id="cb146-749"><a href="#cb146-749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">miss_var_summary</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-750"><a href="#cb146-750" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-751"><a href="#cb146-751" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-752"><a href="#cb146-752" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb146-753"><a href="#cb146-753" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-754"><a href="#cb146-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-755"><a href="#cb146-755" aria-hidden="true" tabindex="-1"></a>There is missing data in all of the variables under study, and the outcome variable <span class="in">`ecig_30day`</span> does not have any missing values. There are missing predictor values for more than 10% of the subjects under study, and more than 50 subjects have missing values. </span>
<span id="cb146-756"><a href="#cb146-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-757"><a href="#cb146-757" aria-hidden="true" tabindex="-1"></a>The data can be assumed to be MAR (Missing At Random), since the missing data are not randomly distributed. It cannot be assumed to be MNAR (Missing Not At Random) since there does not appear to be a relationship between the magnitude of a value and it's missingness (or inclusion in the non-missing data), since there is no preponderance of values with lower or higher magnitude being missing. </span>
<span id="cb146-758"><a href="#cb146-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-759"><a href="#cb146-759" aria-hidden="true" tabindex="-1"></a>Single imputation was then performed on the dataset, to account for missingness. The complete dataset, containing the data for both the analyses had it's missing values imputed. </span>
<span id="cb146-760"><a href="#cb146-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-763"><a href="#cb146-763" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-764"><a href="#cb146-764" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4322023</span>)</span>
<span id="cb146-765"><a href="#cb146-765" aria-hidden="true" tabindex="-1"></a>data_final_i <span class="ot">&lt;-</span> data_final <span class="sc">|&gt;</span> <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-766"><a href="#cb146-766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">impute_rhd</span>(less_harm <span class="sc">~</span> ecig_30day <span class="sc">+</span> ecig_reg) <span class="sc">|&gt;</span></span>
<span id="cb146-767"><a href="#cb146-767" aria-hidden="true" tabindex="-1"></a>  <span class="fu">impute_rhd</span>(age_range <span class="sc">~</span> ecig_30day <span class="sc">+</span> ecig_reg <span class="sc">+</span> less_harm) <span class="sc">|&gt;</span></span>
<span id="cb146-768"><a href="#cb146-768" aria-hidden="true" tabindex="-1"></a>  <span class="fu">impute_rhd</span>(ecig_nico <span class="sc">~</span> age_range ) <span class="sc">|&gt;</span></span>
<span id="cb146-769"><a href="#cb146-769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">impute_rlm</span>(puff_num <span class="sc">~</span> ecig_30day ) <span class="sc">|&gt;</span></span>
<span id="cb146-770"><a href="#cb146-770" aria-hidden="true" tabindex="-1"></a>  <span class="fu">impute_cart</span>(harm_perc <span class="sc">~</span> ecig_reg) <span class="sc">|&gt;</span></span>
<span id="cb146-771"><a href="#cb146-771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">impute_cart</span>(price_paid <span class="sc">~</span> ecig_reg <span class="sc">+</span> harm_perc) <span class="sc">|&gt;</span></span>
<span id="cb146-772"><a href="#cb146-772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">impute_cart</span>(ecig_flavored <span class="sc">~</span> ecig_reg <span class="sc">+</span> price_paid) <span class="sc">|&gt;</span></span>
<span id="cb146-773"><a href="#cb146-773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">impute_cart</span>(ecig_nico <span class="sc">~</span> ecig_reg <span class="sc">+</span> ecig_flavored) <span class="sc">|&gt;</span></span>
<span id="cb146-774"><a href="#cb146-774" aria-hidden="true" tabindex="-1"></a>  <span class="fu">impute_pmm</span>(min_num <span class="sc">~</span> ecig_30day <span class="sc">+</span> age_range <span class="sc">+</span> less_harm) <span class="sc">|&gt;</span></span>
<span id="cb146-775"><a href="#cb146-775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb146-776"><a href="#cb146-776" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-777"><a href="#cb146-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-780"><a href="#cb146-780" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-781"><a href="#cb146-781" aria-hidden="true" tabindex="-1"></a>data_lin_i <span class="ot">&lt;-</span> data_final_i <span class="sc">|&gt;</span></span>
<span id="cb146-782"><a href="#cb146-782" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(personid,ecig_30day,puff_num,ecig_nico,age_range,less_harm)</span>
<span id="cb146-783"><a href="#cb146-783" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-784"><a href="#cb146-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-785"><a href="#cb146-785" aria-hidden="true" tabindex="-1"></a>The imputed dataset was then checked to see if it was still missing any values. </span>
<span id="cb146-786"><a href="#cb146-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-789"><a href="#cb146-789" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-790"><a href="#cb146-790" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_summary</span>(data_lin_i) <span class="sc">|&gt;</span></span>
<span id="cb146-791"><a href="#cb146-791" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-792"><a href="#cb146-792" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-793"><a href="#cb146-793" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-794"><a href="#cb146-794" aria-hidden="true" tabindex="-1"></a><span class="fu">## Outcome Transformation</span></span>
<span id="cb146-795"><a href="#cb146-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-796"><a href="#cb146-796" aria-hidden="true" tabindex="-1"></a>The distribution of the outcome variable was plotted. </span>
<span id="cb146-797"><a href="#cb146-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-798"><a href="#cb146-798" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width = 10, fig.height = 8}</span></span>
<span id="cb146-799"><a href="#cb146-799" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> </span>
<span id="cb146-800"><a href="#cb146-800" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_lin_i, <span class="fu">aes</span>(<span class="at">x =</span> ecig_30day)) <span class="sc">+</span></span>
<span id="cb146-801"><a href="#cb146-801" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">15</span>, </span>
<span id="cb146-802"><a href="#cb146-802" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="st">"#2b8cbe"</span>, <span class="at">col =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb146-803"><a href="#cb146-803" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x =</span> <span class="st">"Number of days used an e-cigarette"</span>, <span class="at">y =</span><span class="st">""</span>)</span>
<span id="cb146-804"><a href="#cb146-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-805"><a href="#cb146-805" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> </span>
<span id="cb146-806"><a href="#cb146-806" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_lin_i, <span class="fu">aes</span>(<span class="at">sample =</span> ecig_30day)) <span class="sc">+</span> </span>
<span id="cb146-807"><a href="#cb146-807" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>(<span class="at">col =</span> <span class="st">"#2b8cbe"</span>) <span class="sc">+</span> <span class="fu">geom_qq_line</span>(<span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb146-808"><a href="#cb146-808" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Number of days used an e-cigarette"</span>)</span>
<span id="cb146-809"><a href="#cb146-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-810"><a href="#cb146-810" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> </span>
<span id="cb146-811"><a href="#cb146-811" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_lin_i, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> ecig_30day)) <span class="sc">+</span></span>
<span id="cb146-812"><a href="#cb146-812" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="st">"#2b8cbe"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb146-813"><a href="#cb146-813" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"#2b8cbe"</span>, <span class="at">width =</span> <span class="fl">0.3</span>,</span>
<span id="cb146-814"><a href="#cb146-814" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb146-815"><a href="#cb146-815" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Number of days used an e-cigarette"</span>, <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">coord_flip</span>()</span>
<span id="cb146-816"><a href="#cb146-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-817"><a href="#cb146-817" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span> p1 <span class="sc">-</span> p3 <span class="sc">+</span></span>
<span id="cb146-818"><a href="#cb146-818" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">height =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb146-819"><a href="#cb146-819" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"Distribution of the number of days participants used an e-cigarette in the past 30 days"</span>,</span>
<span id="cb146-820"><a href="#cb146-820" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">glue</span>(<span class="st">"Across "</span>, <span class="fu">nrow</span>(data_lin_i), </span>
<span id="cb146-821"><a href="#cb146-821" aria-hidden="true" tabindex="-1"></a>                           <span class="st">" participants, taken as a random sample from the DS1001 dataset."</span>),</span>
<span id="cb146-822"><a href="#cb146-822" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"Data taken from the Population Assessment of Tobacco and Health (PATH) Study."</span>)</span>
<span id="cb146-823"><a href="#cb146-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-824"><a href="#cb146-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-825"><a href="#cb146-825" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-826"><a href="#cb146-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-827"><a href="#cb146-827" aria-hidden="true" tabindex="-1"></a>The outcome variable was modified so that the data would be strictly positive, making it possible to assess the need for transformation. 1 was added to each value. </span>
<span id="cb146-828"><a href="#cb146-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-829"><a href="#cb146-829" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message =  FALSE}</span></span>
<span id="cb146-830"><a href="#cb146-830" aria-hidden="true" tabindex="-1"></a>data_lin_i <span class="ot">&lt;-</span> data_lin_i <span class="sc">|&gt;</span></span>
<span id="cb146-831"><a href="#cb146-831" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">int_ecig_30day =</span> ecig_30day <span class="sc">+</span> <span class="dv">1</span>) </span>
<span id="cb146-832"><a href="#cb146-832" aria-hidden="true" tabindex="-1"></a><span class="fu">boxCox</span>(data_lin_i<span class="sc">$</span>int_ecig_30day <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb146-833"><a href="#cb146-833" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-834"><a href="#cb146-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-837"><a href="#cb146-837" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-838"><a href="#cb146-838" aria-hidden="true" tabindex="-1"></a><span class="fu">powerTransform</span>(data_lin_i<span class="sc">$</span>int_ecig_30day <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb146-839"><a href="#cb146-839" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-840"><a href="#cb146-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-841"><a href="#cb146-841" aria-hidden="true" tabindex="-1"></a>The Box-Cox plot peaks at a Y value of -0.19, which is approximately close enough to -1 to justify using -1 on Tukey's ladder of power transformations, which suggests taking the inverse of the outcome. </span>
<span id="cb146-842"><a href="#cb146-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-843"><a href="#cb146-843" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width = 10, fig.height = 8}</span></span>
<span id="cb146-844"><a href="#cb146-844" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> </span>
<span id="cb146-845"><a href="#cb146-845" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_lin_i, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(int_ecig_30day))) <span class="sc">+</span></span>
<span id="cb146-846"><a href="#cb146-846" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">15</span>, </span>
<span id="cb146-847"><a href="#cb146-847" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="st">"#2b8cbe"</span>, <span class="at">col =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb146-848"><a href="#cb146-848" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x =</span> <span class="st">"Natural Logarithm of the Number of days participant used an e-cigarette"</span>, <span class="at">y =</span><span class="st">""</span>)</span>
<span id="cb146-849"><a href="#cb146-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-850"><a href="#cb146-850" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> </span>
<span id="cb146-851"><a href="#cb146-851" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_lin_i, <span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">log</span>(int_ecig_30day))) <span class="sc">+</span> </span>
<span id="cb146-852"><a href="#cb146-852" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>(<span class="at">col =</span> <span class="st">"#2b8cbe"</span>) <span class="sc">+</span> <span class="fu">geom_qq_line</span>(<span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb146-853"><a href="#cb146-853" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">str_wrap</span>(<span class="st">"Natural Logarithm of the Number of days participant used an e-cigarette"</span>, <span class="at">width =</span> <span class="dv">50</span>))</span>
<span id="cb146-854"><a href="#cb146-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-855"><a href="#cb146-855" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> </span>
<span id="cb146-856"><a href="#cb146-856" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_lin_i, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">log</span>(int_ecig_30day))) <span class="sc">+</span></span>
<span id="cb146-857"><a href="#cb146-857" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="st">"#2b8cbe"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb146-858"><a href="#cb146-858" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"#2b8cbe"</span>, <span class="at">width =</span> <span class="fl">0.3</span>,</span>
<span id="cb146-859"><a href="#cb146-859" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb146-860"><a href="#cb146-860" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Natural Logarithm of the Number of days participant used an e-cigarette"</span>, <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">coord_flip</span>()</span>
<span id="cb146-861"><a href="#cb146-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-862"><a href="#cb146-862" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span> p1 <span class="sc">-</span> p3 <span class="sc">+</span></span>
<span id="cb146-863"><a href="#cb146-863" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">height =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb146-864"><a href="#cb146-864" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"Distribution of the natural logarithm of the number of days participants used an e-cigarette in the past 30 days"</span>,</span>
<span id="cb146-865"><a href="#cb146-865" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">glue</span>(<span class="st">"Across "</span>, <span class="fu">nrow</span>(data_lin_i), </span>
<span id="cb146-866"><a href="#cb146-866" aria-hidden="true" tabindex="-1"></a>                           <span class="st">" participants, taken as a random sample from the DS1001 dataset."</span>),</span>
<span id="cb146-867"><a href="#cb146-867" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"Data taken from the Population Assessment of Tobacco and Health (PATH) Study."</span>)</span>
<span id="cb146-868"><a href="#cb146-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-869"><a href="#cb146-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-870"><a href="#cb146-870" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-871"><a href="#cb146-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-872"><a href="#cb146-872" aria-hidden="true" tabindex="-1"></a><span class="fu">## Scatterplot Matrix and Collinearity</span></span>
<span id="cb146-873"><a href="#cb146-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-874"><a href="#cb146-874" aria-hidden="true" tabindex="-1"></a>A new variable <span class="in">`log_ecig_30day`</span> was created by taking the natural logarithm of the outcome variable, which itself was modified by adding 1 to each of it's values. </span>
<span id="cb146-875"><a href="#cb146-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-878"><a href="#cb146-878" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-879"><a href="#cb146-879" aria-hidden="true" tabindex="-1"></a>data_lin_i <span class="ot">&lt;-</span> data_lin_i <span class="sc">|&gt;</span></span>
<span id="cb146-880"><a href="#cb146-880" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_ecig_30day =</span> <span class="fu">log</span>(int_ecig_30day))</span>
<span id="cb146-881"><a href="#cb146-881" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-882"><a href="#cb146-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-883"><a href="#cb146-883" aria-hidden="true" tabindex="-1"></a>The <span class="in">`ggpairs`</span> function was used to plot a scatterplot matrix.</span>
<span id="cb146-884"><a href="#cb146-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-885"><a href="#cb146-885" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message = FALSE, fig.height = 8, fig.width = 8}</span></span>
<span id="cb146-886"><a href="#cb146-886" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(data_lin_i, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"puff_num"</span>, <span class="st">"age_range"</span>, <span class="st">"less_harm"</span>, </span>
<span id="cb146-887"><a href="#cb146-887" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"ecig_nico"</span>, <span class="st">"log_ecig_30day"</span>))</span>
<span id="cb146-888"><a href="#cb146-888" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-889"><a href="#cb146-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-890"><a href="#cb146-890" aria-hidden="true" tabindex="-1"></a><span class="in">`mod_A`</span> was fit using the <span class="in">`lm`</span> function. The <span class="in">`vif`</span> function from the <span class="in">`car`</span> package was used to estimate if the variables had significant collinearity with each other. </span>
<span id="cb146-891"><a href="#cb146-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-894"><a href="#cb146-894" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-895"><a href="#cb146-895" aria-hidden="true" tabindex="-1"></a>mod_A_car <span class="ot">&lt;-</span> <span class="fu">lm</span>(ecig_30day <span class="sc">~</span> puff_num <span class="sc">+</span> age_range <span class="sc">+</span> less_harm <span class="sc">+</span> ecig_nico, <span class="at">data =</span> data_lin_i )</span>
<span id="cb146-896"><a href="#cb146-896" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">vif</span>(mod_A_car)</span>
<span id="cb146-897"><a href="#cb146-897" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-898"><a href="#cb146-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-899"><a href="#cb146-899" aria-hidden="true" tabindex="-1"></a>From the output, the variables do not seem to have significant collinearity with each other.</span>
<span id="cb146-900"><a href="#cb146-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-901"><a href="#cb146-901" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model A</span></span>
<span id="cb146-902"><a href="#cb146-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-903"><a href="#cb146-903" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fitting Model A</span></span>
<span id="cb146-904"><a href="#cb146-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-905"><a href="#cb146-905" aria-hidden="true" tabindex="-1"></a>Model A was fit using both <span class="in">`lm`</span> and <span class="in">`ols`</span>. The outcome variable is <span class="in">`log_ecig_30day`</span>, and the predictors are <span class="in">`puff_num`</span> (A Quantitative variable), <span class="in">`age_range`</span> (A multi-categorical variable), <span class="in">`less_harm`</span> and <span class="in">`ecig_nico`</span>(both binary variables). </span>
<span id="cb146-906"><a href="#cb146-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-909"><a href="#cb146-909" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-910"><a href="#cb146-910" aria-hidden="true" tabindex="-1"></a>mod_A <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_ecig_30day <span class="sc">~</span> puff_num <span class="sc">+</span> age_range <span class="sc">+</span> less_harm <span class="sc">+</span> ecig_nico, <span class="at">data =</span> data_lin_i )</span>
<span id="cb146-911"><a href="#cb146-911" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-912"><a href="#cb146-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-915"><a href="#cb146-915" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-916"><a href="#cb146-916" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">datadist</span>(data_lin_i)</span>
<span id="cb146-917"><a href="#cb146-917" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">datadist =</span> <span class="st">"dd"</span>)</span>
<span id="cb146-918"><a href="#cb146-918" aria-hidden="true" tabindex="-1"></a>mod_A_ols <span class="ot">&lt;-</span> <span class="fu">ols</span>(log_ecig_30day <span class="sc">~</span> puff_num <span class="sc">+</span> age_range <span class="sc">+</span> less_harm <span class="sc">+</span> ecig_nico, <span class="at">data =</span> data_lin_i, </span>
<span id="cb146-919"><a href="#cb146-919" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x =</span> <span class="cn">TRUE</span>, <span class="at">y =</span> <span class="cn">TRUE</span> )</span>
<span id="cb146-920"><a href="#cb146-920" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-921"><a href="#cb146-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-922"><a href="#cb146-922" aria-hidden="true" tabindex="-1"></a><span class="fu">### Tidied Coefficient Estimates (Model A)</span></span>
<span id="cb146-923"><a href="#cb146-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-924"><a href="#cb146-924" aria-hidden="true" tabindex="-1"></a>With confidence levels of 90%, the lm model (<span class="in">`mod_A`</span>) had it's coefficients tidied and placed in a table that was presented using <span class="in">`kable`</span>.</span>
<span id="cb146-925"><a href="#cb146-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-928"><a href="#cb146-928" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-929"><a href="#cb146-929" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(mod_A, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.90</span>) <span class="sc">|&gt;</span></span>
<span id="cb146-930"><a href="#cb146-930" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, <span class="at">se =</span> std.error, </span>
<span id="cb146-931"><a href="#cb146-931" aria-hidden="true" tabindex="-1"></a>         <span class="at">low90 =</span> conf.low, <span class="at">high90 =</span> conf.high, </span>
<span id="cb146-932"><a href="#cb146-932" aria-hidden="true" tabindex="-1"></a>         <span class="at">p =</span> p.value) <span class="sc">|&gt;</span></span>
<span id="cb146-933"><a href="#cb146-933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb146-934"><a href="#cb146-934" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-935"><a href="#cb146-935" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb146-936"><a href="#cb146-936" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-937"><a href="#cb146-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-938"><a href="#cb146-938" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summarizing Fit (Model A)</span></span>
<span id="cb146-939"><a href="#cb146-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-940"><a href="#cb146-940" aria-hidden="true" tabindex="-1"></a>Using the <span class="in">`glance`</span> function. the numerical summaries of <span class="in">`mod_A`</span>'s fit were placed in a table.</span>
<span id="cb146-941"><a href="#cb146-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-944"><a href="#cb146-944" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-945"><a href="#cb146-945" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(mod_A) <span class="sc">|&gt;</span></span>
<span id="cb146-946"><a href="#cb146-946" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">r2 =</span> r.squared, <span class="at">adjr2 =</span> adj.r.squared, sigma, </span>
<span id="cb146-947"><a href="#cb146-947" aria-hidden="true" tabindex="-1"></a>         AIC, BIC, nobs, df, df.residual) <span class="sc">|&gt;</span></span>
<span id="cb146-948"><a href="#cb146-948" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))<span class="sc">|&gt;</span></span>
<span id="cb146-949"><a href="#cb146-949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-950"><a href="#cb146-950" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-951"><a href="#cb146-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-952"><a href="#cb146-952" aria-hidden="true" tabindex="-1"></a><span class="fu">### Regression Diagnostics (Model A)</span></span>
<span id="cb146-953"><a href="#cb146-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-954"><a href="#cb146-954" aria-hidden="true" tabindex="-1"></a>The four main diagnostic residual plots were visualized. </span>
<span id="cb146-955"><a href="#cb146-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-956"><a href="#cb146-956" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width = 8}</span></span>
<span id="cb146-957"><a href="#cb146-957" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)); <span class="fu">plot</span>(mod_A); <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb146-958"><a href="#cb146-958" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-959"><a href="#cb146-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-960"><a href="#cb146-960" aria-hidden="true" tabindex="-1"></a>From the normal Q-Q plot, there appears to be serious problems with the assumption of normality, despite the transformation of the outcome variable. There is also a definite pattern in the residuals vs fitted values plot, which has implications regarding the assumption of linearity. The scale-location plot also has a definite non-linear pattern, indicating problems with the assumption of constant variance. </span>
<span id="cb146-961"><a href="#cb146-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-962"><a href="#cb146-962" aria-hidden="true" tabindex="-1"></a><span class="fu">## Non-Linearity</span></span>
<span id="cb146-963"><a href="#cb146-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-964"><a href="#cb146-964" aria-hidden="true" tabindex="-1"></a>Adding a non-linear term to model A might help with the problems visualized with the various assumptions made in a linear regression model. A Spearman $p^2$ plot was made with the predictors in model A.</span>
<span id="cb146-965"><a href="#cb146-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-968"><a href="#cb146-968" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-969"><a href="#cb146-969" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">spearman2</span>(log_ecig_30day <span class="sc">~</span> puff_num <span class="sc">+</span> age_range <span class="sc">+</span> less_harm <span class="sc">+</span> ecig_nico, <span class="at">data =</span> data_lin_i ))</span>
<span id="cb146-970"><a href="#cb146-970" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-971"><a href="#cb146-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-972"><a href="#cb146-972" aria-hidden="true" tabindex="-1"></a>From the plot, if a non-linear term were to improve the fit of the model, the predictor most likely to do so would be <span class="in">`puff_num`</span>, followed much less closely by <span class="in">`less_harm`</span>.</span>
<span id="cb146-973"><a href="#cb146-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-974"><a href="#cb146-974" aria-hidden="true" tabindex="-1"></a>A restricted cubic spline with 4 knots in <span class="in">`puff_num`</span> was then added to the model, spending 2 **additional** degrees of freedom as compared to model A (with the main effect of <span class="in">`puff_num`</span>). </span>
<span id="cb146-975"><a href="#cb146-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-976"><a href="#cb146-976" aria-hidden="true" tabindex="-1"></a>An interaction term between the main effects of <span class="in">`puff_num`</span> and <span class="in">`less_harm`</span> was added to the model, spending a **single** additional degree of freedom.</span>
<span id="cb146-977"><a href="#cb146-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-978"><a href="#cb146-978" aria-hidden="true" tabindex="-1"></a>Overall, this would result in 3 additional degrees of freedom being spent.</span>
<span id="cb146-979"><a href="#cb146-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-980"><a href="#cb146-980" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model B</span></span>
<span id="cb146-981"><a href="#cb146-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-982"><a href="#cb146-982" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fitting Model B</span></span>
<span id="cb146-983"><a href="#cb146-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-984"><a href="#cb146-984" aria-hidden="true" tabindex="-1"></a>Using <span class="in">`lm`</span> and <span class="in">`ols`</span>, model B was fit, using a restricted cubic spline on <span class="in">`puff_num`</span> and an interaction term between the main effects of <span class="in">`puff_num`</span> and <span class="in">`less_harm`</span>. </span>
<span id="cb146-985"><a href="#cb146-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-988"><a href="#cb146-988" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-989"><a href="#cb146-989" aria-hidden="true" tabindex="-1"></a>mod_B <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_ecig_30day <span class="sc">~</span> <span class="fu">rcs</span>(puff_num,<span class="dv">4</span>) <span class="sc">+</span> age_range <span class="sc">+</span> less_harm <span class="sc">+</span> ecig_nico <span class="sc">+</span> puff_num<span class="sc">%ia%</span>less_harm, <span class="at">data =</span> data_lin_i )</span>
<span id="cb146-990"><a href="#cb146-990" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-991"><a href="#cb146-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-994"><a href="#cb146-994" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-995"><a href="#cb146-995" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">datadist</span>(data_lin_i)</span>
<span id="cb146-996"><a href="#cb146-996" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">datadist =</span> <span class="st">"dd"</span>)</span>
<span id="cb146-997"><a href="#cb146-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-998"><a href="#cb146-998" aria-hidden="true" tabindex="-1"></a>mod_B_ols <span class="ot">&lt;-</span> <span class="fu">ols</span>(log_ecig_30day <span class="sc">~</span> <span class="fu">rcs</span>(puff_num,<span class="dv">4</span>) <span class="sc">+</span> age_range <span class="sc">+</span> less_harm <span class="sc">+</span> ecig_nico <span class="sc">+</span> puff_num<span class="sc">%ia%</span>less_harm, <span class="at">data =</span> data_lin_i,</span>
<span id="cb146-999"><a href="#cb146-999" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x =</span> <span class="cn">TRUE</span>, <span class="at">y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb146-1000"><a href="#cb146-1000" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1001"><a href="#cb146-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1002"><a href="#cb146-1002" aria-hidden="true" tabindex="-1"></a><span class="fu">### Tidied Coefficient Estimates (Model B)</span></span>
<span id="cb146-1003"><a href="#cb146-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1004"><a href="#cb146-1004" aria-hidden="true" tabindex="-1"></a><span class="in">`mod_B`</span> had it's coefficients tidied with a 90% confidence interval and placed in a tidy table.</span>
<span id="cb146-1005"><a href="#cb146-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1008"><a href="#cb146-1008" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1009"><a href="#cb146-1009" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(mod_B, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.90</span>) <span class="sc">|&gt;</span></span>
<span id="cb146-1010"><a href="#cb146-1010" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, <span class="at">se =</span> std.error, </span>
<span id="cb146-1011"><a href="#cb146-1011" aria-hidden="true" tabindex="-1"></a>         <span class="at">low90 =</span> conf.low, <span class="at">high90 =</span> conf.high, </span>
<span id="cb146-1012"><a href="#cb146-1012" aria-hidden="true" tabindex="-1"></a>         <span class="at">p =</span> p.value) <span class="sc">|&gt;</span></span>
<span id="cb146-1013"><a href="#cb146-1013" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb146-1014"><a href="#cb146-1014" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-1015"><a href="#cb146-1015" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1016"><a href="#cb146-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1017"><a href="#cb146-1017" aria-hidden="true" tabindex="-1"></a><span class="fu">### Effects Plot for Model B</span></span>
<span id="cb146-1018"><a href="#cb146-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1019"><a href="#cb146-1019" aria-hidden="true" tabindex="-1"></a>The effects plot for model <span class="in">`mod_B_ols`</span> was created.</span>
<span id="cb146-1020"><a href="#cb146-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1023"><a href="#cb146-1023" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1024"><a href="#cb146-1024" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">summary</span>(mod_B_ols))</span>
<span id="cb146-1025"><a href="#cb146-1025" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1026"><a href="#cb146-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1027"><a href="#cb146-1027" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summarizing Fit (Model B)</span></span>
<span id="cb146-1028"><a href="#cb146-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1029"><a href="#cb146-1029" aria-hidden="true" tabindex="-1"></a>Using the <span class="in">`glance`</span> function, the numerical summaries of model B's fit were placed in a table. </span>
<span id="cb146-1030"><a href="#cb146-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1033"><a href="#cb146-1033" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1034"><a href="#cb146-1034" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(mod_B) <span class="sc">|&gt;</span></span>
<span id="cb146-1035"><a href="#cb146-1035" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">r2 =</span> r.squared, <span class="at">adjr2 =</span> adj.r.squared, sigma, </span>
<span id="cb146-1036"><a href="#cb146-1036" aria-hidden="true" tabindex="-1"></a>         AIC, BIC, nobs, df, df.residual) <span class="sc">|&gt;</span></span>
<span id="cb146-1037"><a href="#cb146-1037" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">|&gt;</span></span>
<span id="cb146-1038"><a href="#cb146-1038" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-1039"><a href="#cb146-1039" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1040"><a href="#cb146-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1041"><a href="#cb146-1041" aria-hidden="true" tabindex="-1"></a><span class="fu">### Regression Diagnostics (Model B)</span></span>
<span id="cb146-1042"><a href="#cb146-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1043"><a href="#cb146-1043" aria-hidden="true" tabindex="-1"></a>The four residual diagnostic plots for model B were obtained.  </span>
<span id="cb146-1044"><a href="#cb146-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1045"><a href="#cb146-1045" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height= 8, fig.width=8}</span></span>
<span id="cb146-1046"><a href="#cb146-1046" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)); <span class="fu">plot</span>(mod_B); <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb146-1047"><a href="#cb146-1047" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1048"><a href="#cb146-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1049"><a href="#cb146-1049" aria-hidden="true" tabindex="-1"></a>The residual plots are improved from the plots in model A. The q-q plot follows a more normal distribution. The residuals vs fitted values plot shows a more linear line, and the scale-location plot shows a more linear model as well. The assumptions of normality, linearity and constant variance are adhered to more rigorously in the residuals of model B, as compared to model A.</span>
<span id="cb146-1050"><a href="#cb146-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1051"><a href="#cb146-1051" aria-hidden="true" tabindex="-1"></a>While there are significant outliers in the q-q plot, the residuals vs leverage plot does not show points that have a Cook's distance of more than 0.5, indicating that these outliers do not exert an undue influence on the model. There are points that have an unusual combination of predictor variables, but their influence on the model is not significant. </span>
<span id="cb146-1052"><a href="#cb146-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1053"><a href="#cb146-1053" aria-hidden="true" tabindex="-1"></a><span class="fu">## Validating Models A and B</span></span>
<span id="cb146-1054"><a href="#cb146-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1055"><a href="#cb146-1055" aria-hidden="true" tabindex="-1"></a>After setting a seed, the <span class="in">`data_lin_i`</span> dataset was divided into a training and a testing sample. Two models were created, one model with linear terms alone, and the other model with the non-linear terms recommended by the Spearman $p^2$ plot. The coefficients obtained from these models were then used to obtain the predicted <span class="in">`log_ecig_30day`</span> values in the holdout test sample.</span>
<span id="cb146-1056"><a href="#cb146-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1059"><a href="#cb146-1059" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1060"><a href="#cb146-1060" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4322023</span>)</span>
<span id="cb146-1061"><a href="#cb146-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1062"><a href="#cb146-1062" aria-hidden="true" tabindex="-1"></a>data_lin_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(data_lin_i, <span class="at">prop =</span> <span class="fl">0.7</span>)</span>
<span id="cb146-1063"><a href="#cb146-1063" aria-hidden="true" tabindex="-1"></a>data_lin_train <span class="ot">&lt;-</span> <span class="fu">training</span>(data_lin_split)</span>
<span id="cb146-1064"><a href="#cb146-1064" aria-hidden="true" tabindex="-1"></a>data_lin_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(data_lin_split)</span>
<span id="cb146-1065"><a href="#cb146-1065" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1066"><a href="#cb146-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1067"><a href="#cb146-1067" aria-hidden="true" tabindex="-1"></a>Functions from the <span class="in">`yardstick`</span> package were used to obtain key summary of fit statistics for both the models' predictions of the holdout testing sample. The metrics were then placed in a tibble and displayed using kable.</span>
<span id="cb146-1068"><a href="#cb146-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1071"><a href="#cb146-1071" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1072"><a href="#cb146-1072" aria-hidden="true" tabindex="-1"></a>mod_A_train <span class="ot">&lt;-</span> <span class="fu">ols</span>(log_ecig_30day <span class="sc">~</span> puff_num <span class="sc">+</span> age_range <span class="sc">+</span> less_harm <span class="sc">+</span> ecig_nico, <span class="at">data =</span> data_lin_train)</span>
<span id="cb146-1073"><a href="#cb146-1073" aria-hidden="true" tabindex="-1"></a>mod_B_train <span class="ot">&lt;-</span> <span class="fu">ols</span>(log_ecig_30day <span class="sc">~</span> <span class="fu">rcs</span>(puff_num,<span class="dv">4</span>) <span class="sc">+</span> age_range <span class="sc">+</span> less_harm <span class="sc">+</span> ecig_nico <span class="sc">+</span> puff_num<span class="sc">%ia%</span>less_harm,</span>
<span id="cb146-1074"><a href="#cb146-1074" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> data_lin_train )</span>
<span id="cb146-1075"><a href="#cb146-1075" aria-hidden="true" tabindex="-1"></a>mod_A_test_aug <span class="ot">&lt;-</span> <span class="fu">augment</span>(mod_A, <span class="at">newdata =</span> data_lin_test)</span>
<span id="cb146-1076"><a href="#cb146-1076" aria-hidden="true" tabindex="-1"></a>mod_B_test_aug <span class="ot">&lt;-</span> <span class="fu">augment</span>(mod_B, <span class="at">newdata =</span> data_lin_test)</span>
<span id="cb146-1077"><a href="#cb146-1077" aria-hidden="true" tabindex="-1"></a>rep1 <span class="ot">&lt;-</span> <span class="fu">rmse</span>(<span class="at">data =</span> mod_A_test_aug, <span class="at">truth =</span> log_ecig_30day, <span class="at">estimate =</span> .fitted)</span>
<span id="cb146-1078"><a href="#cb146-1078" aria-hidden="true" tabindex="-1"></a>rep2 <span class="ot">&lt;-</span> <span class="fu">rmse</span>(<span class="at">data =</span> mod_B_test_aug, <span class="at">truth =</span> log_ecig_30day, <span class="at">estimate =</span> .fitted)</span>
<span id="cb146-1079"><a href="#cb146-1079" aria-hidden="true" tabindex="-1"></a>rep3 <span class="ot">&lt;-</span> <span class="fu">rsq</span>(<span class="at">data =</span> mod_A_test_aug, <span class="at">truth =</span> log_ecig_30day, <span class="at">estimate =</span> .fitted)</span>
<span id="cb146-1080"><a href="#cb146-1080" aria-hidden="true" tabindex="-1"></a>rep4 <span class="ot">&lt;-</span> <span class="fu">rsq</span>(<span class="at">data =</span> mod_B_test_aug, <span class="at">truth =</span> log_ecig_30day, <span class="at">estimate =</span> .fitted)</span>
<span id="cb146-1081"><a href="#cb146-1081" aria-hidden="true" tabindex="-1"></a>rep5 <span class="ot">&lt;-</span> <span class="fu">mae</span>(<span class="at">data =</span> mod_A_test_aug, <span class="at">truth =</span> log_ecig_30day, <span class="at">estimate =</span> .fitted)</span>
<span id="cb146-1082"><a href="#cb146-1082" aria-hidden="true" tabindex="-1"></a>rep6 <span class="ot">&lt;-</span> <span class="fu">mae</span>(<span class="at">data =</span> mod_B_test_aug, <span class="at">truth =</span> log_ecig_30day, <span class="at">estimate =</span> .fitted)</span>
<span id="cb146-1083"><a href="#cb146-1083" aria-hidden="true" tabindex="-1"></a>rep_full <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(rep1, rep2, rep3, rep4, rep5, rep6)</span>
<span id="cb146-1084"><a href="#cb146-1084" aria-hidden="true" tabindex="-1"></a>rep_full <span class="ot">&lt;-</span> rep_full <span class="sc">|&gt;</span> </span>
<span id="cb146-1085"><a href="#cb146-1085" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Models =</span> <span class="fu">c</span>(<span class="st">"Model A Holdout RMSE"</span>,<span class="st">"Model B Holdout RMSE"</span>,<span class="st">"Model A Holdout $R^2$"</span>,<span class="st">"Model B Holdout $R^2$"</span>,<span class="st">"Model A Holdout MAE"</span>,<span class="st">"Model B Holdout MAE"</span>))</span>
<span id="cb146-1086"><a href="#cb146-1086" aria-hidden="true" tabindex="-1"></a>rep_full <span class="ot">&lt;-</span> rep_full <span class="sc">|&gt;</span></span>
<span id="cb146-1087"><a href="#cb146-1087" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Models, <span class="at">Metric =</span> .metric, <span class="at">Estimate =</span> .estimate)</span>
<span id="cb146-1088"><a href="#cb146-1088" aria-hidden="true" tabindex="-1"></a>rep_full <span class="sc">|&gt;</span> <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-1089"><a href="#cb146-1089" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-1090"><a href="#cb146-1090" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1091"><a href="#cb146-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1092"><a href="#cb146-1092" aria-hidden="true" tabindex="-1"></a><span class="fu">### Holdout RMSE, $R^2$ and MAE </span></span>
<span id="cb146-1093"><a href="#cb146-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1094"><a href="#cb146-1094" aria-hidden="true" tabindex="-1"></a>| Model | Holdout RMSE | Holdout $R^2$ | Holdout MAE | </span>
<span id="cb146-1095"><a href="#cb146-1095" aria-hidden="true" tabindex="-1"></a>|-------|-----------------|-----------|------------|</span>
<span id="cb146-1096"><a href="#cb146-1096" aria-hidden="true" tabindex="-1"></a>| A | 0.9563 | 0.1709 | 0.8159 | 0.8159 |</span>
<span id="cb146-1097"><a href="#cb146-1097" aria-hidden="true" tabindex="-1"></a>| B | 0.7614 | 0.4727 | 0.5992 | 0.6037</span>
<span id="cb146-1098"><a href="#cb146-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1099"><a href="#cb146-1099" aria-hidden="true" tabindex="-1"></a><span class="fu">### Validated $R^2$, MSE and IC statistics</span></span>
<span id="cb146-1100"><a href="#cb146-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1101"><a href="#cb146-1101" aria-hidden="true" tabindex="-1"></a>After setting a seed, the validate function was used to obtain the validated R-squared and MSE values for models A and B.</span>
<span id="cb146-1102"><a href="#cb146-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1105"><a href="#cb146-1105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1106"><a href="#cb146-1106" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4322023</span>); (valA <span class="ot">&lt;-</span> <span class="fu">validate</span>(mod_A_ols)) </span>
<span id="cb146-1107"><a href="#cb146-1107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1108"><a href="#cb146-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1111"><a href="#cb146-1111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1112"><a href="#cb146-1112" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4322023</span>); (valB <span class="ot">&lt;-</span> <span class="fu">validate</span>(mod_B_ols))</span>
<span id="cb146-1113"><a href="#cb146-1113" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1114"><a href="#cb146-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1115"><a href="#cb146-1115" aria-hidden="true" tabindex="-1"></a>| Model | Validated $R^2$ | Validated MSE | AIC | BIC | DF </span>
<span id="cb146-1116"><a href="#cb146-1116" aria-hidden="true" tabindex="-1"></a>|-------|-----------------|-----------|------------|---------|------|</span>
<span id="cb146-1117"><a href="#cb146-1117" aria-hidden="true" tabindex="-1"></a>| A | 0.1258 | 0.9603 | 3349.8 | 3400.7 | 8 |  </span>
<span id="cb146-1118"><a href="#cb146-1118" aria-hidden="true" tabindex="-1"></a>| B | 0.4452 | 0.6096 | 2782.8 | 2849 | 11 |</span>
<span id="cb146-1119"><a href="#cb146-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1120"><a href="#cb146-1120" aria-hidden="true" tabindex="-1"></a><span class="fu">### ANOVA to compare Models A and B</span></span>
<span id="cb146-1121"><a href="#cb146-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1124"><a href="#cb146-1124" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1125"><a href="#cb146-1125" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_A, mod_B)</span>
<span id="cb146-1126"><a href="#cb146-1126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1127"><a href="#cb146-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1128"><a href="#cb146-1128" aria-hidden="true" tabindex="-1"></a>This ANOVA table shows that model B has 3 additional degrees of freedom as compared to model A, and that adding non linear terms has resulted in a significant improvement in the predictive power of the model. </span>
<span id="cb146-1129"><a href="#cb146-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1130"><a href="#cb146-1130" aria-hidden="true" tabindex="-1"></a><span class="fu">## Final Linear Regression Model</span></span>
<span id="cb146-1131"><a href="#cb146-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1132"><a href="#cb146-1132" aria-hidden="true" tabindex="-1"></a>I prefer Model <span class="in">`B`</span>, because:</span>
<span id="cb146-1133"><a href="#cb146-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1134"><a href="#cb146-1134" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Model B has a higher validated $R^2$, and a higher holdout sample $R^2$. </span>
<span id="cb146-1135"><a href="#cb146-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1136"><a href="#cb146-1136" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Model B has a lower validated MSE (Mean Squared Error) and a lower holdout RMSE.</span>
<span id="cb146-1137"><a href="#cb146-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1138"><a href="#cb146-1138" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Model B has a lower holdout MAE, and a lower AIC and BIC.</span>
<span id="cb146-1139"><a href="#cb146-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1140"><a href="#cb146-1140" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Model B's residual plots show that the assumptions of linearity, normality and non-heteroscedasticity are not violated. </span>
<span id="cb146-1141"><a href="#cb146-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1142"><a href="#cb146-1142" aria-hidden="true" tabindex="-1"></a><span class="fu">### Winning Model's Parameter Estimates</span></span>
<span id="cb146-1143"><a href="#cb146-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1144"><a href="#cb146-1144" aria-hidden="true" tabindex="-1"></a>The model B's raw and adjusted $R^2$ were obtained.</span>
<span id="cb146-1145"><a href="#cb146-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1148"><a href="#cb146-1148" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1149"><a href="#cb146-1149" aria-hidden="true" tabindex="-1"></a>mod_B_ols</span>
<span id="cb146-1150"><a href="#cb146-1150" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1151"><a href="#cb146-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1152"><a href="#cb146-1152" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Coefficients</span></span>
<span id="cb146-1153"><a href="#cb146-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1154"><a href="#cb146-1154" aria-hidden="true" tabindex="-1"></a>Model B's coefficients were obtained with 90% confidence intervals and presented using kable.</span>
<span id="cb146-1155"><a href="#cb146-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1158"><a href="#cb146-1158" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1159"><a href="#cb146-1159" aria-hidden="true" tabindex="-1"></a>tidy_mod_B <span class="ot">&lt;-</span> <span class="fu">tidy</span>(mod_B, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.90</span>)</span>
<span id="cb146-1160"><a href="#cb146-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1161"><a href="#cb146-1161" aria-hidden="true" tabindex="-1"></a>tidy_mod_B <span class="sc">|&gt;</span></span>
<span id="cb146-1162"><a href="#cb146-1162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">digits =</span> <span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb146-1163"><a href="#cb146-1163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>, <span class="at">full_width =</span> F)</span>
<span id="cb146-1164"><a href="#cb146-1164" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1165"><a href="#cb146-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1168"><a href="#cb146-1168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1169"><a href="#cb146-1169" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">Predict</span>(mod_B_ols))</span>
<span id="cb146-1170"><a href="#cb146-1170" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1171"><a href="#cb146-1171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1172"><a href="#cb146-1172" aria-hidden="true" tabindex="-1"></a>The coefficients for the non-linear term are significantly larger than expected. Given that the outcome of interest is a count outcome, and the predictor (<span class="in">`puff_num`</span>) has a very intuitive relationship with the outcome variable, in that individuals who have a zero for their outcome (<span class="in">`ecig_30day`</span>) could be expected to have significantly lower (or even zero) values of <span class="in">`puff_num`</span>, and individuals with any particular value of <span class="in">`puff_num`</span> would have a collinear relationship with the outcome variable. It can be reasonably expected that the model is being driven significantly towards a particular value of <span class="in">`log_ecig_30day`</span>, which could result in the exploding coefficients seen in the table of coefficients. </span>
<span id="cb146-1173"><a href="#cb146-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1174"><a href="#cb146-1174" aria-hidden="true" tabindex="-1"></a>This indicates that model B is not the ideal sort of model to be used for a count outcome like <span class="in">`ecig_30day`</span>.</span>
<span id="cb146-1175"><a href="#cb146-1175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1176"><a href="#cb146-1176" aria-hidden="true" tabindex="-1"></a>Following this, the validated $R^2$ was also obtained, along with the validated MSE.</span>
<span id="cb146-1177"><a href="#cb146-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1180"><a href="#cb146-1180" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1181"><a href="#cb146-1181" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4322023</span>); (valB_imp <span class="ot">&lt;-</span> <span class="fu">validate</span>(mod_B_ols))</span>
<span id="cb146-1182"><a href="#cb146-1182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1183"><a href="#cb146-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1184"><a href="#cb146-1184" aria-hidden="true" tabindex="-1"></a>An ANOVA test performed on <span class="in">`mod_B_ols`</span> shows that a non linear term (a restricted cubic spline with 4 knots) on <span class="in">`puff_num`</span> had significant impact on the predictive ability of model B, along with the interaction term between the main effect of <span class="in">`puff_num`</span> and <span class="in">`less_harm`</span>. </span>
<span id="cb146-1185"><a href="#cb146-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1188"><a href="#cb146-1188" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1189"><a href="#cb146-1189" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_B_ols)</span>
<span id="cb146-1190"><a href="#cb146-1190" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1191"><a href="#cb146-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1192"><a href="#cb146-1192" aria-hidden="true" tabindex="-1"></a>The ANOVA table shows that model B has 12 total degrees of freedom, with 4 non-linear terms of freedom. </span>
<span id="cb146-1193"><a href="#cb146-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1194"><a href="#cb146-1194" aria-hidden="true" tabindex="-1"></a>| Metric | Value |</span>
<span id="cb146-1195"><a href="#cb146-1195" aria-hidden="true" tabindex="-1"></a>|--------------|------------|</span>
<span id="cb146-1196"><a href="#cb146-1196" aria-hidden="true" tabindex="-1"></a>| Raw $R^2$ | 0.468 |</span>
<span id="cb146-1197"><a href="#cb146-1197" aria-hidden="true" tabindex="-1"></a>| Adjusted $R^2$ | 0.463 |</span>
<span id="cb146-1198"><a href="#cb146-1198" aria-hidden="true" tabindex="-1"></a>| Validated $R^2$ | 0.4452 |</span>
<span id="cb146-1199"><a href="#cb146-1199" aria-hidden="true" tabindex="-1"></a>| AIC | 2782.8 | </span>
<span id="cb146-1200"><a href="#cb146-1200" aria-hidden="true" tabindex="-1"></a>| BIC | 2849 |</span>
<span id="cb146-1201"><a href="#cb146-1201" aria-hidden="true" tabindex="-1"></a>| Validated MSE (Mean Squared Error) | 0.6096 |</span>
<span id="cb146-1202"><a href="#cb146-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1203"><a href="#cb146-1203" aria-hidden="true" tabindex="-1"></a><span class="fu">### Effects Plot for Winning Model</span></span>
<span id="cb146-1204"><a href="#cb146-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1207"><a href="#cb146-1207" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1208"><a href="#cb146-1208" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_B_ols, <span class="at">conf.int =</span> <span class="fl">0.90</span>)</span>
<span id="cb146-1209"><a href="#cb146-1209" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1210"><a href="#cb146-1210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1213"><a href="#cb146-1213" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1214"><a href="#cb146-1214" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">summary</span>(mod_B_ols, <span class="at">conf.int =</span> <span class="fl">0.90</span>))</span>
<span id="cb146-1215"><a href="#cb146-1215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1216"><a href="#cb146-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1217"><a href="#cb146-1217" aria-hidden="true" tabindex="-1"></a>From the summary above, for the <span class="in">`puff_num`</span> coefficient, in model <span class="in">`mod_b_ols`</span>,</span>
<span id="cb146-1218"><a href="#cb146-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1219"><a href="#cb146-1219" aria-hidden="true" tabindex="-1"></a>We can conclude that the estimated effect of moving <span class="in">`puff_num`</span> from 5.76 to 7.05 results in an increase of 0.597 in <span class="in">`log_ecig_30day`</span>, with 90% confidence intervals of 0.595 to 0.733. IE, for model B,</span>
<span id="cb146-1220"><a href="#cb146-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1221"><a href="#cb146-1221" aria-hidden="true" tabindex="-1"></a>**As an individual's number of e-cigarette puffs taken the last time they smoked an e-cigarette increases from 5.76 to 7.05, the predicted logarithm of the number of days they smoked an e-cigarette in the past 30 days (plus one day) increases by 0.597, with 90% CI(0.561 to 0.633), provided the individual's age when they began smoking, their perception of the harmfulness of e-cigarettes, and their use or lack thereof of nicotine containing e-cigarettes are all held constant.**</span>
<span id="cb146-1222"><a href="#cb146-1222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1223"><a href="#cb146-1223" aria-hidden="true" tabindex="-1"></a>Given that this confidence interval does not include 0, this is a scientifically meaningful effect. </span>
<span id="cb146-1224"><a href="#cb146-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1225"><a href="#cb146-1225" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Calibration</span></span>
<span id="cb146-1226"><a href="#cb146-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1229"><a href="#cb146-1229" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1230"><a href="#cb146-1230" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4322023</span>); <span class="fu">plot</span>(<span class="fu">calibrate</span>(mod_B_ols))</span>
<span id="cb146-1231"><a href="#cb146-1231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1232"><a href="#cb146-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1233"><a href="#cb146-1233" aria-hidden="true" tabindex="-1"></a>The model does not appear to be particularly well calibrated. It under-predicts at the high and low ends of the actual <span class="in">`log_ecig_30day`</span> values, and over-predicts elsewhere.</span>
<span id="cb146-1234"><a href="#cb146-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1235"><a href="#cb146-1235" aria-hidden="true" tabindex="-1"></a><span class="fu">### Numerical Description of Effect Sizes</span></span>
<span id="cb146-1236"><a href="#cb146-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1239"><a href="#cb146-1239" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1240"><a href="#cb146-1240" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_B_ols, <span class="at">conf.int =</span> <span class="fl">0.90</span>) <span class="sc">|&gt;</span> <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb146-1241"><a href="#cb146-1241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>, <span class="at">full_width =</span> F)</span>
<span id="cb146-1242"><a href="#cb146-1242" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1243"><a href="#cb146-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1244"><a href="#cb146-1244" aria-hidden="true" tabindex="-1"></a>**`puff_num`** description : </span>
<span id="cb146-1245"><a href="#cb146-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1246"><a href="#cb146-1246" aria-hidden="true" tabindex="-1"></a>For two subjects with the same age range at which they started smoking e-cigarettes, the same perception of the harmfulness of e-cigarettes, the same kind of usage or lack thereof of e-cigarettes containing nicotine, and if one subject took 5.76 e-cigarette puffs the last time they smoked an e-cigarette, and the other took 7.05 e-cigarettes puffs 7.05 the last time they smoked an e-cigarette, the model estimates that subject 1 will have a log(number of days smoked in the past 30 days + 1) value **0.597 units higher** than subject 2's log(number of days smoked in the past 30 days + 1). The 90% confidence interval for that estimate ranges from 0.561 to  0.633. </span>
<span id="cb146-1247"><a href="#cb146-1247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1248"><a href="#cb146-1248" aria-hidden="true" tabindex="-1"></a><span class="fu">### Nomogram of Winning Model</span></span>
<span id="cb146-1249"><a href="#cb146-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1250"><a href="#cb146-1250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height = 6, fig.width = 8}</span></span>
<span id="cb146-1251"><a href="#cb146-1251" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">nomogram</span>(mod_B_ols))</span>
<span id="cb146-1252"><a href="#cb146-1252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1253"><a href="#cb146-1253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1254"><a href="#cb146-1254" aria-hidden="true" tabindex="-1"></a><span class="fu">### Prediction for a New Subject</span></span>
<span id="cb146-1255"><a href="#cb146-1255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1256"><a href="#cb146-1256" aria-hidden="true" tabindex="-1"></a>A new theoretical subject, who took 5 puffs from an e-cigarette the last time they smoked an e-cigarette, who started smoking e-cigarettes when they were under 18, who uses e-cigarettes because they thought e-cigarettes might be less harmful to them than regular cigarettes, who usually uses an e-cigarette containing nicotine, was created. Their predicted <span class="in">`log_ecig_30day`</span> value was then obtained and exponentiated. 1 was added to the exponentiated value to complete the transformation back into the original value. </span>
<span id="cb146-1257"><a href="#cb146-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1260"><a href="#cb146-1260" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1261"><a href="#cb146-1261" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod_B_ols, <span class="fu">expand.grid</span>(<span class="at">puff_num =</span> <span class="dv">7</span>, <span class="at">age_range =</span> <span class="st">"&lt;18"</span>,</span>
<span id="cb146-1262"><a href="#cb146-1262" aria-hidden="true" tabindex="-1"></a>                           <span class="at">less_harm =</span> <span class="st">"Yes"</span>, <span class="at">ecig_nico =</span> <span class="st">"Yes"</span>),</span>
<span id="cb146-1263"><a href="#cb146-1263" aria-hidden="true" tabindex="-1"></a><span class="at">conf.int =</span> <span class="fl">0.90</span>, <span class="at">conf.type =</span> <span class="st">"individual"</span>) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-1264"><a href="#cb146-1264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">point_estimate =</span> (<span class="fu">exp</span>(linear.predictors) <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb146-1265"><a href="#cb146-1265" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower_orig =</span> (<span class="fu">exp</span>(lower) <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb146-1266"><a href="#cb146-1266" aria-hidden="true" tabindex="-1"></a>         <span class="at">upper_orig =</span> (<span class="fu">exp</span>(upper) <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb146-1267"><a href="#cb146-1267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(point_estimate,lower_orig,upper_orig)</span>
<span id="cb146-1268"><a href="#cb146-1268" aria-hidden="true" tabindex="-1"></a>preds <span class="sc">|&gt;</span> <span class="fu">kable</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-1269"><a href="#cb146-1269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F) </span>
<span id="cb146-1270"><a href="#cb146-1270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1271"><a href="#cb146-1271" aria-hidden="true" tabindex="-1"></a>Predictor Values | Predicted days participant used an e-cigarette in the past 30 days | 90% Confidence Interval |</span>
<span id="cb146-1272"><a href="#cb146-1272" aria-hidden="true" tabindex="-1"></a>---------------------------------------------------------------------|-----------------------------|---------------------------------|</span>
<span id="cb146-1273"><a href="#cb146-1273" aria-hidden="true" tabindex="-1"></a>puff_num = 7, age_range = "&lt;18",less_harm = "Yes", ecig_nico = "Yes" | 2.72 | 0.04 to 12.31 |</span>
<span id="cb146-1274"><a href="#cb146-1274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1275"><a href="#cb146-1275" aria-hidden="true" tabindex="-1"></a><span class="fu"># Logistic Regression Analyses</span></span>
<span id="cb146-1276"><a href="#cb146-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1277"><a href="#cb146-1277" aria-hidden="true" tabindex="-1"></a><span class="fu">## Missingness</span></span>
<span id="cb146-1278"><a href="#cb146-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1281"><a href="#cb146-1281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1282"><a href="#cb146-1282" aria-hidden="true" tabindex="-1"></a>data_log <span class="sc">|&gt;</span></span>
<span id="cb146-1283"><a href="#cb146-1283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">miss_var_summary</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-1284"><a href="#cb146-1284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb146-1285"><a href="#cb146-1285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-1286"><a href="#cb146-1286" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1287"><a href="#cb146-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1288"><a href="#cb146-1288" aria-hidden="true" tabindex="-1"></a>There is missing data in all of the variables under study, and the outcome variable <span class="in">`ecig_reg`</span> does not have any missing values. There are missing predictor values for more than 10% of the subjects under study, and more than 50 subjects have missing values. </span>
<span id="cb146-1289"><a href="#cb146-1289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1290"><a href="#cb146-1290" aria-hidden="true" tabindex="-1"></a>The data can be assumed to be MAR (Missing At Random), since the missing data are not randomly distributed. It cannot be assumed to be MNAR (Missing Not At Random) since there does not appear to be a relationship between the magnitude of a value and it's missingness (or inclusion in the non-missing data), since there is no preponderance of values with lower or higher magnitude being missing. </span>
<span id="cb146-1291"><a href="#cb146-1291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1292"><a href="#cb146-1292" aria-hidden="true" tabindex="-1"></a>Single imputation was already performed on the complete dataset, to account for missingness. The logistic regression dataset was selected.</span>
<span id="cb146-1293"><a href="#cb146-1293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1296"><a href="#cb146-1296" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1297"><a href="#cb146-1297" aria-hidden="true" tabindex="-1"></a>data_log_i <span class="ot">&lt;-</span> data_final_i <span class="sc">|&gt;</span></span>
<span id="cb146-1298"><a href="#cb146-1298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(personid,ecig_reg,harm_perc,price_paid,ecig_flavored,ecig_nico,min_num)</span>
<span id="cb146-1299"><a href="#cb146-1299" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_summary</span>(data_log_i)</span>
<span id="cb146-1300"><a href="#cb146-1300" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1301"><a href="#cb146-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1302"><a href="#cb146-1302" aria-hidden="true" tabindex="-1"></a>There are no missing predictor variables in the logistic regression dataset after performing single imputation.</span>
<span id="cb146-1303"><a href="#cb146-1303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1304"><a href="#cb146-1304" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model Y </span></span>
<span id="cb146-1305"><a href="#cb146-1305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1306"><a href="#cb146-1306" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fitting Model Y</span></span>
<span id="cb146-1307"><a href="#cb146-1307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1308"><a href="#cb146-1308" aria-hidden="true" tabindex="-1"></a>Model Y was fit with both <span class="in">`lrm`</span> and <span class="in">`glm`</span>. <span class="in">`ecig_reg`</span> was the outcome variable, and the predictors were <span class="in">`min_num`</span>, <span class="in">`ecig_nico`</span>, <span class="in">`harm_perc`</span> and <span class="in">`price_paid`</span>.</span>
<span id="cb146-1309"><a href="#cb146-1309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1312"><a href="#cb146-1312" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1313"><a href="#cb146-1313" aria-hidden="true" tabindex="-1"></a>mod_Y <span class="ot">&lt;-</span> <span class="fu">glm</span>(ecig_reg <span class="sc">~</span> min_num <span class="sc">+</span> ecig_nico <span class="sc">+</span> ecig_flavored <span class="sc">+</span> harm_perc <span class="sc">+</span> price_paid,</span>
<span id="cb146-1314"><a href="#cb146-1314" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> data_log_i, <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb146-1315"><a href="#cb146-1315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1316"><a href="#cb146-1316" aria-hidden="true" tabindex="-1"></a>ddd <span class="ot">&lt;-</span> <span class="fu">datadist</span>(data_log_i)</span>
<span id="cb146-1317"><a href="#cb146-1317" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">datadist =</span> <span class="st">"ddd"</span>)</span>
<span id="cb146-1318"><a href="#cb146-1318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1319"><a href="#cb146-1319" aria-hidden="true" tabindex="-1"></a>mod_Y_lrm <span class="ot">&lt;-</span> <span class="fu">lrm</span>(ecig_reg <span class="sc">~</span> min_num <span class="sc">+</span> ecig_nico <span class="sc">+</span> ecig_flavored <span class="sc">+</span> harm_perc <span class="sc">+</span> price_paid,</span>
<span id="cb146-1320"><a href="#cb146-1320" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> data_log_i, <span class="at">x =</span> <span class="cn">TRUE</span>, <span class="at">y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb146-1321"><a href="#cb146-1321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1322"><a href="#cb146-1322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1323"><a href="#cb146-1323" aria-hidden="true" tabindex="-1"></a><span class="fu">### Tidied Odds Ratio Estimates (Model Y)</span></span>
<span id="cb146-1324"><a href="#cb146-1324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1327"><a href="#cb146-1327" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1328"><a href="#cb146-1328" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(mod_Y, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>) <span class="sc">|&gt;</span></span>
<span id="cb146-1329"><a href="#cb146-1329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, <span class="at">se =</span> std.error, </span>
<span id="cb146-1330"><a href="#cb146-1330" aria-hidden="true" tabindex="-1"></a>         <span class="at">low95 =</span> conf.low, <span class="at">high95 =</span> conf.high, <span class="at">p =</span> p.value) <span class="sc">|&gt;</span></span>
<span id="cb146-1331"><a href="#cb146-1331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb146-1332"><a href="#cb146-1332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-1333"><a href="#cb146-1333" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1334"><a href="#cb146-1334" aria-hidden="true" tabindex="-1"></a><span class="fu">### Effects Plot (Model Y)</span></span>
<span id="cb146-1335"><a href="#cb146-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1338"><a href="#cb146-1338" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1339"><a href="#cb146-1339" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">summary</span>(mod_Y_lrm))</span>
<span id="cb146-1340"><a href="#cb146-1340" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1341"><a href="#cb146-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1342"><a href="#cb146-1342" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summarizing Fit (Model Y)</span></span>
<span id="cb146-1343"><a href="#cb146-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1346"><a href="#cb146-1346" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1347"><a href="#cb146-1347" aria-hidden="true" tabindex="-1"></a>mod_Y_lrm</span>
<span id="cb146-1348"><a href="#cb146-1348" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1349"><a href="#cb146-1349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1352"><a href="#cb146-1352" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1353"><a href="#cb146-1353" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(mod_Y) <span class="sc">|&gt;</span></span>
<span id="cb146-1354"><a href="#cb146-1354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">df =</span> nobs <span class="sc">-</span> df.residual <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb146-1355"><a href="#cb146-1355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(AIC, BIC, df, df.residual, nobs) <span class="sc">|&gt;</span></span>
<span id="cb146-1356"><a href="#cb146-1356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">1</span>)<span class="sc">|&gt;</span></span>
<span id="cb146-1357"><a href="#cb146-1357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-1358"><a href="#cb146-1358" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1359"><a href="#cb146-1359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1360"><a href="#cb146-1360" aria-hidden="true" tabindex="-1"></a><span class="fu">### Confusion Matrix (Model Y)</span></span>
<span id="cb146-1361"><a href="#cb146-1361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1362"><a href="#cb146-1362" aria-hidden="true" tabindex="-1"></a>A temporary dataset, log_i_temp, for the putpose of generating a confusion matrix, was created. The outcome variable <span class="in">`ecig_reg`</span> had it's levels changed from "Yes" and "No" to 1 and 0.</span>
<span id="cb146-1363"><a href="#cb146-1363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1366"><a href="#cb146-1366" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1367"><a href="#cb146-1367" aria-hidden="true" tabindex="-1"></a>log_i_temp <span class="ot">&lt;-</span> data_log_i <span class="sc">|&gt;</span></span>
<span id="cb146-1368"><a href="#cb146-1368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ecig_reg =</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(ecig_reg <span class="sc">==</span> <span class="st">"Yes"</span>,<span class="dv">1</span>,<span class="dv">0</span>)))</span>
<span id="cb146-1369"><a href="#cb146-1369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1370"><a href="#cb146-1370" aria-hidden="true" tabindex="-1"></a>mod_Y_cm <span class="ot">&lt;-</span> <span class="fu">glm</span>(ecig_reg <span class="sc">~</span> min_num <span class="sc">+</span> ecig_nico <span class="sc">+</span> ecig_flavored <span class="sc">+</span> harm_perc <span class="sc">+</span> price_paid,</span>
<span id="cb146-1371"><a href="#cb146-1371" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> log_i_temp, <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb146-1372"><a href="#cb146-1372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1373"><a href="#cb146-1373" aria-hidden="true" tabindex="-1"></a>resY_aug <span class="ot">&lt;-</span> <span class="fu">augment</span>(mod_Y_cm, <span class="at">type.predict =</span> <span class="st">"response"</span>)</span>
<span id="cb146-1374"><a href="#cb146-1374" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1375"><a href="#cb146-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1376"><a href="#cb146-1376" aria-hidden="true" tabindex="-1"></a>My prediction rule is that the fitted value of pr(ecig_reg = 1) needs to be greater than or equal to 0.5 for me to predict that <span class="in">`ecig_reg`</span> is 1. </span>
<span id="cb146-1377"><a href="#cb146-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1380"><a href="#cb146-1380" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1381"><a href="#cb146-1381" aria-hidden="true" tabindex="-1"></a>cm_Y <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(</span>
<span id="cb146-1382"><a href="#cb146-1382" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">factor</span>(resY_aug<span class="sc">$</span>.fitted <span class="sc">&gt;=</span> <span class="fl">0.5</span>),</span>
<span id="cb146-1383"><a href="#cb146-1383" aria-hidden="true" tabindex="-1"></a>  <span class="at">reference =</span> <span class="fu">factor</span>(resY_aug<span class="sc">$</span>ecig_reg <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb146-1384"><a href="#cb146-1384" aria-hidden="true" tabindex="-1"></a>  <span class="at">positive =</span> <span class="st">"TRUE"</span>)</span>
<span id="cb146-1385"><a href="#cb146-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1386"><a href="#cb146-1386" aria-hidden="true" tabindex="-1"></a>cm_Y</span>
<span id="cb146-1387"><a href="#cb146-1387" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1388"><a href="#cb146-1388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1389"><a href="#cb146-1389" aria-hidden="true" tabindex="-1"></a><span class="fu">## Non-Linearity</span></span>
<span id="cb146-1390"><a href="#cb146-1390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1391"><a href="#cb146-1391" aria-hidden="true" tabindex="-1"></a>A Spearman $p^2$ plot was created for assessing the terms that are most likely to add predictive power to the model.</span>
<span id="cb146-1392"><a href="#cb146-1392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1395"><a href="#cb146-1395" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1396"><a href="#cb146-1396" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">spearman2</span>(ecig_reg <span class="sc">~</span> min_num <span class="sc">+</span> ecig_nico <span class="sc">+</span> ecig_flavored <span class="sc">+</span> harm_perc <span class="sc">+</span> price_paid,</span>
<span id="cb146-1397"><a href="#cb146-1397" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> data_log_i))</span>
<span id="cb146-1398"><a href="#cb146-1398" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1399"><a href="#cb146-1399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1400"><a href="#cb146-1400" aria-hidden="true" tabindex="-1"></a>The Spearman plot suggests the use of a non-linear term in <span class="in">`min_num`</span>, so a restricted cubic spline with 4 knots in <span class="in">`min_num`</span> will be added to the model, spending *two additional degrees of freedom* than the main effects model.</span>
<span id="cb146-1401"><a href="#cb146-1401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1402"><a href="#cb146-1402" aria-hidden="true" tabindex="-1"></a>An interaction term between the main effect of <span class="in">`ecig_flavored`</span> and <span class="in">`min_num`</span> will be added, spending  *an additional degree of freedom*. </span>
<span id="cb146-1403"><a href="#cb146-1403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1404"><a href="#cb146-1404" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model Z</span></span>
<span id="cb146-1405"><a href="#cb146-1405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1406"><a href="#cb146-1406" aria-hidden="true" tabindex="-1"></a>Model Z will add a total of 3 additional degrees of freedom to Model Y, using two non-linear terms. </span>
<span id="cb146-1407"><a href="#cb146-1407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1408"><a href="#cb146-1408" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fitting Model Z</span></span>
<span id="cb146-1409"><a href="#cb146-1409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1410"><a href="#cb146-1410" aria-hidden="true" tabindex="-1"></a>Model Z was fit using both <span class="in">`glm`</span> and <span class="in">`lrm`</span>.</span>
<span id="cb146-1411"><a href="#cb146-1411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1414"><a href="#cb146-1414" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1415"><a href="#cb146-1415" aria-hidden="true" tabindex="-1"></a>mod_Z <span class="ot">&lt;-</span> <span class="fu">glm</span>(ecig_reg <span class="sc">~</span> ecig_nico <span class="sc">+</span> <span class="fu">rcs</span>(min_num,<span class="dv">4</span>) <span class="sc">+</span> ecig_flavored <span class="sc">+</span> harm_perc <span class="sc">+</span> price_paid <span class="sc">+</span> ecig_flavored <span class="sc">%ia%</span> min_num,</span>
<span id="cb146-1416"><a href="#cb146-1416" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> data_log_i, <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb146-1417"><a href="#cb146-1417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1418"><a href="#cb146-1418" aria-hidden="true" tabindex="-1"></a>ddd <span class="ot">&lt;-</span> <span class="fu">datadist</span>(data_log_i)</span>
<span id="cb146-1419"><a href="#cb146-1419" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">datadist =</span> <span class="st">"ddd"</span>)</span>
<span id="cb146-1420"><a href="#cb146-1420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1421"><a href="#cb146-1421" aria-hidden="true" tabindex="-1"></a>mod_Z_lrm <span class="ot">&lt;-</span> <span class="fu">lrm</span>(ecig_reg <span class="sc">~</span> <span class="fu">rcs</span>(min_num,<span class="dv">4</span>) <span class="sc">+</span> ecig_nico <span class="sc">+</span> ecig_flavored <span class="sc">+</span> harm_perc <span class="sc">+</span> price_paid <span class="sc">+</span> ecig_flavored <span class="sc">%ia%</span> min_num,</span>
<span id="cb146-1422"><a href="#cb146-1422" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> data_log_i, <span class="at">x =</span> <span class="cn">TRUE</span>, <span class="at">y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb146-1423"><a href="#cb146-1423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1424"><a href="#cb146-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1425"><a href="#cb146-1425" aria-hidden="true" tabindex="-1"></a><span class="fu">### Tidied Odds Ratio Estimates (Model Z)</span></span>
<span id="cb146-1426"><a href="#cb146-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1429"><a href="#cb146-1429" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1430"><a href="#cb146-1430" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(mod_Z, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.90</span>) <span class="sc">|&gt;</span></span>
<span id="cb146-1431"><a href="#cb146-1431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, <span class="at">se =</span> std.error, </span>
<span id="cb146-1432"><a href="#cb146-1432" aria-hidden="true" tabindex="-1"></a>         <span class="at">low90 =</span> conf.low, <span class="at">high90 =</span> conf.high, <span class="at">p =</span> p.value) <span class="sc">|&gt;</span></span>
<span id="cb146-1433"><a href="#cb146-1433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)<span class="sc">|&gt;</span></span>
<span id="cb146-1434"><a href="#cb146-1434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-1435"><a href="#cb146-1435" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1436"><a href="#cb146-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1437"><a href="#cb146-1437" aria-hidden="true" tabindex="-1"></a><span class="fu">### Effects Plot (Model Z)</span></span>
<span id="cb146-1438"><a href="#cb146-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1441"><a href="#cb146-1441" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1442"><a href="#cb146-1442" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">summary</span>(mod_Z_lrm, <span class="at">conf.int =</span> <span class="fl">0.90</span>))</span>
<span id="cb146-1443"><a href="#cb146-1443" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1444"><a href="#cb146-1444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1445"><a href="#cb146-1445" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summarizing Fit (Model Z)</span></span>
<span id="cb146-1446"><a href="#cb146-1446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1449"><a href="#cb146-1449" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1450"><a href="#cb146-1450" aria-hidden="true" tabindex="-1"></a>mod_Z_lrm</span>
<span id="cb146-1451"><a href="#cb146-1451" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1452"><a href="#cb146-1452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1453"><a href="#cb146-1453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1454"><a href="#cb146-1454" aria-hidden="true" tabindex="-1"></a>The Nagelkerke $R^2$ for model Z is 0.670. The C statistic is 0.891. </span>
<span id="cb146-1455"><a href="#cb146-1455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1458"><a href="#cb146-1458" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1459"><a href="#cb146-1459" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(mod_Z) <span class="sc">|&gt;</span></span>
<span id="cb146-1460"><a href="#cb146-1460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">df =</span> nobs <span class="sc">-</span> df.residual <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb146-1461"><a href="#cb146-1461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(AIC, BIC, df, df.residual, nobs) <span class="sc">|&gt;</span></span>
<span id="cb146-1462"><a href="#cb146-1462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">1</span>)<span class="sc">|&gt;</span></span>
<span id="cb146-1463"><a href="#cb146-1463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>,<span class="at">full_width =</span> F)</span>
<span id="cb146-1464"><a href="#cb146-1464" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1465"><a href="#cb146-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1466"><a href="#cb146-1466" aria-hidden="true" tabindex="-1"></a><span class="fu">### Confusion Matrix (Model Z)</span></span>
<span id="cb146-1467"><a href="#cb146-1467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1468"><a href="#cb146-1468" aria-hidden="true" tabindex="-1"></a>As in Model Y, my prediction rule is that the fitted value of pr(ecig_reg = 1) needs to be greater than or equal to 0.5 for me to predict that <span class="in">`ecig_reg`</span> is 1. </span>
<span id="cb146-1469"><a href="#cb146-1469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1472"><a href="#cb146-1472" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1473"><a href="#cb146-1473" aria-hidden="true" tabindex="-1"></a>mod_Z_cm <span class="ot">&lt;-</span> <span class="fu">glm</span>(ecig_reg <span class="sc">~</span> ecig_nico <span class="sc">+</span> <span class="fu">rcs</span>(min_num,<span class="dv">4</span>) <span class="sc">+</span> ecig_flavored <span class="sc">+</span> harm_perc <span class="sc">+</span> price_paid <span class="sc">+</span> ecig_flavored <span class="sc">%ia%</span> min_num,</span>
<span id="cb146-1474"><a href="#cb146-1474" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> log_i_temp, <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb146-1475"><a href="#cb146-1475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1476"><a href="#cb146-1476" aria-hidden="true" tabindex="-1"></a>resZ_aug <span class="ot">&lt;-</span> <span class="fu">augment</span>(mod_Z_cm, <span class="at">type.predict =</span> <span class="st">"response"</span>)</span>
<span id="cb146-1477"><a href="#cb146-1477" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1478"><a href="#cb146-1478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1481"><a href="#cb146-1481" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1482"><a href="#cb146-1482" aria-hidden="true" tabindex="-1"></a>cm_Z <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(</span>
<span id="cb146-1483"><a href="#cb146-1483" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">factor</span>(resZ_aug<span class="sc">$</span>.fitted <span class="sc">&gt;=</span> <span class="fl">0.5</span>),</span>
<span id="cb146-1484"><a href="#cb146-1484" aria-hidden="true" tabindex="-1"></a>  <span class="at">reference =</span> <span class="fu">factor</span>(resZ_aug<span class="sc">$</span>ecig_reg <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb146-1485"><a href="#cb146-1485" aria-hidden="true" tabindex="-1"></a>  <span class="at">positive =</span> <span class="st">"TRUE"</span>)</span>
<span id="cb146-1486"><a href="#cb146-1486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1487"><a href="#cb146-1487" aria-hidden="true" tabindex="-1"></a>cm_Z</span>
<span id="cb146-1488"><a href="#cb146-1488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1489"><a href="#cb146-1489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1490"><a href="#cb146-1490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1491"><a href="#cb146-1491" aria-hidden="true" tabindex="-1"></a>| MODEL | NAGELKERKE $R^2$ | C STATISTIC | AIC | BIC | DF |</span>
<span id="cb146-1492"><a href="#cb146-1492" aria-hidden="true" tabindex="-1"></a>|-------|------------------|-------------|-----|-----|----|</span>
<span id="cb146-1493"><a href="#cb146-1493" aria-hidden="true" tabindex="-1"></a>|   Y   |      0.145       |    0.630    | 1367.3 | 1408 | 7 |</span>
<span id="cb146-1494"><a href="#cb146-1494" aria-hidden="true" tabindex="-1"></a>|   Z   |      0.670       |    0.891    | 729.7 | 785.7  | 10 |</span>
<span id="cb146-1495"><a href="#cb146-1495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1496"><a href="#cb146-1496" aria-hidden="true" tabindex="-1"></a>| MODEL |  SENSITIVITY | SPECIFICITY | POSITIVE PREDICTIVE VALUE |</span>
<span id="cb146-1497"><a href="#cb146-1497" aria-hidden="true" tabindex="-1"></a>|-------|--------------|-------------|---------------------------|</span>
<span id="cb146-1498"><a href="#cb146-1498" aria-hidden="true" tabindex="-1"></a>|   Y   |    0.258     |    0.994    |           0.950           |</span>
<span id="cb146-1499"><a href="#cb146-1499" aria-hidden="true" tabindex="-1"></a>|   Z   |    0.732     |    0.983    |           0.951           |</span>
<span id="cb146-1500"><a href="#cb146-1500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1501"><a href="#cb146-1501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1502"><a href="#cb146-1502" aria-hidden="true" tabindex="-1"></a><span class="fu">## Validating Models Y and Z</span></span>
<span id="cb146-1503"><a href="#cb146-1503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1506"><a href="#cb146-1506" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1507"><a href="#cb146-1507" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4322023</span>); (valY <span class="ot">&lt;-</span> <span class="fu">validate</span>(mod_Y_lrm))</span>
<span id="cb146-1508"><a href="#cb146-1508" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1509"><a href="#cb146-1509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1512"><a href="#cb146-1512" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1513"><a href="#cb146-1513" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4322023</span>); (valZ <span class="ot">&lt;-</span> <span class="fu">validate</span>(mod_Z_lrm))</span>
<span id="cb146-1514"><a href="#cb146-1514" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1515"><a href="#cb146-1515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1516"><a href="#cb146-1516" aria-hidden="true" tabindex="-1"></a><span class="fu">### Validated $R^2$ and $C$ statistics for each model</span></span>
<span id="cb146-1517"><a href="#cb146-1517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1518"><a href="#cb146-1518" aria-hidden="true" tabindex="-1"></a>| MODEL | VALIDATED $R^2$ | VALIDATED $C$ STATISTIC |</span>
<span id="cb146-1519"><a href="#cb146-1519" aria-hidden="true" tabindex="-1"></a>|-------|-----------------|-----------------------|</span>
<span id="cb146-1520"><a href="#cb146-1520" aria-hidden="true" tabindex="-1"></a>|   Y   |     0.1185      |         0.612         |</span>
<span id="cb146-1521"><a href="#cb146-1521" aria-hidden="true" tabindex="-1"></a>|   Z   |     0.6528      |         0.882         |</span>
<span id="cb146-1522"><a href="#cb146-1522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1523"><a href="#cb146-1523" aria-hidden="true" tabindex="-1"></a><span class="fu">## Final Logistic Regression Model</span></span>
<span id="cb146-1524"><a href="#cb146-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1525"><a href="#cb146-1525" aria-hidden="true" tabindex="-1"></a>I prefer Model <span class="in">`Z`</span>, for the following reasons:</span>
<span id="cb146-1526"><a href="#cb146-1526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1527"><a href="#cb146-1527" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Model Z has a higher validated $R^2$ and $C$ statistic</span>
<span id="cb146-1528"><a href="#cb146-1528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1529"><a href="#cb146-1529" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Model Z has a higher Naegelkerke $R^2$</span>
<span id="cb146-1530"><a href="#cb146-1530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1531"><a href="#cb146-1531" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Model Z has a lower AIC and BIC</span>
<span id="cb146-1532"><a href="#cb146-1532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1533"><a href="#cb146-1533" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Model Z has a higher sensitivity, and a higher positive predictive value. While it has the lower specificity, the difference is not wide. </span>
<span id="cb146-1534"><a href="#cb146-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1535"><a href="#cb146-1535" aria-hidden="true" tabindex="-1"></a><span class="fu">### Winning Model's Parameter Estimates</span></span>
<span id="cb146-1536"><a href="#cb146-1536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1539"><a href="#cb146-1539" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1540"><a href="#cb146-1540" aria-hidden="true" tabindex="-1"></a>mod_Z_lrm</span>
<span id="cb146-1541"><a href="#cb146-1541" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1542"><a href="#cb146-1542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1543"><a href="#cb146-1543" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE}</span></span>
<span id="cb146-1544"><a href="#cb146-1544" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtaining model coefficients and exponentiating them</span></span>
<span id="cb146-1545"><a href="#cb146-1545" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(mod_Z, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb146-1546"><a href="#cb146-1546" aria-hidden="true" tabindex="-1"></a><span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.90</span>) <span class="sc">|&gt;</span></span>
<span id="cb146-1547"><a href="#cb146-1547" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb146-1548"><a href="#cb146-1548" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>, <span class="at">full_width =</span> F) </span>
<span id="cb146-1549"><a href="#cb146-1549" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1550"><a href="#cb146-1550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1551"><a href="#cb146-1551" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plot of Effect Sizes for Winning Model</span></span>
<span id="cb146-1552"><a href="#cb146-1552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1555"><a href="#cb146-1555" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1556"><a href="#cb146-1556" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_Z_lrm)</span>
<span id="cb146-1557"><a href="#cb146-1557" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1558"><a href="#cb146-1558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1559"><a href="#cb146-1559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1562"><a href="#cb146-1562" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1563"><a href="#cb146-1563" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">summary</span>(mod_Z_lrm))</span>
<span id="cb146-1564"><a href="#cb146-1564" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1565"><a href="#cb146-1565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1566"><a href="#cb146-1566" aria-hidden="true" tabindex="-1"></a><span class="fu">### Numerical Description of Effect Sizes</span></span>
<span id="cb146-1567"><a href="#cb146-1567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1570"><a href="#cb146-1570" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1571"><a href="#cb146-1571" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_Z_lrm, <span class="at">conf.int =</span> <span class="fl">0.90</span>) <span class="sc">|&gt;</span> <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb146-1572"><a href="#cb146-1572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>, <span class="at">full_width =</span> F)</span>
<span id="cb146-1573"><a href="#cb146-1573" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1574"><a href="#cb146-1574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1575"><a href="#cb146-1575" aria-hidden="true" tabindex="-1"></a><span class="in">`price_paid`</span> description:</span>
<span id="cb146-1576"><a href="#cb146-1576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1577"><a href="#cb146-1577" aria-hidden="true" tabindex="-1"></a>For two individuals, subject 1 and 2, who have their first e-cigarette puff of the day the same number of minutes after waking up, who both use nicotine containing e-cigarettes, who have the same perception of the harmfulness of e-cigarettes in comparison to regular cigarettes, and use flavored e-cigarettes, and subject 1 pays less than 10 dollars for their e-cigarettes, and subject 2 pays between 21 to a 100 dollars for their e-cigarettes,  according to model Z, **the ratio of the odds of subject 1 being a regular e-cigarette smoker to the odds of subject 2 being a regular e-cigarette smoker is 17.465** The 90% confidence intervals around this estimate are (8.69 to 35.09). </span>
<span id="cb146-1578"><a href="#cb146-1578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1579"><a href="#cb146-1579" aria-hidden="true" tabindex="-1"></a>Given that this interval does not include 1, this is a meaningful effect.  </span>
<span id="cb146-1580"><a href="#cb146-1580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1581"><a href="#cb146-1581" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plot of ROC Curve for Winning Model</span></span>
<span id="cb146-1582"><a href="#cb146-1582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1583"><a href="#cb146-1583" aria-hidden="true" tabindex="-1"></a>The <span class="in">`roc`</span> function from the <span class="in">`pROC`</span> package was used to obtain the ROC curve for model Z(the <span class="in">`lrm`</span> model). The dataset with the outcome variable recoded as "Yes" = 1, "No" = 0 was used.</span>
<span id="cb146-1584"><a href="#cb146-1584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1587"><a href="#cb146-1587" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1588"><a href="#cb146-1588" aria-hidden="true" tabindex="-1"></a>roc.mod <span class="ot">&lt;-</span> </span>
<span id="cb146-1589"><a href="#cb146-1589" aria-hidden="true" tabindex="-1"></a>    <span class="fu">roc</span>(log_i_temp<span class="sc">$</span>ecig_reg <span class="sc">~</span> <span class="fu">predict</span>(mod_Z_lrm, <span class="at">type=</span><span class="st">"fitted"</span>),</span>
<span id="cb146-1590"><a href="#cb146-1590" aria-hidden="true" tabindex="-1"></a>        <span class="at">ci =</span> <span class="cn">TRUE</span>)</span>
<span id="cb146-1591"><a href="#cb146-1591" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1592"><a href="#cb146-1592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1595"><a href="#cb146-1595" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1596"><a href="#cb146-1596" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc.mod, <span class="at">auc.polygon =</span> <span class="cn">TRUE</span>, <span class="at">print.auc =</span> <span class="cn">TRUE</span>,<span class="at">max.auc.polygon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb146-1597"><a href="#cb146-1597" aria-hidden="true" tabindex="-1"></a>     <span class="at">grid=</span><span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>),</span>
<span id="cb146-1598"><a href="#cb146-1598" aria-hidden="true" tabindex="-1"></a>     <span class="at">grid.col =</span> <span class="fu">c</span>(<span class="st">"green"</span>, <span class="st">"red"</span>),</span>
<span id="cb146-1599"><a href="#cb146-1599" aria-hidden="true" tabindex="-1"></a>     <span class="at">auc.polygon.col =</span> <span class="st">"skyblue"</span>,<span class="at">title =</span> <span class="st">"ROC Curve for Model Z (lrm) with the AUC score"</span>)</span>
<span id="cb146-1600"><a href="#cb146-1600" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1601"><a href="#cb146-1601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1602"><a href="#cb146-1602" aria-hidden="true" tabindex="-1"></a><span class="fu">### Validated $R^2$ and $C$ statistic for Winning Model</span></span>
<span id="cb146-1603"><a href="#cb146-1603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1604"><a href="#cb146-1604" aria-hidden="true" tabindex="-1"></a>| MODEL | VALIDATED $R^2$ | VALIDATED $C$ STATISTIC |</span>
<span id="cb146-1605"><a href="#cb146-1605" aria-hidden="true" tabindex="-1"></a>|-------|-----------------|-----------------------|</span>
<span id="cb146-1606"><a href="#cb146-1606" aria-hidden="true" tabindex="-1"></a>|   Z   |     0.6528      |         0.882         |</span>
<span id="cb146-1607"><a href="#cb146-1607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1608"><a href="#cb146-1608" aria-hidden="true" tabindex="-1"></a><span class="fu">### Nomogram of Winning Model</span></span>
<span id="cb146-1609"><a href="#cb146-1609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1610"><a href="#cb146-1610" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height = 6, fig.width = 6}</span></span>
<span id="cb146-1611"><a href="#cb146-1611" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">nomogram</span>(mod_Z_lrm, <span class="at">fun =</span> plogis))</span>
<span id="cb146-1612"><a href="#cb146-1612" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1613"><a href="#cb146-1613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1614"><a href="#cb146-1614" aria-hidden="true" tabindex="-1"></a><span class="fu">### Predictions for Two New Subjects</span></span>
<span id="cb146-1615"><a href="#cb146-1615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1618"><a href="#cb146-1618" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1619"><a href="#cb146-1619" aria-hidden="true" tabindex="-1"></a>new_subj <span class="ot">&lt;-</span></span>
<span id="cb146-1620"><a href="#cb146-1620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">min_num =</span> <span class="fu">c</span>(<span class="dv">60</span>,<span class="dv">60</span>), <span class="at">ecig_flavored =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>,<span class="st">"Yes"</span>),<span class="at">ecig_nico =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>,<span class="st">"Yes"</span>),<span class="at">harm_perc =</span> <span class="fu">c</span>(<span class="st">"less_harm"</span>,<span class="st">"less_harm"</span>), <span class="at">price_paid =</span> <span class="fu">c</span>(<span class="st">"Below$10"</span>,<span class="st">"$21to$100"</span>)) </span>
<span id="cb146-1621"><a href="#cb146-1621" aria-hidden="true" tabindex="-1"></a>preds4 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod_Z_lrm, <span class="at">newdata =</span> new_subj, <span class="at">type =</span> <span class="st">"fitted"</span>)</span>
<span id="cb146-1622"><a href="#cb146-1622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1623"><a href="#cb146-1623" aria-hidden="true" tabindex="-1"></a>preds4 </span>
<span id="cb146-1624"><a href="#cb146-1624" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1625"><a href="#cb146-1625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1626"><a href="#cb146-1626" aria-hidden="true" tabindex="-1"></a>| Subject Name | Subject Characteristics | Predicted Probability of being a regular E-cigarette smoker |</span>
<span id="cb146-1627"><a href="#cb146-1627" aria-hidden="true" tabindex="-1"></a>|--------------|-------------------------------------------------------------------|---------------------------------------------|</span>
<span id="cb146-1628"><a href="#cb146-1628" aria-hidden="true" tabindex="-1"></a>| Subject 1 | min_num = 60 minutes, ecig_flavored = Yes, ecig_nico = Yes, harm_perc = "less_harm", price_paid = "Below$10" | 0.858 |</span>
<span id="cb146-1629"><a href="#cb146-1629" aria-hidden="true" tabindex="-1"></a>| Subject 2 | min_num = 60 minutes, ecig_flavored = Yes, ecig_nico = Yes, harm_perc = "less_harm", price_paid = "$21to$100" | 0.258 | </span>
<span id="cb146-1630"><a href="#cb146-1630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1631"><a href="#cb146-1631" aria-hidden="true" tabindex="-1"></a><span class="fu"># Discusssion</span></span>
<span id="cb146-1632"><a href="#cb146-1632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1633"><a href="#cb146-1633" aria-hidden="true" tabindex="-1"></a><span class="fu">## Answering My Research Questions</span></span>
<span id="cb146-1634"><a href="#cb146-1634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1635"><a href="#cb146-1635" aria-hidden="true" tabindex="-1"></a><span class="fu">### My First Research Question</span></span>
<span id="cb146-1636"><a href="#cb146-1636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1637"><a href="#cb146-1637" aria-hidden="true" tabindex="-1"></a>*E-Cigarette Perception, Smoking Habits, and their association with Heavy E-Cigarette Use:*</span>
<span id="cb146-1638"><a href="#cb146-1638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1639"><a href="#cb146-1639" aria-hidden="true" tabindex="-1"></a>**Are smoking e-cigarettes that contain nicotine, the perception of the purported healthiness of e-cigarettes when compared to smoking regular cigarettes, and smoking habits strong predictors of heavy e-cigarette use in adulthood?**</span>
<span id="cb146-1640"><a href="#cb146-1640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1643"><a href="#cb146-1643" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1644"><a href="#cb146-1644" aria-hidden="true" tabindex="-1"></a><span class="co"># Transforming the coefficients of Model B back to the original variable's scale</span></span>
<span id="cb146-1645"><a href="#cb146-1645" aria-hidden="true" tabindex="-1"></a>tidy_mod_B <span class="sc">|&gt;</span> </span>
<span id="cb146-1646"><a href="#cb146-1646" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estimate =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>,(<span class="fu">exp</span>(estimate) <span class="sc">-</span> <span class="dv">1</span>)),</span>
<span id="cb146-1647"><a href="#cb146-1647" aria-hidden="true" tabindex="-1"></a>         <span class="at">conf.low =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>,(<span class="fu">exp</span>(conf.low) <span class="sc">-</span> <span class="dv">1</span>)),</span>
<span id="cb146-1648"><a href="#cb146-1648" aria-hidden="true" tabindex="-1"></a>         <span class="at">conf.high =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>,(<span class="fu">exp</span>(conf.high) <span class="sc">-</span> <span class="dv">1</span>))) <span class="sc">|&gt;</span></span>
<span id="cb146-1649"><a href="#cb146-1649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term,estimate,conf.low,conf.high, p.value) <span class="sc">|&gt;</span></span>
<span id="cb146-1650"><a href="#cb146-1650" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb146-1651"><a href="#cb146-1651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>, <span class="at">full_width =</span> F)  </span>
<span id="cb146-1652"><a href="#cb146-1652" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1653"><a href="#cb146-1653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1654"><a href="#cb146-1654" aria-hidden="true" tabindex="-1"></a>*E-CIGARETTE PUFFS PER DAY:*</span>
<span id="cb146-1655"><a href="#cb146-1655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1656"><a href="#cb146-1656" aria-hidden="true" tabindex="-1"></a>**Higher number of puffs taken per day are correlated with a higher number of days an e-cigarette was smoked in the past 30 days, provided all other variables are held constant.** This is evident from the confidence intervals of <span class="in">`puff_num`</span>, which do not include zero.</span>
<span id="cb146-1657"><a href="#cb146-1657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1658"><a href="#cb146-1658" aria-hidden="true" tabindex="-1"></a>*USAGE OF E-CIGARETTES WITH NICOTINE:*</span>
<span id="cb146-1659"><a href="#cb146-1659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1660"><a href="#cb146-1660" aria-hidden="true" tabindex="-1"></a>**The usage of e-cigarettes that do not contain nicotine are associated with a significantly lower number of days an e-cigarette was smoked by a study participant in the past 30 days, provided all other variables are held constant.** </span>
<span id="cb146-1661"><a href="#cb146-1661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1662"><a href="#cb146-1662" aria-hidden="true" tabindex="-1"></a>The point estimate for this effect is -0.11, with 90%CI(-0.21 to -0.01). Given that the confidence interval does not include zero, this is a meaningful effect. (p = 0.076) </span>
<span id="cb146-1663"><a href="#cb146-1663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1664"><a href="#cb146-1664" aria-hidden="true" tabindex="-1"></a>*E-CIGARETTE SMOKING INITIATION AGE:*</span>
<span id="cb146-1665"><a href="#cb146-1665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1666"><a href="#cb146-1666" aria-hidden="true" tabindex="-1"></a>Initiation of e-cigarette smoking at a younger age does not have a meaningful correlation with heavy e-cigarette smoking by an individual in the past 30 days, provided all other variables are held constant. This is evident from the confidence intervals for the different levels of <span class="in">`age_range`</span>, all of which contain zero, when compared to the number of days an e-cigarette was smoked in the past 30 days by individuals who initiated e-cigarette smoking when they were less than 18 years of age.</span>
<span id="cb146-1667"><a href="#cb146-1667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1668"><a href="#cb146-1668" aria-hidden="true" tabindex="-1"></a>*PERCEPTION OF THE HARMFULNESS OF E-CIGARETTES COMPARED TO REGULAR CIGARETTES:*</span>
<span id="cb146-1669"><a href="#cb146-1669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1670"><a href="#cb146-1670" aria-hidden="true" tabindex="-1"></a>The perception of the supposed healthiness of e-cigarettes when compared to regular cigarettes do not have a meaningful correlation with an individual's e-cigarette smoking in the past 30 days, provided all other variables are held constant. This is evident from the confidence intervals for the term <span class="in">`less_harmNo`</span> from the table of model B's coefficients, which include zero. (p = 0.204)</span>
<span id="cb146-1671"><a href="#cb146-1671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1672"><a href="#cb146-1672" aria-hidden="true" tabindex="-1"></a>*In summation, to answer my first research question, *</span>
<span id="cb146-1673"><a href="#cb146-1673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1674"><a href="#cb146-1674" aria-hidden="true" tabindex="-1"></a>**Factors such as a higher number of puffs taken from an e-cigarette daily, and usage of nicotine-containing e-cigarettes are correlated with heavier smoking habits over the past 30 days.**</span>
<span id="cb146-1675"><a href="#cb146-1675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1676"><a href="#cb146-1676" aria-hidden="true" tabindex="-1"></a>**Factors such as an individual's perception of the supposed healthiness of e-cigarettes when compared to regular cigarettes, and their age when they began smoking e-cigarettes, do not have a meaningful impact on an individual's smoking habits over the past 30 days.**</span>
<span id="cb146-1677"><a href="#cb146-1677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1678"><a href="#cb146-1678" aria-hidden="true" tabindex="-1"></a><span class="fu">### My Second Research Question</span></span>
<span id="cb146-1679"><a href="#cb146-1679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1680"><a href="#cb146-1680" aria-hidden="true" tabindex="-1"></a>*Regular e-cigarette use and it's associated factors:*</span>
<span id="cb146-1681"><a href="#cb146-1681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1682"><a href="#cb146-1682" aria-hidden="true" tabindex="-1"></a>**Are factors such as using flavored e-cigarettes, or needing to use e-cigarettes immediately after waking up, or using e-cigarettes with nicotine, or use of e-cigarettes as a healthier alternative to regular cigarettes associated with regular e-cigarette use?**</span>
<span id="cb146-1683"><a href="#cb146-1683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1686"><a href="#cb146-1686" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1687"><a href="#cb146-1687" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_Z_lrm, <span class="at">conf.int =</span> <span class="fl">0.90</span>) <span class="sc">|&gt;</span> <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb146-1688"><a href="#cb146-1688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">font_size =</span> <span class="dv">24</span>, <span class="at">full_width =</span> F)</span>
<span id="cb146-1689"><a href="#cb146-1689" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb146-1690"><a href="#cb146-1690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1691"><a href="#cb146-1691" aria-hidden="true" tabindex="-1"></a>*TIME TAKEN FOR THE FIRST E-CIGARETTE PUFF OF THE DAY*</span>
<span id="cb146-1692"><a href="#cb146-1692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1693"><a href="#cb146-1693" aria-hidden="true" tabindex="-1"></a>**Individuals who need to use e-cigarettes within an hour or an hour and a half of waking up have detectable higher odds of identifying as regular users of e-cigarettes, provided the other variables are held constant.** This is evident in the 90% confidence intervals for the odds ratio in the coefficient table, which does not include 1.  </span>
<span id="cb146-1694"><a href="#cb146-1694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1695"><a href="#cb146-1695" aria-hidden="true" tabindex="-1"></a>*USAGE OF FLAVORED E-CIGARETTES:*</span>
<span id="cb146-1696"><a href="#cb146-1696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1697"><a href="#cb146-1697" aria-hidden="true" tabindex="-1"></a>**Individuals who do not use flavored e-cigarettes have detectable lower odds of identifying as regular users of e-cigarettes, provided the other variables are held constant.** This is evident in the 90% confidence intervals for the odds ratio in the coefficient table, which does not include 1. The point estimate for this odds ratio is 0.07, with 90% confidence intervals (0.03 to 0.13). Individuals who do not use flavored e-cigarettes have only 0.07 times the odds(90%CI 0.03 to 0.13) of identifying as regular e-cigarette smokers, compared to individuals who do use flavored e-cigarettes. </span>
<span id="cb146-1698"><a href="#cb146-1698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1699"><a href="#cb146-1699" aria-hidden="true" tabindex="-1"></a>*COST OF E-CIGARETTE BRAND:*</span>
<span id="cb146-1700"><a href="#cb146-1700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1701"><a href="#cb146-1701" aria-hidden="true" tabindex="-1"></a>**Individuals who pay less than 10 dollars for their e-cigarettes have detectably higher odds of identifying as regular e-cigarettes, as compared to individuals who paid anywhere between 21 to 100 dollars for their e-cigarette, provided the other variables are held constant.** This is evident in the 90% confidence intervals for the odds ratio in the coefficient table, which do not include zero. Similarly, individuals who pay anywhere between 10 to 20 dollars for their e-cigarette also have detectably higher odds of identifying as regular e-cigarette smokers</span>
<span id="cb146-1702"><a href="#cb146-1702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1703"><a href="#cb146-1703" aria-hidden="true" tabindex="-1"></a>However, individuals who pay more than 100 dollars for their e-cigarettes do not have meaningfully different odds of identifying as regular e-cigarette smokers compared to individuals who pay anywhere between 21 to 100 dollars for their e-cigarettes, provided the other variables remain constant. This is evident in the 90% confidence intervals for the odds ratio of this effect in the coefficient table, which includes 1. </span>
<span id="cb146-1704"><a href="#cb146-1704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1705"><a href="#cb146-1705" aria-hidden="true" tabindex="-1"></a>*USAGE OF E-CIGARETTES CONTAINING NICOTINE:*</span>
<span id="cb146-1706"><a href="#cb146-1706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1707"><a href="#cb146-1707" aria-hidden="true" tabindex="-1"></a>Individuals who do not use e-cigarettes with nicotine do not have meaningfully different odds of identifying as regular e-cigarette smokers compared to individuals who use e-cigarettes containing nicotine, provided the other variables are held constant. The 90% confidence intervals for the odds ratio of this effect includes 1.</span>
<span id="cb146-1708"><a href="#cb146-1708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1709"><a href="#cb146-1709" aria-hidden="true" tabindex="-1"></a>*PERCEPTION OF THE HARMFULNESS OF E-CIGARETTES AS COMPARED TO REGULAR CIGARETTES:*</span>
<span id="cb146-1710"><a href="#cb146-1710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1711"><a href="#cb146-1711" aria-hidden="true" tabindex="-1"></a>Individuals who perceive e-cigarettes as being the same or more harmful than regular e-cigarettes do not have meaningfully different odds of identifying as regular e-cigarette smokers compared to individuals who perceive e-cigarettes as being less harmful than regular e-cigarettes, provided the other variables are held constant. The odds ratio for this effect includes 1. </span>
<span id="cb146-1712"><a href="#cb146-1712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1713"><a href="#cb146-1713" aria-hidden="true" tabindex="-1"></a>*In summation, to answer my second research question, *</span>
<span id="cb146-1714"><a href="#cb146-1714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1715"><a href="#cb146-1715" aria-hidden="true" tabindex="-1"></a>**Factors such as needing to use e-cigarettes immediately after waking up, using flavored e-cigarettes, and using cheaper e-cigarette brands are all associated with detectably higher odds of identifying as a regular e-cigarette user, provided the other variables are held constant.**</span>
<span id="cb146-1716"><a href="#cb146-1716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1717"><a href="#cb146-1717" aria-hidden="true" tabindex="-1"></a>**Factors such as the usage of nicotine containing e-cigarettes, and the perceptiom of the harmfulness of e-cigarettes as compared to regular cigarettes do not have a meaningful impact on the odds of identifying as a regular e-cigarette user, provided all other variables remain constant.** </span>
<span id="cb146-1718"><a href="#cb146-1718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1719"><a href="#cb146-1719" aria-hidden="true" tabindex="-1"></a><span class="fu">## Limitations and Next Steps</span></span>
<span id="cb146-1720"><a href="#cb146-1720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1721"><a href="#cb146-1721" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model B and it's limitations</span></span>
<span id="cb146-1722"><a href="#cb146-1722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1723"><a href="#cb146-1723" aria-hidden="true" tabindex="-1"></a>Given that model B was predicting a count outcome, and given then the outcome was transformed using a logarithm transformation after adding a non-zero integer to the outcome, the resulting model is very highly driven by the <span class="in">`puff_num`</span> variable, resulting in exploding coefficients for the restricted cubic spline applied on <span class="in">`puff_num`</span>. </span>
<span id="cb146-1724"><a href="#cb146-1724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1725"><a href="#cb146-1725" aria-hidden="true" tabindex="-1"></a>Model B outperformed Model A on all metrics that were studied. Visualization of the transformed outcome variable showed why that was the case, given the non-linear, skewed nature of the data under study. The data lent itself very well towards a non-linear term, even if the restricted cubic spline had exploding coefficients. </span>
<span id="cb146-1726"><a href="#cb146-1726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1727"><a href="#cb146-1727" aria-hidden="true" tabindex="-1"></a>This outcome could be better modeled with a Poisson regression, and by using a larger dataset with lesser missing values. The next ideal step would be to expand the dataset to more than 1200, and model the outcome using a Poisson regression. </span>
<span id="cb146-1728"><a href="#cb146-1728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1729"><a href="#cb146-1729" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Z and it's limitations</span></span>
<span id="cb146-1730"><a href="#cb146-1730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1731"><a href="#cb146-1731" aria-hidden="true" tabindex="-1"></a>The glm fit of the model produced a warning stating that predicted probabilities of 0 or 1 had occurred. Given that the data under analysis had a large amount of missingness, imputation possibly skewed the model towards one direction or the other. It is important to note that this warning was only produced in the glm model, while the lrm model did not produce such a warning.</span>
<span id="cb146-1732"><a href="#cb146-1732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1733"><a href="#cb146-1733" aria-hidden="true" tabindex="-1"></a>This model could be improved by vastly expanding the sample size, minimizing the effect of the missing data and smoothing out the predicted probabilites so that the preceding skew does not repeat itself.</span>
<span id="cb146-1734"><a href="#cb146-1734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1735"><a href="#cb146-1735" aria-hidden="true" tabindex="-1"></a><span class="fu">## Thoughts on Project A</span></span>
<span id="cb146-1736"><a href="#cb146-1736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1737"><a href="#cb146-1737" aria-hidden="true" tabindex="-1"></a>Project A was more difficult than I expected it to be. I went in knowing it would take a decent amount of work and effort, and I was reasonably confident that I could tackle it, since I knew my experience in 431 had already helped prepare me for the work that would be required. The hardest part of Project A was dealing with the large number of missing values. The impact of imputation on both models was significant, and discussing the limitations and understanding how the models could be improved was a difficult task, although I did learn a lot from the difficulty I had with the data. </span>
<span id="cb146-1738"><a href="#cb146-1738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1739"><a href="#cb146-1739" aria-hidden="true" tabindex="-1"></a>At the end of Project A, I wished that I had chosen a non count outcome for the linear regression.We hadn't covered count outcomes at the time of submission of the Plan, and if I'd known the difficulties inherent in using linear regression for a count outcome when I started, I would have picked a different outcome variable. </span>
<span id="cb146-1740"><a href="#cb146-1740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1741"><a href="#cb146-1741" aria-hidden="true" tabindex="-1"></a><span class="fu"># Affirmation</span></span>
<span id="cb146-1742"><a href="#cb146-1742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1743"><a href="#cb146-1743" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; I am certain that it is completely appropriate for these data to be shared with anyone, without any conditions. There are no concerns about privacy or security.</span></span>
<span id="cb146-1744"><a href="#cb146-1744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1745"><a href="#cb146-1745" aria-hidden="true" tabindex="-1"></a><span class="fu"># References</span></span>
<span id="cb146-1746"><a href="#cb146-1746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1747"><a href="#cb146-1747" aria-hidden="true" tabindex="-1"></a><span class="sc">\[</span>1<span class="sc">\]</span> Singh, T., Arrazola, R. A., Corey, C. G., Husten, C. G., Neff, L. J., Homa, D. M., &amp; King, B. A. (2016). **Tobacco use among middle and high school students---United States**, 2011--2015. Morbidity and mortality weekly report, 65(14), 361-367.</span>
<span id="cb146-1748"><a href="#cb146-1748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1749"><a href="#cb146-1749" aria-hidden="true" tabindex="-1"></a><span class="sc">\[</span>2<span class="sc">\]</span> Dutra, L. M., &amp; Glantz, S. A. (2014). **High international electronic cigarette use among never smoker adolescents.** Journal of Adolescent Health, 55(5), 595-597.</span>
<span id="cb146-1750"><a href="#cb146-1750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1751"><a href="#cb146-1751" aria-hidden="true" tabindex="-1"></a><span class="sc">\[</span>3<span class="sc">\]</span> Dutra, L. M., &amp; Glantz, S. A. (2017). **E-cigarettes and national adolescent cigarette use**: 2004--2014. Pediatrics, 139(2).</span>
<span id="cb146-1752"><a href="#cb146-1752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1753"><a href="#cb146-1753" aria-hidden="true" tabindex="-1"></a><span class="sc">\[</span>4<span class="sc">\]</span> Glantz, S. A., &amp; Bareham, D. W. (2018). **E-cigarettes: use, effects on smoking, risks, and policy implications**. Annual review of public health, 39, 215-235.</span>
<span id="cb146-1754"><a href="#cb146-1754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1755"><a href="#cb146-1755" aria-hidden="true" tabindex="-1"></a><span class="sc">\[</span>5<span class="sc">\]</span> United States Department of Health and Human Services. National Institutes of Health. National Institute on Drug Abuse, and United States Department of Health and Human Services. Food and Drug Administration. Center for Tobacco Products. Population Assessment of Tobacco and Health (PATH) Study <span class="sc">\[</span>United States<span class="sc">\]</span> Public-Use Files. Inter-university Consortium for Political and Social Research <span class="sc">\[</span>distributor<span class="sc">\]</span>, 2022-10-07. https://doi.org/10.3886/ICPSR36498.v17</span>
<span id="cb146-1756"><a href="#cb146-1756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1757"><a href="#cb146-1757" aria-hidden="true" tabindex="-1"></a><span class="fu"># Session Information</span></span>
<span id="cb146-1758"><a href="#cb146-1758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-1761"><a href="#cb146-1761" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb146-1762"><a href="#cb146-1762" aria-hidden="true" tabindex="-1"></a>xfun<span class="sc">::</span><span class="fu">session_info</span>()</span>
<span id="cb146-1763"><a href="#cb146-1763" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>